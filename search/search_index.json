{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Vertama Manuals","text":"<p>\"Perfect is the enemy of good\" - Voltaire</p>"},{"location":"#intro","title":"Intro","text":"<p>Diese Seite wird automatisch aus vorhanden Unterlagen publiziert. Dieser Prozess ist im Fluss, und noch im Aufbau. Die bisher verf\u00fcgbare Dokumentation sind daher weder einheitlich noch vollst\u00e4ndig, wir bitten uns dies nachzusehen, und arbeiten kontinuierlich an der Verbesserung. Unsere Priorit\u00e4t ist die notwendige Dokumentation zum Betrieb, zur Integration und Entwicklung verf\u00fcgbar zur machen. Auch wenn die Form dabei manchmal zur\u00fcckstehen muss.</p>"},{"location":"#faq","title":"FAQ","text":""},{"location":"about/","title":"About","text":"<p>...to be written</p>"},{"location":"Authentication/basic-auth-login/","title":"Basic Auth Login (BAL) - Authentication Pattern","text":"<p>A universal authentication pattern that converts Basic Authentication credentials into secure session-based authentication with automatic redirect.</p> <p>Version: 1.1.0 Last Updated: 2026-02-19</p>"},{"location":"Authentication/basic-auth-login/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Why Use BAL?</li> <li>How It Works</li> <li>URL Pattern</li> <li>Usage Examples</li> <li>Security</li> <li>Integration Patterns</li> </ol>"},{"location":"Authentication/basic-auth-login/#overview","title":"Overview","text":"<p>The Basic Auth Login (BAL) endpoint provides a universal way for external systems to generate authenticated links that automatically log users into ELIM and redirect them to their target destination.</p> <p>Endpoint: <code>GET /bal/{target-path}</code></p> <p>Purpose: Convert Basic Authentication credentials into secure session-based authentication, enabling: - Single-click access to pre-filled forms - Proper session management with logout support - Secure credential handling</p>"},{"location":"Authentication/basic-auth-login/#why-use-bal","title":"Why Use BAL?","text":""},{"location":"Authentication/basic-auth-login/#the-problem-with-direct-basic-auth-urls","title":"The Problem with Direct Basic Auth URLs","text":"<p>External systems often want to provide direct links to authenticated resources:</p> <pre><code>http://username:password@host/elimplus/Rsv/?m=memento123\n</code></pre> <p>However, Basic Authentication has fundamental limitations: - No logout: Browser caches credentials indefinitely - Security risks: Credentials sent with every request - Poor UX: No visible logout button, confusion about session state</p>"},{"location":"Authentication/basic-auth-login/#the-bal-solution","title":"The BAL Solution","text":"<p>BAL converts Basic Auth into a proper session:</p> <pre><code>http://username:password@host/bal/elimplus/Rsv/?m=memento123\n         \u2193 BAL endpoint authenticates user\n         \u2193 Creates secure session\n         \u2193 Redirects to target\nhttp://host/elimplus/Rsv/?m=memento123\n     (user now has session cookie, no credentials in URL)\n</code></pre> <p>Benefits: \u2705 Users get proper sessions with logout support \u2705 Credentials only sent once during initial authentication \u2705 Standard web application security model \u2705 Compatible with existing Basic Auth integration patterns</p>"},{"location":"Authentication/basic-auth-login/#how-it-works","title":"How It Works","text":""},{"location":"Authentication/basic-auth-login/#request-flow","title":"Request Flow","text":"<pre><code>1. External System creates authenticated URL:\n   https://user:pass@elim.example.com/bal/elimplus/Rsv/?m=memento123\n\n2. User clicks link \u2192 Browser sends GET request to /bal/elimplus/Rsv/?m=memento123\n   with Authorization: Basic &lt;base64(user:pass)&gt; header\n\n3. BAL endpoint:\n   a. Extracts credentials from Authorization header\n   b. Authenticates user via Spring Security\n   c. Creates session-based authentication\n   d. Stores authentication in HTTP session\n\n4. Redirects to target:\n   302 Redirect \u2192 /elimplus/Rsv/?m=memento123\n\n5. Browser follows redirect with session cookie (no more Basic Auth)\n\n6. User sees target page, fully authenticated with session\n</code></pre>"},{"location":"Authentication/basic-auth-login/#authentication-lifecycle","title":"Authentication Lifecycle","text":"<ul> <li>Initial request: Basic Auth credentials validated</li> <li>Session creation: Spring Security session established</li> <li>Subsequent requests: Session cookie used (no credentials)</li> <li>Logout: Standard logout flow available</li> </ul>"},{"location":"Authentication/basic-auth-login/#url-pattern","title":"URL Pattern","text":""},{"location":"Authentication/basic-auth-login/#syntax","title":"Syntax","text":"<pre><code>/bal/{target-path}?{query-parameters}\n</code></pre> <p>Where: - <code>/bal/</code> - BAL endpoint prefix - <code>{target-path}</code> - Internal path to redirect to (everything after <code>/bal/</code>) - <code>{query-parameters}</code> - Preserved in redirect</p>"},{"location":"Authentication/basic-auth-login/#path-extraction","title":"Path Extraction","text":"Original URL Target Path Final Redirect <code>/bal/elimplus/Rsv</code> <code>/elimplus/Rsv</code> <code>GET /elimplus/Rsv</code> <code>/bal/elimplus/Rsv/?m=abc123</code> <code>/elimplus/Rsv/?m=abc123</code> <code>GET /elimplus/Rsv/?m=abc123</code> <code>/bal/admin/users?page=2</code> <code>/admin/users?page=2</code> <code>GET /admin/users?page=2</code> <code>/bal</code> <code>/</code> <code>GET /</code>"},{"location":"Authentication/basic-auth-login/#security-validations","title":"Security Validations","text":"<p>The target URL is validated to prevent attacks:</p> Check Purpose Example Blocked Must start with <code>/</code> Prevent external redirects <code>http://evil.com</code> \u274c Cannot start with <code>//</code> Prevent protocol-relative URLs <code>//evil.com/path</code> \u274c Cannot contain <code>..</code> Prevent path traversal <code>/bal/../../../etc/passwd</code> \u274c Cannot start with <code>/bal</code> Prevent infinite loops <code>/bal/bal/bal/...</code> \u274c"},{"location":"Authentication/basic-auth-login/#usage-examples","title":"Usage Examples","text":""},{"location":"Authentication/basic-auth-login/#example-1-elim-pre-filled-form-access","title":"Example 1: ELIM+ Pre-filled Form Access","text":"<p>Scenario: Laboratory system wants to give technicians direct access to pre-filled disease reporting forms.</p> <pre><code>#!/bin/bash\n# External laboratory system script\n\nHOST=\"elim.example.com\"\nEND_USER=\"lab-tech\"\nEND_USER_PASSWORD=\"tech-secret\"\nAPI_USER=\"lab-api\"\nAPI_PASSWORD=\"api-secret\"\n\n# Step 1: Create memento via API\nMEMENTO=$(curl -s -X POST \\\n  -u \"$API_USER:$API_PASSWORD\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"reportId\": \"LAB-2024-00123\",\n    \"Krankheit\": {\"Influenza\": {}},\n    \"Patient\": {\n      \"IsAnonym\": false,\n      \"Standard\": {\n        \"Name\": {\"Vorname\": \"Max\", \"Nachname\": \"Mustermann\"},\n        \"Geburtsdatum\": \"1980-05-15\"\n      }\n    }\n  }' \\\n  \"https://$HOST/api/elimplus/v1/memento\" | jq -r '.memento')\n\n# Step 2: Construct BAL URL for end user\nFORM_URL=\"https://$END_USER:$END_USER_PASSWORD@$HOST/bal/elimplus/Influenza/?m=$MEMENTO\"\n\n# Step 3: Send to user (email, portal, etc.)\necho \"Please review and submit this report:\"\necho \"$FORM_URL\"\n</code></pre> <p>What happens: 1. User clicks link 2. BAL authenticates with <code>lab-tech:tech-secret</code> 3. Creates session for <code>lab-tech</code> user 4. Redirects to <code>/elimplus/Influenza/?m={memento}</code> 5. User sees pre-filled Influenza form 6. User reviews and submits to DEMIS</p>"},{"location":"Authentication/basic-auth-login/#example-2-direct-curl-access-testing","title":"Example 2: Direct curl Access (Testing)","text":"<pre><code># Authenticate and access protected resource\ncurl -u \"username:password\" \\\n  -L \\\n  \"https://elim.example.com/bal/elimplus/Rsv/?m=memento456\"\n\n# -L flag follows redirects\n# First request: BAL authenticates\n# Second request: Follows redirect with session cookie\n</code></pre>"},{"location":"Authentication/basic-auth-login/#example-3-batch-link-generation","title":"Example 3: Batch Link Generation","text":"<pre><code>#!/bin/bash\n# Generate BAL links for multiple reports\n\nBASE_URL=\"https://elim.example.com\"\nUSER=\"tech-user\"\nPASS=\"tech-pass\"\n\n# Read CSV with lab results\nwhile IFS=',' read -r report_id disease firstname lastname dob; do\n  # Create memento (simplified)\n  MEMENTO=$(create_memento \"$report_id\" \"$disease\" \"$firstname\" \"$lastname\" \"$dob\")\n\n  # Generate BAL URL\n  FORM_URL=\"https://$USER:$PASS@$BASE_URL/bal/elimplus/$disease/?m=$MEMENTO\"\n\n  echo \"$report_id,$FORM_URL\"\ndone &lt; lab_results.csv &gt; form_links.csv\n</code></pre>"},{"location":"Authentication/basic-auth-login/#example-4-email-notification-with-bal-link","title":"Example 4: Email Notification with BAL Link","text":"<pre><code>#!/bin/bash\n# Send email with authenticated form link\n\nTO=\"technician@hospital.com\"\nFORM_URL=\"https://tech:secret@elim.example.com/bal/elimplus/Norovirus/?m=abc123\"\n\nmail -s \"Laboratory Report Ready for Review (LAB-2024-789)\" \"$TO\" &lt;&lt;EOF\nHello,\n\nA laboratory report is ready for your review and submission to DEMIS.\n\nClick here to access the pre-filled form:\n$FORM_URL\n\nThe form has been pre-filled with laboratory data. Please review for accuracy\nand submit to the health authority.\n\nNote: You will be automatically logged in when you click the link.\n\n---\nLaboratory Information System\nEOF\n</code></pre>"},{"location":"Authentication/basic-auth-login/#security","title":"Security","text":""},{"location":"Authentication/basic-auth-login/#credential-handling","title":"Credential Handling","text":"<p>\u2705 Secure practices: - Credentials only transmitted in initial request - HTTPS required in production (credentials never in plain text) - Session cookies are HttpOnly and Secure - Credentials never logged or stored</p> <p>\u274c Avoid: - Don't include credentials in query parameters (use Authorization header) - Don't reuse credentials across multiple users - Don't share BAL URLs publicly (contain credentials)</p>"},{"location":"Authentication/basic-auth-login/#target-url-validation","title":"Target URL Validation","text":"<p>BAL validates all target URLs to prevent:</p> <ol> <li> <p>Open redirects: <code>/bal//evil.com/phishing  \u274c Blocked</code></p> </li> <li> <p>Path traversal: <code>/bal/../../../etc/passwd  \u274c Blocked</code></p> </li> <li> <p>Infinite loops: <code>/bal/bal/bal/target  \u274c Blocked</code></p> </li> </ol>"},{"location":"Authentication/basic-auth-login/#session-security","title":"Session Security","text":"<ul> <li>Session fixation protection: New session ID generated after authentication</li> <li>Session timeout: Configured server-side (typically 30 minutes idle)</li> <li>Logout support: Users can explicitly log out via <code>/logout</code></li> <li>CSRF protection: Enabled for all state-changing operations</li> </ul>"},{"location":"Authentication/basic-auth-login/#production-recommendations","title":"Production Recommendations","text":"<ol> <li>Use HTTPS: Always use HTTPS in production to protect credentials</li> <li>Strong passwords: Enforce strong password policies for end users</li> <li>Separate credentials: Use different credentials for API users vs end users</li> <li>Monitor access: Log authentication attempts and target URLs</li> <li>Rate limiting: Implement rate limiting to prevent brute force attacks</li> </ol>"},{"location":"Authentication/basic-auth-login/#integration-patterns","title":"Integration Patterns","text":""},{"location":"Authentication/basic-auth-login/#pattern-1-api-generated-bal-access-elim","title":"Pattern 1: API-Generated + BAL Access (ELIM+)","text":"<p>Use case: External system creates data via API, users access via browser</p> <pre><code>External System\n    \u2193\n[1] POST /api/elimplus/v1/memento \u2192 memento string\n    \u2193\n[2] Construct: https://user:pass@host/bal/elimplus/Disease/?m={memento}\n    \u2193\n[3] Send URL to end user (email, portal, etc.)\n    \u2193\nEnd User clicks link\n    \u2193\n[4] GET /bal/elimplus/Disease/?m={memento} with Basic Auth\n    \u2193 BAL authenticates and creates session\n    \u2193\n[5] 302 Redirect \u2192 /elimplus/Disease/?m={memento}\n    \u2193\n[6] User sees pre-filled form with session cookie\n</code></pre>"},{"location":"Authentication/basic-auth-login/#pattern-2-direct-resource-access","title":"Pattern 2: Direct Resource Access","text":"<p>Use case: External portal provides links to ELIM resources</p> <pre><code>External Portal\n    \u2193\nGenerates link: https://user:pass@host/bal/admin/reports\n    \u2193\nUser clicks in portal\n    \u2193\nBAL authenticates \u2192 redirects to /admin/reports\n    \u2193\nUser browses ELIM with active session\n</code></pre>"},{"location":"Authentication/basic-auth-login/#pattern-3-bookmarkable-forms-developmenttesting","title":"Pattern 3: Bookmarkable Forms (Development/Testing)","text":"<p>Use case: Developers/testers need quick access to specific forms</p> <pre><code>Developer creates bookmark:\nhttps://test-user:test-pass@dev.elim.example.com/bal/elimplus/Rsv\n\nClick bookmark \u2192 instant authenticated access to RSV form\n</code></pre>"},{"location":"Authentication/basic-auth-login/#troubleshooting","title":"Troubleshooting","text":""},{"location":"Authentication/basic-auth-login/#issue-401-unauthorized","title":"Issue: 401 Unauthorized","text":"<p>Cause: Invalid credentials</p> <p>Solution: - Verify username and password are correct - Check if user account is active - Ensure credentials are properly URL-encoded in the URL</p>"},{"location":"Authentication/basic-auth-login/#issue-302-redirect-loop","title":"Issue: 302 Redirect Loop","text":"<p>Cause: Target URL starts with <code>/bal</code></p> <p>Solution: - Remove <code>/bal</code> prefix from target path - Correct: <code>/bal/elimplus/Rsv</code> - Incorrect: <code>/bal/bal/elimplus/Rsv</code></p>"},{"location":"Authentication/basic-auth-login/#issue-credentials-visible-in-browser","title":"Issue: Credentials Visible in Browser","text":"<p>Cause: Basic Auth credentials may appear in browser's address bar</p> <p>Solution: - This is expected for the initial request - After redirect, credentials are gone (session cookie used) - Consider generating short-lived links or one-time tokens if this is a concern</p>"},{"location":"Authentication/basic-auth-login/#issue-cannot-logout","title":"Issue: Cannot Logout","text":"<p>Cause: Browser caches Basic Auth credentials</p> <p>Solution: - BAL automatically converts to session-based auth on first access - Users can then use standard <code>/logout</code> endpoint - Initial Basic Auth credentials only used for BAL request</p>"},{"location":"Authentication/basic-auth-login/#faq","title":"FAQ","text":"<p>Q: When should I prefer Magic Token Links (MTL) over BAL? A: For new integrations, prefer MTL. API endpoints (e.g., <code>POST /api/duba/v1/memento</code>) return a ready-to-use <code>magicLink</code> field \u2014 no manual URL construction needed, no end-user credentials in the URL, and tokens self-expire after one hour. See Magic Token Link (MTL) for details. BAL remains supported for existing integrations.</p> <p>Q: Is BAL secure for production use? A: Yes, when used with HTTPS. Credentials are only sent in the initial request and then converted to secure session-based authentication.</p> <p>Q: Can I use BAL for API endpoints? A: No, BAL is designed for browser-based access. For API endpoints, use Basic Auth directly with the API endpoint (e.g., <code>/api/elimplus/v1/memento</code>).</p> <p>Q: What happens if credentials are wrong? A: BAL returns a 401 Unauthorized response or redirects to <code>/login?error</code>.</p> <p>Q: Can I use BAL without credentials in the URL? A: Yes, send credentials in the <code>Authorization: Basic</code> header instead of embedding them in the URL.</p> <p>Q: Does BAL work with OAuth/OIDC? A: BAL specifically handles Basic Auth \u2192 session conversion. For OAuth/OIDC, use the standard OAuth login flow.</p> <p>Q: Can I customize the redirect behavior? A: The target path is extracted from the URL structure. To customize further, contact your administrator or see the source code.</p>"},{"location":"Authentication/basic-auth-login/#related-documentation","title":"Related Documentation","text":"<ul> <li>Magic Token Link (MTL) - Recommended alternative: server-issued tokens, no credentials in URL</li> <li>ELIM+ API Integration Guide - Complete API workflow including BAL usage</li> <li>ELIM+ OpenAPI Specification - API endpoint details</li> </ul> <p>This is external-facing documentation for integration partners. For internal implementation details, see <code>src/main/java/de/vertama/web/BasicAuthLoginController.kt</code> in the elim repository.</p>"},{"location":"Authentication/magic-token-link/","title":"Magic Token Link (MTL) - Authentication Pattern","text":"<p>A server-issued, time-limited authentication token that combines login and navigation into a single click \u2014 without embedding end-user credentials in the URL.</p> <p>Version: 1.0.0 Last Updated: 2026-02-19</p>"},{"location":"Authentication/magic-token-link/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Overview</li> <li>Why Use MTL?</li> <li>How It Works</li> <li>URL Pattern</li> <li>Usage Examples</li> <li>Security</li> <li>Integration Patterns</li> <li>Comparison with BAL</li> </ol>"},{"location":"Authentication/magic-token-link/#overview","title":"Overview","text":"<p>The Magic Token Link (MTL) endpoint authenticates a user and redirects them to a target page in a single HTTP request. The authentication token is generated server-side by the API user and encodes:</p> <ul> <li>username \u2014 which user account will be authenticated</li> <li>targetUrl \u2014 where to land after authentication</li> <li>expiresAt \u2014 token expiry (tokens are self-expiring)</li> </ul> <p>Endpoint: <code>GET /mtl/{token}</code> (optionally <code>?m={memento}</code>)</p> <p>Purpose: Give an external system (e.g., a hospital KIS) the ability to hand off a pre-authenticated, pre-filled browser session to an end user \u2014 without putting credentials in the URL.</p> <p>Typical flow:</p> <ol> <li>External system calls a product API endpoint (e.g., <code>POST /api/duba/v1/memento</code>)</li> <li>The API response includes a ready-to-use <code>magicLink</code> URL (relative path)</li> <li>External system prepends the host and sends the absolute URL to the end user (email, portal link, etc.)</li> <li>End user clicks link \u2192 authenticates as the API user account \u2192 lands on the pre-filled form</li> </ol>"},{"location":"Authentication/magic-token-link/#why-use-mtl","title":"Why Use MTL?","text":""},{"location":"Authentication/magic-token-link/#the-problem-with-credential-in-url-links","title":"The Problem with Credential-in-URL Links","text":"<p>Embedding credentials in a URL to give users direct, authenticated access is tempting but flawed:</p> <pre><code>https://user:password@host/duba/BetreuungAnregung?m=memento123\n</code></pre> <p>Problems: - Credentials exposed: Password appears in server logs, browser history, email headers - No expiry: Link is valid forever (until the password changes) - Session confusion: Browser caches Basic Auth credentials \u2014 users cannot log out cleanly</p> <p>The BAL pattern (<code>/bal/</code>) is an improvement (credentials \u2192 session, one-time use), but it still requires the end-user's password to be embedded in the link.</p>"},{"location":"Authentication/magic-token-link/#the-mtl-solution","title":"The MTL Solution","text":"<p>MTL replaces end-user credentials with a server-issued encrypted token:</p> <pre><code>https://host/mtl/eyJ...token.../duba/BetreuungAnregung?m=memento123\n             \u2193 MTL endpoint decrypts token\n             \u2193 Verifies expiry\n             \u2193 Authenticates the encoded user\n             \u2193 Creates secure session\n             \u2193 Redirects to target with memento\n</code></pre> <p>Benefits: - No end-user credentials in the URL \u2014 only an encrypted server token - Tokens are time-limited (configurable expiry, default 1 hour) - Tokens are server-signed \u2014 cannot be forged or tampered with - Standard session-based auth after redirect (logout works normally) - The <code>magicLink</code> is returned by API endpoints \u2014 no manual URL construction needed</p>"},{"location":"Authentication/magic-token-link/#how-it-works","title":"How It Works","text":""},{"location":"Authentication/magic-token-link/#request-flow","title":"Request Flow","text":"<pre><code>1. External system (KIS) calls API:\n   POST /api/duba/v1/memento  (Basic Auth with API credentials)\n   \u2192 Response: { \"memento\": \"...\", \"magicLink\": \"/mtl/eyJ.../duba/form?m=...\" }\n\n2. External system prepends host and delivers the URL to end user:\n   https://elim.example.com/mtl/eyJ.../duba/BetreuungAnregung?m=...\n\n3. End user clicks link \u2192 Browser sends GET /mtl/{token}?m={memento}\n\n4. MTL endpoint:\n   a. Decrypts and decodes the token\n   b. Validates expiry (rejects if expired \u2192 redirect to /login?error)\n   c. Validates target URL (prevents open redirects)\n   d. Loads the user account (verifies it still exists)\n   e. Creates session-based authentication\n\n5. 302 Redirect \u2192 /duba/BetreuungAnregung?m={memento}\n\n6. User sees pre-filled form, fully authenticated with session cookie\n</code></pre>"},{"location":"Authentication/magic-token-link/#token-structure","title":"Token Structure","text":"<p>Tokens are generated using the same AES-256-GCM encryption as all other mementos in the system. A token encodes:</p> <pre><code>{\n  \"username\": \"hospital-api-user\",\n  \"targetUrl\": \"/duba/BetreuungAnregung\",\n  \"expiresAt\": \"2026-02-19T15:30:00Z\"\n}\n</code></pre> <p>The token is URL-safe and cannot be modified without invalidating the signature.</p>"},{"location":"Authentication/magic-token-link/#the-m-memento-parameter","title":"The <code>?m=</code> Memento Parameter","text":"<p>The form pre-fill memento travels separately from the token as a plain <code>?m=</code> query parameter. It is not embedded in the token. Reasons:</p> <ul> <li>The memento is already server-encrypted (AES-256-GCM) \u2014 double-encrypting adds size for no gain</li> <li>Separating them keeps token size small and tokens reusable (in principle)</li> <li>The <code>?m=</code> value is appended to the redirect URL after successful authentication</li> </ul>"},{"location":"Authentication/magic-token-link/#url-pattern","title":"URL Pattern","text":""},{"location":"Authentication/magic-token-link/#syntax","title":"Syntax","text":"<pre><code>/mtl/{token}\n/mtl/{token}?m={memento}\n</code></pre> <p>Where: - <code>/mtl/</code> \u2014 Magic Token Link endpoint prefix - <code>{token}</code> \u2014 Encrypted, URL-safe token (generated by product API endpoints) - <code>?m={memento}</code> \u2014 Optional form pre-fill data (appended to final redirect URL)</p>"},{"location":"Authentication/magic-token-link/#the-magiclink-field","title":"The <code>magicLink</code> Field","text":"<p>Product API endpoints that support form pre-fill return a <code>magicLink</code> field in their JSON response. This is a relative URL \u2014 prepend your host to make it absolute:</p> <pre><code>MAGIC_LINK=$(curl ... | jq -r '.magicLink')\nFULL_URL=\"https://elim.example.com$MAGIC_LINK\"\n</code></pre>"},{"location":"Authentication/magic-token-link/#security-validations","title":"Security Validations","text":"<p>The target URL embedded in the token is validated before use:</p> Check Purpose Example Blocked Must start with <code>/</code> Prevent external redirects <code>http://evil.com</code> Cannot start with <code>//</code> Prevent protocol-relative URLs <code>//evil.com/path</code> Cannot contain <code>..</code> Prevent path traversal <code>/duba/../../etc/passwd</code> Cannot start with <code>/mtl</code> Prevent redirect loops <code>/mtl/nested/token</code>"},{"location":"Authentication/magic-token-link/#usage-examples","title":"Usage Examples","text":""},{"location":"Authentication/magic-token-link/#example-1-duba-form-pre-fill-recommended-pattern","title":"Example 1: DUBA Form Pre-fill (Recommended Pattern)","text":"<p>Scenario: Hospital KIS creates a court guardianship request and hands off a pre-filled form link to a hospital employee for review and submission.</p> <pre><code>#!/bin/bash\nHOST=\"https://elim.example.com\"\nAPI_USER=\"hospital-api\"\nAPI_PASS=\"api-secret\"\n\n# Step 1: Create memento \u2014 response includes both memento and magicLink\nRESPONSE=$(curl -s -X POST \\\n  -u \"$API_USER:$API_PASS\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"jobId\": \"KH-2026-00456\",\n    \"absender\": { \"aktenzeichen\": \"KH-2024-00123\", \"egvp_account_id\": 42 },\n    \"empfaenger\": {\n      \"name\": \"Amtsgericht Musterstadt\",\n      \"type\": \"Gericht\",\n      \"safeId\": \"de.justiz.bund.egvp.bea.12345\"\n    },\n    \"betroffener\": {\n      \"name\": { \"vorname\": \"Max\", \"nachname\": \"Mustermann\" },\n      \"geburtsdatum\": \"1950-01-15\"\n    }\n  }' \\\n  \"$HOST/api/duba/v1/memento\")\n\n# Step 2: Extract the magic link (already includes token + memento)\nMAGIC_LINK=$(echo \"$RESPONSE\" | jq -r '.magicLink')\nFULL_URL=\"$HOST$MAGIC_LINK\"\n\n# Step 3: Send to end user\necho \"Please review and submit: $FULL_URL\"\n# Or: mail, portal display, QR code, etc.\n</code></pre> <p>What happens when the user clicks: 1. MTL endpoint decrypts token \u2192 identifies user as <code>hospital-api</code> 2. Validates expiry (default: 1 hour from generation) 3. Creates session for <code>hospital-api</code> account 4. Redirects to <code>/duba/BetreuungAnregung?m={memento}</code> 5. User sees pre-filled guardianship form ready to review and submit</p>"},{"location":"Authentication/magic-token-link/#example-2-testing-mtl-tokens-curl","title":"Example 2: Testing MTL Tokens (curl)","text":"<pre><code># Generate token manually (for testing)\nTOKEN=$(curl -s -X POST \\\n  -u \"user:pass\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"jobId\":\"test-job\",\"absender\":{\"egvp_account_id\":42}}' \\\n  \"https://elim.example.com/api/duba/v1/memento\" | jq -r '.magicLink')\n\necho \"Magic link (relative): $TOKEN\"\n\n# Follow the magic link (with redirect following)\ncurl -L -c cookies.txt \"https://elim.example.com$TOKEN\"\n# After redirect, cookies.txt contains the SESSION cookie\n</code></pre>"},{"location":"Authentication/magic-token-link/#security","title":"Security","text":""},{"location":"Authentication/magic-token-link/#token-properties","title":"Token Properties","text":"Property Value Encryption AES-256-GCM (same key as memento system) Default expiry 1 hour from generation Forgeability Cannot be forged \u2014 server's encryption key required Tamper detection Any modification invalidates the token (GCM auth tag) Reuse Stateless \u2014 no single-use enforcement (by design, for simplicity)"},{"location":"Authentication/magic-token-link/#error-handling","title":"Error Handling","text":"<p>All validation failures redirect to <code>/login?error</code> without revealing the reason:</p> Failure HTTP Result Malformed/invalid token <code>302 \u2192 /login?error</code> Expired token <code>302 \u2192 /login?error</code> Unknown username <code>302 \u2192 /login?error</code> Invalid target URL <code>302 \u2192 /login?error</code> <p>No SESSION cookie is set on failure.</p>"},{"location":"Authentication/magic-token-link/#operational-notes","title":"Operational Notes","text":"<ul> <li>HTTPS is required in production \u2014 tokens are URL-safe but should not travel in plain text</li> <li>Token expiry is configured by the server \u2014 default is 1 hour; contact your administrator for details</li> <li>No revocation before expiry \u2014 if a token needs to be invalidated early, change the user's password (this rotates the KEK, making all existing tokens undecryptable)</li> <li>Tokens are not single-use \u2014 a valid, unexpired token can be used multiple times; this is acceptable because the token is time-limited and user-specific</li> </ul>"},{"location":"Authentication/magic-token-link/#integration-patterns","title":"Integration Patterns","text":""},{"location":"Authentication/magic-token-link/#pattern-1-api-magic-link-email-to-user-duba","title":"Pattern 1: API \u2192 Magic Link \u2192 Email to User (DUBA)","text":"<p>Use case: Hospital system creates court forms; hospital employees review and submit.</p> <pre><code>Hospital KIS\n    \u2193\n[1] POST /api/duba/v1/memento with patient/case data\n    \u2193\n[2] Response: { \"memento\": \"...\", \"magicLink\": \"/mtl/.../duba/form?m=...\" }\n    \u2193\n[3] KIS prepends host \u2192 absolute URL\n    \u2193\n[4] Send URL to hospital employee via email or portal\n    \u2193\nHospital Employee clicks link (no login required)\n    \u2193\n[5] GET /mtl/{token}?m={memento} \u2192 authenticated session\n    \u2193\n[6] 302 \u2192 /duba/BetreuungAnregung?m={memento}\n    \u2193\n[7] Employee reviews pre-filled form and submits to court\n</code></pre>"},{"location":"Authentication/magic-token-link/#pattern-2-direct-console-access-testingdevelopment","title":"Pattern 2: Direct Console Access (Testing/Development)","text":"<p>Use case: Developer or administrator needs quick authenticated access to a specific page.</p> <pre><code># Get a magic link for a known page\nLINK=$(curl -s -X POST -u \"$USER:$PASS\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"jobId\":\"dev-test\"}' \\\n  \"$HOST/api/duba/v1/memento\" | jq -r '.magicLink')\n\necho \"Open in browser: $HOST$LINK\"\n</code></pre>"},{"location":"Authentication/magic-token-link/#comparison-with-bal","title":"Comparison with BAL","text":"<p>Both BAL (<code>/bal/</code>) and MTL (<code>/mtl/</code>) convert an authentication mechanism into a session. They serve different use cases:</p> Aspect BAL MTL Credential in URL Yes (username:password) No (server-issued token) Generated by External system (constructs URL manually) Server (API response includes <code>magicLink</code>) Expiry No (valid until password changes) Yes (configurable, default 1 hour) Forgeable by external party Yes (if credentials known) No (requires server encryption key) Supports memento pre-fill Yes (via <code>?m=</code> parameter) Yes (via <code>?m=</code> parameter, included automatically) Use case Legacy integrations; manual URL construction New integrations; API returns link directly <p>Recommendation: - New integrations \u2192 use MTL. The API endpoint returns <code>magicLink</code> ready to use. - Existing BAL integrations continue to work. BAL is not deprecated.</p>"},{"location":"Authentication/magic-token-link/#related-documentation","title":"Related Documentation","text":"<ul> <li>Basic Auth Login (BAL) \u2014 Alternative session authentication via Basic Auth credentials</li> <li>DUBA API Tutorial \u2014 Complete DUBA workflow including MTL usage</li> <li>DUBA OpenAPI Specification \u2014 API schema including <code>MementoResponse.magicLink</code></li> </ul> <p>This is external-facing documentation for integration partners. For internal implementation details, see <code>src/main/java/de/vertama/web/magic/Controller.kt</code> and <code>Payload.kt</code> in the elim repository.</p>"},{"location":"Products/BELIM/api-tutorial/","title":"BELIM API Integration Guide","text":"<p>A practical guide for integration partners using the BELIM API.</p> <p>Version: 0.1.0 Last Updated: 2026-02-23</p>"},{"location":"Products/BELIM/api-tutorial/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Introduction</li> <li>Authentication</li> <li>Core Concepts</li> <li>Memento Endpoint</li> <li>Direct Submission Endpoint</li> <li>Report Retrieval Endpoints</li> <li>Error Handling</li> <li>Reference</li> </ol>"},{"location":"Products/BELIM/api-tutorial/#introduction","title":"Introduction","text":"<p>The BELIM API enables hospital information systems (KIS) to digitally submit or pre-fill bed occupancy reports (Bettenbelegung) for DEMIS. This API allows integration partners to:</p> <ul> <li>Create form mementos to generate pre-filled form URLs for user review</li> <li>Submit reports directly to DEMIS without user interaction</li> <li>Retrieve report results and status after submission</li> </ul>"},{"location":"Products/BELIM/api-tutorial/#use-case","title":"Use Case","text":"<p>BELIM offers two distinct integration patterns:</p> <p>1. Interactive Form Workflow (Memento) Best when hospital staff need to review or complete the data before submission. 1. Hospital system (KIS) calls the API with partial or complete occupancy data. 2. API returns an encrypted <code>memento</code> string. 3. System constructs and opens URL: <code>https://elim.vertamob.de/elim/pm/De/Bettenbelegung?m={memento}</code> 4. User reviews, adjusts if needed, and submits to DEMIS.</p> <p>2. Direct Submission Workflow Best when the external system has complete, verified data and wants to automate the process. 1. Hospital system (KIS) calls the API with complete, valid occupancy data. 2. API validates and submits directly to DEMIS. 3. API returns the outcome immediately.</p> <pre><code>KIS / Hospital System\n    \u2193\n[1] POST /api/belim/v1/memento    OR    POST /api/belim/v1/report\n    (Returns memento string)            (Submits directly to DEMIS)\n    \u2193\n    (If memento) Open pre-filled URL\n    \u2192 User submits\n    \u2193\n[2] GET /api/belim/v1/status/{reportId}  \u2192 Status (SUCCESS, FAILURE) + receipt PDF\n</code></pre>"},{"location":"Products/BELIM/api-tutorial/#openapi-specification","title":"OpenAPI Specification","text":"<p>The complete OpenAPI specification is available at:</p> <pre><code>https://elim.vertamob.de/api/docs/swagger-ui/index.html?urls.primaryName=BELIM\n</code></pre>"},{"location":"Products/BELIM/api-tutorial/#authentication","title":"Authentication","text":"<p>The API uses HTTP Basic Authentication with your API user credentials (the service account provided by your administrator).</p>"},{"location":"Products/BELIM/api-tutorial/#example","title":"Example","text":"<pre><code>curl -u \"api-username:api-password\" \\\n  -X POST \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"reportId\":\"BELIM-2026-001\"}' \\\n  https://elim.vertamob.de/api/belim/v1/memento\n</code></pre>"},{"location":"Products/BELIM/api-tutorial/#core-concepts","title":"Core Concepts","text":""},{"location":"Products/BELIM/api-tutorial/#bettenbelegsmeldung","title":"Bettenbelegsmeldung","text":"<p>The main data structure for bed occupancy reporting. Contains: - reportId (required): Unique laboratory report identifier for correlation. Must be unique per user. - StandortId: 6-digit InEK Standort-Id, identifying the unique hospital location. - IK_Nummer: 9-digit Institutionskennzeichen (IK) number. - numbers: Bed occupancy counts (occupied/operational beds for adults and children).</p>"},{"location":"Products/BELIM/api-tutorial/#memento-pattern","title":"Memento Pattern","text":"<p>A memento is an encrypted, URL-safe string that contains form pre-fill data. It allows you to securely pass patient/hospital data to the interactive form without persisting it prematurely. - Generated via <code>/api/belim/v1/memento</code> - Tamper-proof and URL-safe - Passed via URL parameter: <code>?m={memento}</code></p>"},{"location":"Products/BELIM/api-tutorial/#report-id","title":"Report ID","text":"<p>The <code>reportId</code> must be unique per API user. It serves to: 1. Correlate data: Identifying the exact report across your systems. 2. Retrieve Status: Used in <code>GET /api/belim/v1/status/{reportId}</code> to poll the delivery status and retrieve the PDF receipt.</p>"},{"location":"Products/BELIM/api-tutorial/#memento-endpoint","title":"Memento Endpoint","text":"<p>Endpoint: <code>POST /api/belim/v1/memento</code></p> <p>Purpose: Create an encrypted memento string for the interactive HTML form flow.</p>"},{"location":"Products/BELIM/api-tutorial/#request-body","title":"Request Body","text":"<p>Only <code>reportId</code> is strictly required for generating a memento. Other fields can be sent to pre-fill the form.</p> <p>Complete Example:</p> <pre><code>{\n  \"reportId\": \"BELIM-2026-00123\",\n  \"dateOfReport\": \"2026-02-23\",\n  \"StandortId\": \"987654\",\n  \"IK_Nummer\": \"987654321\",\n  \"Standortname\": \"Universit\u00e4tsklinikum Musterstadt\",\n  \"Strasse\": \"Musterstra\u00dfe\",\n  \"Hausnummer\": \"123\",\n  \"PLZ\": \"12345\",\n  \"Ort\": \"Musterstadt\",\n  \"Telefon\": \"+49 123 456789\",\n  \"numbers\": {\n    \"kinder_betten_belegt\": 3,\n    \"kinder_betten_betrieben\": 4,\n    \"erwachsenen_betten_belegt\": 1,\n    \"erwachsenen_betten_betrieben\": 2\n  }\n}\n</code></pre>"},{"location":"Products/BELIM/api-tutorial/#response","title":"Response","text":"<p>Returns a JSON object with the memento string.</p> <pre><code>{\n  \"memento\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\"\n}\n</code></pre>"},{"location":"Products/BELIM/api-tutorial/#direct-submission-endpoint","title":"Direct Submission Endpoint","text":"<p>Endpoint: <code>POST /api/belim/v1/report</code></p> <p>Purpose: Submit a complete BELIM bed occupancy report directly to DEMIS without user interaction.</p>"},{"location":"Products/BELIM/api-tutorial/#request-body_1","title":"Request Body","text":"<p>This requires a strictly validated object. All hospital details and numbers must be provided. By default, <code>StandortId</code>, <code>IK_Nummer</code>, and <code>numbers</code> are mandatory for a valid DEMIS submission.</p> <pre><code>{\n  \"reportId\": \"BELIM-2026-00124\",\n  \"dateOfReport\": \"2026-02-23\",\n  \"StandortId\": \"987654\",\n  \"IK_Nummer\": \"987654321\",\n  \"Standortname\": \"Universit\u00e4tsklinikum Musterstadt\",\n  \"Strasse\": \"Musterstra\u00dfe\",\n  \"Hausnummer\": \"123\",\n  \"PLZ\": \"12345\",\n  \"Ort\": \"Musterstadt\",\n  \"Telefon\": \"+49 123 456789\",\n  \"numbers\": {\n    \"kinder_betten_belegt\": 5,\n    \"kinder_betten_betrieben\": 10,\n    \"erwachsenen_betten_belegt\": 20,\n    \"erwachsenen_betten_betrieben\": 50\n  }\n}\n</code></pre>"},{"location":"Products/BELIM/api-tutorial/#response_1","title":"Response","text":"<p>Returns a JSON status response immediately detailing success or failure.</p> <pre><code>{\n  \"reportId\": \"BELIM-2026-00124\",\n  \"succeeded\": true,\n  \"errorMsg\": null\n}\n</code></pre>"},{"location":"Products/BELIM/api-tutorial/#report-retrieval-endpoints","title":"Report Retrieval Endpoints","text":""},{"location":"Products/BELIM/api-tutorial/#get-reports-list-pending-report-ids","title":"GET /reports \u2014 List pending report IDs","text":"<p>Endpoint: <code>GET /api/belim/v1/reports</code></p> <p>Returns an array of <code>reportId</code> strings for reports that have been submitted to DEMIS but not yet retrieved (unpolled). Reports disappear from this list once retrieved without <code>?peek=true</code>.</p> <p>Request:</p> <pre><code>curl -u \"api-user:api-pass\" \\\n  https://elim.vertamob.de/api/belim/v1/reports\n</code></pre> <p>Response (200):</p> <pre><code>[\"BELIM-2026-00123\", \"BELIM-2026-00124\"]\n</code></pre> <p>An empty array <code>[]</code> means no submissions are pending retrieval.</p>"},{"location":"Products/BELIM/api-tutorial/#get-reportsreportid-retrieve-report-result","title":"GET /reports/{reportId} \u2014 Retrieve report result","text":"<p>Endpoint: <code>GET /api/belim/v1/status/{reportId}</code></p> <p>Purpose: Retrieve the transmission status and payload receipt for any previously submitted report.</p> <p>Request:</p> <pre><code>curl -u \"api-user:api-pass\" \\\n  \"https://elim.vertamob.de/api/belim/v1/status/BELIM-2026-00123\"\n</code></pre> <p>Response (200 \u2014 SUCCESS):</p> <pre><code>{\n  \"reportId\": \"BELIM-2026-00123\",\n  \"succeeded\": true,\n  \"sendDate\": \"2026-02-23T14:32:00Z\",\n  \"formName\": \"belim.direct\",\n  \"errorMsg\": null,\n  \"base64Pdf\": \"JVBERi0xLjQK...\"\n}\n</code></pre> <p>Status semantics: - <code>succeeded</code>: <code>true</code> if DEMIS successfully accepted the payload. - <code>base64Pdf</code>: Contains the PDF receipt provided by DEMIS (if available). - <code>errorMsg</code>: Contains the failure reason if submission failed.</p>"},{"location":"Products/BELIM/api-tutorial/#error-handling","title":"Error Handling","text":""},{"location":"Products/BELIM/api-tutorial/#http-status-codes","title":"HTTP Status Codes","text":"Code Status Meaning 200 OK Request successful 400 Bad Request Invalid JSON or validation error 401 Unauthorized Missing or invalid API credentials 404 Not Found Report ID does not exist"},{"location":"Products/BELIM/api-tutorial/#validation-errors","title":"Validation Errors","text":"<p>If the request data is invalid (e.g. missing <code>reportId</code>), a 400 Bad Request is returned:</p> <pre><code>{\n  \"errors\": [\"reportId must not be null\"]\n}\n</code></pre>"},{"location":"Products/BELIM/api-tutorial/#reference","title":"Reference","text":""},{"location":"Products/BELIM/api-tutorial/#api-endpoints-summary","title":"API Endpoints Summary","text":"Method Endpoint Description POST <code>/api/belim/v1/memento</code> Create memento for interactive form POST <code>/api/belim/v1/report</code> Submit report directly via API GET <code>/api/belim/v1/status/{reportId}</code> Retrieve report delivery status &amp; receipt PDF"},{"location":"Products/BELIM/api-tutorial/#date-structure","title":"Date Structure","text":"<ul> <li>Date Format: ISO 8601 string (<code>YYYY-MM-DD</code>, e.g., <code>2026-02-23</code>)</li> </ul> <p>Document Version: 0.1.0 Last Updated: 2026-02-23 API Version: v1</p>"},{"location":"Products/DIGG/api-tutorial/","title":"DIGG API Integration Guide","text":"<p>A practical guide for integration partners using the DIGG (Digitale Geburtsanzeige) API.</p> <p>Version: 0.1.0 Last Updated: 2026-02-23</p>"},{"location":"Products/DIGG/api-tutorial/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Introduction</li> <li>Authentication</li> <li>Core Concepts</li> <li>Memento Endpoint</li> <li>Report Retrieval Endpoints</li> <li>Error Handling</li> <li>Reference</li> </ol>"},{"location":"Products/DIGG/api-tutorial/#introduction","title":"Introduction","text":"<p>The DIGG API enables hospital information systems (KIS) to pre-fill digital birth registration forms (Geburtsanzeige) for the civil registry office (Standesamt) via xPersonenstand integration. This API allows integration partners to:</p> <ul> <li>Create form mementos to generate pre-filled form URLs from hospital birth data</li> <li>Enable user review by hospital staff or midwives before official submission</li> <li>Retrieve report results and status after end users submit forms to the Standesamt</li> </ul>"},{"location":"Products/DIGG/api-tutorial/#use-case","title":"Use Case","text":"<p>DIGG solves the digital transmission of a Geburtsanzeige:</p> <ol> <li>Hospital system (KIS) has birth data but wants staff to review and complete the form before xPersonenstand submission</li> <li>System calls API with birth report data as JSON</li> <li>API returns an encrypted memento string</li> <li>System uses the <code>memento</code> to open a prefilled form</li> <li>User reviews, completes missing info, applies digital signature/seal, and submits to the Standesamt</li> <li>System automatically polls for the processing status and signed confirmation PDF</li> </ol> <pre><code>KIS / Hospital System\n    \u2193\n[1] POST /api/digg/v1/memento  (API user credentials)\n    \u2193\n[2] Receives { \"memento\": \"...\" }\n    \u2193\n[3] Constructs absolute URL: https://elim.vertamob.de/digg/Geburtsbescheinigung?m={memento}\n    \u2193\n[4] Opens URL in browser\n    \u2193\nEnd User\n    \u2193\n[6] Reviews pre-filled data, completes form, applies signature/seal \u2192 submits to Standesamt\n    \u2193\nKIS / Hospital System (asynchronous)\n    \u2193\n[7] GET /api/digg/v1/reports/{reportId}  \u2192 status (PENDING, SUCCESS, FAILURE) + receipt PDF\n</code></pre> <p>Benefits: - No direct automated submission \u2014 users maintain control and can review/correct data - Form validation happens in browser (immediate feedback) - Secure, encrypted mementos protect sensitive parent/child data</p>"},{"location":"Products/DIGG/api-tutorial/#prerequisites","title":"Prerequisites","text":"<p>Before using the API, you need: - API User Credentials: Username and password provided by your administrator - Seal or Signature: You have to create a seal or signature and deposit it at https://elim.vertamob.de/home/signaturen</p>"},{"location":"Products/DIGG/api-tutorial/#openapi-specification","title":"OpenAPI Specification","text":"<p>The complete OpenAPI specification is available at:</p> <pre><code>https://elim.vertamob.de/api/docs/swagger-ui/index.html?urls.primaryName=DIGG\n</code></pre>"},{"location":"Products/DIGG/api-tutorial/#authentication","title":"Authentication","text":"<p>The API uses HTTP Basic Authentication with your API user credentials (the service account provided by your administrator). End users accessing the form do not need separate credentials.</p>"},{"location":"Products/DIGG/api-tutorial/#example","title":"Example","text":"<pre><code>curl -u \"api-username:api-password\" \\\n  -X POST \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"reportId\":\"DIGG-2026-001\"}' \\\n  https://elim.vertamob.de/api/digg/v1/memento\n</code></pre>"},{"location":"Products/DIGG/api-tutorial/#core-concepts","title":"Core Concepts","text":""},{"location":"Products/DIGG/api-tutorial/#geburtsanzeige","title":"Geburtsanzeige","text":"<p>The main data structure for birth registration reporting. Key fields include: - reportId (required): Unique report identifier for tracking - StandortId: ID of the reporting hospital - geburtsangaben: Details about time and place of birth - kind: Child's gender and names - mutter: Mother's standard or confidential data (vertrauliche Geburt) - elternteil2: Optional secondary parent data</p>"},{"location":"Products/DIGG/api-tutorial/#digital-signature-siegel-signatur","title":"Digital Signature (Siegel / Signatur)","text":"<p>Submitting a birth registration to the Standesamt via xPersonenstand legally requires a valid digital signature or seal. If a seal is available it will be applied automatically, otherwise the end user will be prompted to apply this signature directly within the DIGG form interface prior to final submission. This step is mandatory; a report cannot be sent without it.</p>"},{"location":"Products/DIGG/api-tutorial/#memento-pattern","title":"Memento Pattern","text":"<p>A memento is an encrypted, URL-safe string that contains form pre-fill data: - Generated from JSON hospital report data - Tamper-proof and URL-safe - Used as query parameter: <code>?m={memento}</code></p>"},{"location":"Products/DIGG/api-tutorial/#report-id","title":"Report ID","text":"<p>The <code>reportId</code> field must be unique per API user. It serves a dual purpose: 1. Form pre-fill and correlation: Correlates the hospital data to the form 2. Status retrieval key: After submission, used to retrieve delivery status via <code>GET /api/digg/v1/status/{reportId}</code></p>"},{"location":"Products/DIGG/api-tutorial/#memento-endpoint","title":"Memento Endpoint","text":"<p>Endpoint: <code>POST /api/digg/v1/memento</code></p> <p>Purpose: Create encrypted memento string and magic link to pre-fill DIGG reporting forms.</p>"},{"location":"Products/DIGG/api-tutorial/#request-body","title":"Request Body","text":"<p>Only <code>reportId</code> is required; all other fields are optional to allow partial pre-filling.</p> <p>Minimal Example:</p> <pre><code>{\n  \"reportId\": \"DIGG-2026-00001\"\n}\n</code></pre> <p>Complete Example:</p> <pre><code>{\n  \"reportId\": \"DIGG-2026-00123\",\n  \"standortId\": \"770001\",\n  \"nameEinrichtung\": \"Universit\u00e4tsklinikum Musterstadt\",\n  \"totgeburt\": false,\n  \"vertraulicheGeburt\": false,\n  \"geburtsangaben\": {\n    \"tag\": \"2026-02-23\",\n    \"uhrzeit\": \"14:30\",\n    \"ort\": {\n      \"strasse\": \"Klinikstra\u00dfe\",\n      \"hausnummer\": \"1\",\n      \"ort\": \"Musterstadt\"\n    }\n  },\n  \"kind\": {\n    \"geschlecht\": \"WEIBLICH\",\n    \"name\": {\n      \"vornamen\": \"Emma Sophie\",\n      \"familienname\": \"Mustermann\"\n    }\n  },\n  \"mutter\": {\n    \"standard\": {\n      \"name\": {\n        \"vornamen\": \"Anna\",\n        \"familienname\": \"Mustermann\",\n        \"geburtsname\": \"Schmidt\"\n      },\n      \"geburtsdatum\": \"1990-05-15\",\n      \"anschrift\": {\n        \"strasse\": \"Musterweg\",\n        \"hausnummer\": \"12\",\n        \"postleitzahl\": \"12345\",\n        \"wohnort\": \"Musterstadt\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"Products/DIGG/api-tutorial/#response","title":"Response","text":"<pre><code>{\n  \"memento\": \"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..DGG5lQvJC8OpYrCt.Xm8YR...\"\n}\n</code></pre>"},{"location":"Products/DIGG/api-tutorial/#report-retrieval-endpoints","title":"Report Retrieval Endpoints","text":"<p>DIGG reports are delivered asynchronously via xPersonenstand/XTA2 transport.</p>"},{"location":"Products/DIGG/api-tutorial/#get-reports-list-pending-report-ids","title":"GET /reports \u2014 List pending report IDs","text":"<p>Endpoint: <code>GET /api/digg/v1/reports</code></p> <p>Returns an array of <code>reportId</code> strings for reports that have been submitted to DEMIS but not yet retrieved (unpolled). Reports disappear from this list once retrieved without <code>?peek=true</code>.</p> <p>Request:</p> <pre><code>curl -u \"api-user:api-pass\" \\\n  https://elim.vertamob.de/api/digg/v1/reports\n</code></pre> <p>Response (200):</p> <pre><code>[\"DIGG-2026-00123\", \"DIGG-2026-00124\"]\n</code></pre> <p>An empty array <code>[]</code> means no submissions are pending retrieval.</p>"},{"location":"Products/DIGG/api-tutorial/#get-reportsreportid-retrieve-report-result","title":"GET /reports/{reportId} \u2014 Retrieve report result","text":"<p>Endpoint: <code>GET /api/digg/v1/reports/{reportId}</code></p> <p>Parameters: - <code>reportId</code> (path, required) - <code>peek</code> (query, optional): <code>true</code> for non-destructive read. Default: <code>false</code>.</p> <p>Non-destructive peek:</p> <pre><code>curl -u \"api-user:api-pass\" \\\n  \"https://elim.example.com/api/digg/v1/reports/DIGG-2026-00123?peek=true\"\n</code></pre> <p>Response (200 \u2014 SUCCESS):</p> <pre><code>{\n  \"reportId\": \"DIGG-2026-00123\",\n  \"status\": \"SUCCESS\",\n  \"module\": \"DIGG\",\n  \"submittedAt\": \"2026-02-23T14:32:00Z\",\n  \"portal\": \"StandesamtPortal\",\n  \"receiptPdf\": \"JVBERi0xLjQK...\",\n  \"failureReason\": null\n}\n</code></pre> <p>Status semantics: - <code>PENDING</code>: Sent but delivery not yet confirmed. Not marked as polled. - <code>SUCCESS</code>: Successfully delivered to receiver. Contains <code>receiptPdf</code> (base64). - <code>FAILURE</code>: Transport failed. Contains <code>failureReason</code>.</p> <p>Note: By default, reading a SUCCESS or FAILURE report is destructive (it is marked as polled and disappears from future calls unless <code>?peek=true</code> is used).</p>"},{"location":"Products/DIGG/api-tutorial/#error-handling","title":"Error Handling","text":""},{"location":"Products/DIGG/api-tutorial/#http-status-codes","title":"HTTP Status Codes","text":"Code Status Meaning 200 OK Request successful 400 Bad Request Invalid JSON or validation error 401 Unauthorized Missing or invalid API credentials 404 Not Found Report ID does not exist 410 Gone Report was already retrieved (use <code>?peek=true</code> to avoid)"},{"location":"Products/DIGG/api-tutorial/#validation-errors","title":"Validation Errors","text":"<p>If the request data is invalid (e.g. missing <code>reportId</code>), a 400 Bad Request is returned:</p> <pre><code>{\n  \"errors\": [\"reportId must not be null\"]\n}\n</code></pre>"},{"location":"Products/DIGG/api-tutorial/#reference","title":"Reference","text":""},{"location":"Products/DIGG/api-tutorial/#api-endpoints-summary","title":"API Endpoints Summary","text":"Method Endpoint Description POST <code>/api/digg/v1/memento</code> Create memento GET <code>/api/digg/v1/reports/{reportId}</code> Retrieve report delivery status"},{"location":"Products/DIGG/api-tutorial/#date-time-format","title":"Date &amp; Time Format","text":"<ul> <li>Date: ISO 8601 format (<code>YYYY-MM-DD</code>, e.g., <code>2026-02-23</code>)</li> <li>Time: ISO 8601 format (<code>HH:mm</code>, e.g., <code>14:30</code>)</li> </ul>"},{"location":"Products/DIGG/api-tutorial/#gender-enum-values","title":"Gender Enum Values","text":"Value Description <code>MAENNLICH</code> Male <code>WEIBLICH</code> Female <code>UNBESTIMMT</code> Unspecified <p>Document Version: 0.1.0 Last Updated: 2026-02-23 API Version: v1</p>"},{"location":"Products/DIVI/api-tutorial/","title":"DIVI API Integration Guide","text":"<p>A practical guide for integration partners using the DIVI (Intensivregister) API.</p> <p>Version: 0.1.0 Last Updated: 2026-02-23</p>"},{"location":"Products/DIVI/api-tutorial/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Introduction</li> <li>Authentication</li> <li>Core Concepts</li> <li>Direct Submission Endpoint</li> <li>Memento Endpoint</li> <li>Report Retrieval Endpoints</li> <li>Error Handling</li> <li>Reference</li> </ol>"},{"location":"Products/DIVI/api-tutorial/#introduction","title":"Introduction","text":"<p>The DIVI API enables hospital information systems (KIS) to automate capacity reporting to the DIVI Intensivregister. This API allows integration partners to:</p> <ul> <li>Submit reports directly (machine-to-machine) without user interaction.</li> <li>Create form mementos to pre-fill the interactive browser form for manual review.</li> <li>Retrieve report results, tracking status, and RKI receipt PDFs for confirmation.</li> </ul>"},{"location":"Products/DIVI/api-tutorial/#use-cases","title":"Use Cases","text":"<p>The DIVI module supports two distinct workflows:</p> <p>Workflow A: Fully Automated (Direct Submission) 1. Hospital system (KIS) gathers bed occupancy (Kapazit\u00e4ten) and situation data. 2. System calls API <code>POST /api/divi/v1/report</code> with the full data payload. 3. API submits immediately to the DIVI Intensivregister and returns success/failure. 4. System calls API <code>GET /api/divi/v1/status/{reportId}</code> to download the official PDF receipt.</p> <p>Workflow B: Staff Review (Memento &amp; Pre-fill) 1. Hospital system (KIS) gathers partial or complete data. 2. System calls API <code>POST /api/divi/v1/memento</code> to get an encrypted <code>memento</code> string. 3. System constructs URL to the interactive DIVI form: <code>https://elim.vertamob.de/divi/?m={memento}</code>. 4. User opens the link, reviews the pre-filled data, completes missing fields, and clicks submit.</p>"},{"location":"Products/DIVI/api-tutorial/#prerequisites","title":"Prerequisites","text":"<p>Before using the API, you need: - API User Credentials: Basic Auth username and password provided by your administrator. - Meldebereich ID: The identifier of your intensive care unit (ICU) provided by DIVI.</p>"},{"location":"Products/DIVI/api-tutorial/#openapi-specification","title":"OpenAPI Specification","text":"<p>The complete OpenAPI specification is available at:</p> <pre><code>https://elim.vertamob.de/api/docs/swagger-ui/index.html?urls.primaryName=DIVI\n</code></pre>"},{"location":"Products/DIVI/api-tutorial/#authentication","title":"Authentication","text":"<p>The API uses HTTP Basic Authentication with your API user credentials.</p>"},{"location":"Products/DIVI/api-tutorial/#example","title":"Example","text":"<pre><code>curl -u \"api-username:api-password\" \\\n  https://elim.vertamob.de/api/divi/v1/status/divi-2026-001\n</code></pre>"},{"location":"Products/DIVI/api-tutorial/#core-concepts","title":"Core Concepts","text":""},{"location":"Products/DIVI/api-tutorial/#intensivregister-meldung","title":"Intensivregister Meldung","text":"<p>The main data structure for reporting. Key components include: - reportId (required): Your unique identifier for tracking this specific submission. - meldebereich (required): The specific ICU taking the report. - auspraegung (required): Report format version (always <code>\"V2\"</code>). - kapazitaeten (required): ICU capacity counts (total beds, occupied, ECMO, etc.). - betriebssituation: Operational status of the hospital. - faelleCovidAktuell, altersstrata, neuaufnahmen, influenzaStatus, rsvStatus: Optional extended metric blocks for patient populations.</p>"},{"location":"Products/DIVI/api-tutorial/#direct-vs-memento","title":"Direct vs. Memento","text":"<ul> <li>The Direct Submission endpoint requires all mandatory fields to perform the transmission.</li> <li>The Memento endpoint requires only <code>reportId</code> (others are optional), as it merely encrypts the data to assist the human user in filling out the UI form.</li> </ul>"},{"location":"Products/DIVI/api-tutorial/#report-id","title":"Report ID","text":"<p>The <code>reportId</code> field must be unique per API user. It is used to retrieve the result and PDF receipt later via <code>GET /api/divi/v1/status/{reportId}</code>.</p>"},{"location":"Products/DIVI/api-tutorial/#direct-submission-endpoint","title":"Direct Submission Endpoint","text":"<p>Endpoint: <code>POST /api/divi/v1/report</code></p> <p>Purpose: Submits complete DIVI report data directly to the DIVI Intensivregister API.</p>"},{"location":"Products/DIVI/api-tutorial/#request-body","title":"Request Body","text":"<p>Minimal Example:</p> <pre><code>{\n  \"reportId\": \"divi-2026-00001\",\n  \"meldebereich\": {\n    \"id\": \"MB-12345\"\n  },\n  \"auspraegung\": \"V2\",\n  \"betriebssituation\": \"REGULAERER_BETRIEB\",\n  \"kapazitaeten\": {\n    \"intensivBetten\": 20,\n    \"intensivBettenBelegt\": 15\n  }\n}\n</code></pre>"},{"location":"Products/DIVI/api-tutorial/#response","title":"Response","text":"<p>Returns a JSON object indicating immediate submission success or the DIVI API failure reason.</p> <pre><code>{\n  \"reportId\": \"divi-2026-00001\",\n  \"succeeded\": true,\n  \"errorMsg\": null\n}\n</code></pre> Field Type Nullable Description <code>reportId</code> string No The report identifier you provided <code>succeeded</code> boolean No <code>true</code> if accepted by DIVI Intesivregister <code>errorMsg</code> string Yes Error text from the upstream API if <code>succeeded</code> is <code>false</code>"},{"location":"Products/DIVI/api-tutorial/#memento-endpoint","title":"Memento Endpoint","text":"<p>Endpoint: <code>POST /api/divi/v1/memento</code></p> <p>Purpose: Create encrypted memento string to pre-fill the interactive HTML form.</p>"},{"location":"Products/DIVI/api-tutorial/#request-body_1","title":"Request Body","text":"<p>Same structure as Direct Submission, but only <code>reportId</code> is strictly required.</p> <pre><code>{\n  \"reportId\": \"divi-2026-00002\",\n  \"kapazitaeten\": {\n    \"intensivBetten\": 20,\n    \"intensivBettenBelegt\": 16\n  }\n}\n</code></pre>"},{"location":"Products/DIVI/api-tutorial/#response_1","title":"Response","text":"<p>Returns the encrypted memento string.</p> <pre><code>{\n  \"memento\": \"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..DGG5lQvJC8OpYrCt.Xm8YR...\"\n}\n</code></pre> <p>You can then pass this string to your users: <code>https://elim.vertamob.de/divi/?m=eyJhb...</code></p>"},{"location":"Products/DIVI/api-tutorial/#report-retrieval-endpoints","title":"Report Retrieval Endpoints","text":"<p>After a report is submitted (either directly via <code>api/divi/v1/report</code> or interactively by a user who used a memento link), you can download the status and PDF receipt.</p>"},{"location":"Products/DIVI/api-tutorial/#get-reports-list-pending-report-ids","title":"GET /reports \u2014 List pending report IDs","text":"<p>Endpoint: <code>GET /api/divi/v1/reports</code></p> <p>Returns an array of <code>reportId</code> strings for reports that have been submitted to DEMIS but not yet retrieved (unpolled). Reports disappear from this list once retrieved without <code>?peek=true</code>.</p> <p>Request:</p> <pre><code>curl -u \"api-user:api-pass\" \\\n  https://elim.vertamob.de/api/divi/v1/reports\n</code></pre> <p>Response (200):</p> <pre><code>[\"DIVI-2026-00123\", \"DIVI-2026-00124\"]\n</code></pre> <p>An empty array <code>[]</code> means no submissions are pending retrieval.</p> <p>Endpoint: <code>GET /api/divi/v1/status/{reportId}</code></p> <p>Returns the full report result including the PDF receipt for successful submissions.</p> <p>Parameters:</p> Parameter In Required Description <code>reportId</code> path Yes The report ID from your original submission <p>Request Example:</p> <pre><code>curl -u \"api-user:api-pass\" \\\n  https://elim.vertamob.de/api/divi/v1/status/divi-2026-00001\n</code></pre> <p>Response (200 \u2014 SUCCESS):</p> <pre><code>{\n  \"reportId\": \"divi-2026-00001\",\n  \"succeeded\": true,\n  \"sendDate\": \"2026-02-23T14:32:00Z\",\n  \"formName\": \"DIVI\",\n  \"errorMsg\": null,\n  \"base64Pdf\": \"JVBERi0xLjQK...\"\n}\n</code></pre> <p>By default, reading this status marks it as polled. If polled a second time, the endpoint will return <code>410 Gone</code>.</p>"},{"location":"Products/DIVI/api-tutorial/#extracting-the-receipt-pdf","title":"Extracting the Receipt PDF","text":"<p>The <code>base64Pdf</code> field contains the base64-encoded PDF. To save it:</p> <pre><code>RESPONSE=$(curl -s -u \"api-user:api-pass\" \\\n  \"https://elim.vertamob.de/api/divi/v1/status/divi-2026-00001\")\n\nif [ \"$(echo \"$RESPONSE\" | jq -r '.succeeded')\" = \"true\" ]; then\n  echo \"$RESPONSE\" | jq -r '.base64Pdf' | base64 --decode &gt; divi-receipt.pdf\n  echo \"Receipt saved.\"\nelse\n  echo \"Submission failed.\"\nfi\n</code></pre>"},{"location":"Products/DIVI/api-tutorial/#error-handling","title":"Error Handling","text":""},{"location":"Products/DIVI/api-tutorial/#http-status-codes","title":"HTTP Status Codes","text":"Code Status Meaning 200 OK Request successful (Check <code>succeeded</code> / <code>errorMsg</code> inside body) 400 Bad Request Invalid JSON structure or required fields missing 401 Unauthorized Missing or invalid API credentials 404 Not Found Report ID does not exist 410 Gone Status for this report was already retrieved (polled)"},{"location":"Products/DIVI/api-tutorial/#validation-errors","title":"Validation Errors","text":"<p>If the request lacks mandatory fields, a 400 Bad Request is returned:</p> <pre><code>{\n  \"errors\": [\"kapazitaeten.intensivBetten must be greater than or equal to 0\"]\n}\n</code></pre>"},{"location":"Products/DIVI/api-tutorial/#reference","title":"Reference","text":""},{"location":"Products/DIVI/api-tutorial/#api-endpoints-summary","title":"API Endpoints Summary","text":"Method Endpoint Description POST <code>/api/divi/v1/report</code> Submit report directly POST <code>/api/divi/v1/memento</code> Create memento string for pre-fill GET <code>/api/divi/v1/status/{reportId}</code> Retrieve submission result and PDF <p>Document Version: 0.1.0 Last Updated: 2026-02-23 API Version: v1</p>"},{"location":"Products/DUBA/api-tutorial/","title":"DUBA API Integration Guide","text":"<p>A practical guide for integration partners using the DUBA (Digital Court Guardianship) API.</p> <p>Version: 0.2.1 Last Updated: 2026-02-19</p>"},{"location":"Products/DUBA/api-tutorial/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Introduction</li> <li>Authentication</li> <li>Core Concepts</li> <li>List Messages Endpoint</li> <li>Understanding MessageInfo</li> <li>Download Message Endpoint</li> <li>Acknowledge Messages Endpoint</li> <li>Form Pre-fill with Memento Endpoint<ul> <li>Using the Magic Link (Recommended)</li> <li>Alternative: Manual Form URL</li> </ul> </li> <li>Complete Workflow Examples</li> <li>Filtering Best Practices</li> <li>Error Codes</li> <li>Reference</li> </ol>"},{"location":"Products/DUBA/api-tutorial/#introduction","title":"Introduction","text":"<p>The DUBA API provides programmatic access to court messages exchanged via EGVP (Elektronisches Gerichts- und Verwaltungspostfach). This API allows integration partners to:</p> <ul> <li>List available messages with filtering by job ID, Safe-ID, or timestamp</li> <li>Download messages as ZIP files containing XJustiz XML and attachments</li> <li>Acknowledge messages to trigger cleanup of sensitive data (GDPR compliance)</li> <li>Create form mementos to generate pre-filled form URLs from your system data</li> </ul>"},{"location":"Products/DUBA/api-tutorial/#prerequisites","title":"Prerequisites","text":"<p>Before using the API, you need: - API User Credentials: Username and password provided by your administrator - Base URL: Your DUBA instance URL (e.g., <code>https://elim.example.com</code>) - Safe-ID: EGVP Safe-ID(s) you have access to</p>"},{"location":"Products/DUBA/api-tutorial/#api-versioning","title":"API Versioning","text":"<p>All endpoints are versioned under <code>/api/duba/v1/</code>.</p>"},{"location":"Products/DUBA/api-tutorial/#openapi-specification","title":"OpenAPI Specification","text":"<p>The complete OpenAPI specification is available at:</p> <pre><code>https://your-instance/api/docs/swagger-ui/index.html?urls.primaryName=DUBA\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#authentication","title":"Authentication","text":"<p>The API uses HTTP Basic Authentication with your API user credentials.</p> <p>Note on end-user authentication: The <code>magicLink</code> field returned by the memento endpoint handles end-user authentication automatically via Magic Token Link (MTL). The Basic Auth Login (BAL) pattern (credentials embedded in URLs) is deprecated since v0.2.1 and should not be used for new integrations.</p>"},{"location":"Products/DUBA/api-tutorial/#how-it-works","title":"How It Works","text":"<ol> <li>Your administrator creates an API user account with username and password</li> <li>For each API request, provide credentials in the <code>Authorization</code> header</li> <li>Internally, the system derives a KEK (Key Encryption Key) from your password for cryptographic operations, but you only need to provide your username and password</li> </ol>"},{"location":"Products/DUBA/api-tutorial/#example","title":"Example","text":"<pre><code>curl -u \"username:password\" \\\n  https://elim.example.com/api/duba/v1/messages\n</code></pre> <p>Or explicitly with Authorization header:</p> <pre><code># Encode credentials (username:password in base64)\necho -n \"username:password\" | base64\n# Result: dXNlcm5hbWU6cGFzc3dvcmQ=\n\ncurl -H \"Authorization: Basic dXNlcm5hbWU6cGFzc3dvcmQ=\" \\\n  https://elim.example.com/api/duba/v1/messages\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#core-concepts","title":"Core Concepts","text":""},{"location":"Products/DUBA/api-tutorial/#message-states","title":"Message States","text":"<p>Messages go through different states in the system:</p> <ol> <li>Indexed: Message metadata discovered from EGVP (lightweight, fast)</li> <li>Hydrated: Full message downloaded and XJustiz parsed (aktenzeichen extracted)</li> <li>Available: Message can be downloaded via API</li> </ol> <p>Important: Only hydrated messages have complete metadata (aktenzeichen, sender info).</p>"},{"location":"Products/DUBA/api-tutorial/#job-ids-vs-aktenzeichen","title":"Job IDs vs Aktenzeichen","text":"<p>Two different identifiers are used:</p> <ul> <li>jobId: Your internal work tracking ID (e.g., <code>\"job-2024-001\"</code>)</li> <li>Arbitrary string meaningful to your system</li> <li>Used to correlate messages with your cases</li> <li> <p>Set when sending messages via DUBA</p> </li> <li> <p>aktenzeichen: German legal case reference number (e.g., <code>\"AZ-12345-2024\"</code>)</p> </li> <li>Formal XJustiz identifier required in court communications</li> <li>Extracted from message content after hydration</li> <li>Used by courts and legal systems</li> </ul> <p>Mapping: The system maintains a mapping between your jobIds and aktenzeichen values.</p>"},{"location":"Products/DUBA/api-tutorial/#message-direction","title":"Message Direction","text":"<p>Messages have a direction:</p> <ul> <li>INCOMING: Received from external courts or systems</li> <li>OUTGOING: Sent by you to external recipients</li> </ul>"},{"location":"Products/DUBA/api-tutorial/#processcard-timestamps","title":"ProcessCard Timestamps","text":"<p>Messages include timestamps from the EGVP ProcessCard:</p> <ul> <li>createdAt (<code>tspCreation</code>): When message arrived at EGVP server (always present)</li> <li>receivedAt (<code>tspReception</code>): When first retrieved by anyone</li> <li>For INCOMING: When you or another system downloaded it</li> <li>For OUTGOING: When the recipient downloaded it</li> <li><code>null</code> if not yet retrieved</li> <li>hydratedAt: When the system fully processed the message (downloaded + parsed)</li> <li><code>null</code> if not yet hydrated</li> </ul>"},{"location":"Products/DUBA/api-tutorial/#list-messages-endpoint","title":"List Messages Endpoint","text":"<p>Endpoint: <code>GET /api/duba/v1/messages</code></p> <p>Purpose: Query available messages with optional filtering.</p>"},{"location":"Products/DUBA/api-tutorial/#query-parameters","title":"Query Parameters","text":"Parameter Type Required Description <code>jobId</code> array[string] No Filter by your job IDs. Can specify multiple times. <code>safeId</code> array[string] No Filter by EGVP Safe-IDs. Can specify multiple times. <code>since</code> string (ISO 8601) No Only messages created after this timestamp."},{"location":"Products/DUBA/api-tutorial/#response","title":"Response","text":"<p>Returns an array of <code>MessageInfo</code> objects (see Understanding MessageInfo).</p>"},{"location":"Products/DUBA/api-tutorial/#examples","title":"Examples","text":""},{"location":"Products/DUBA/api-tutorial/#get-all-available-messages","title":"Get all available messages","text":"<pre><code>curl -u \"user:pass\" \\\n  https://elim.example.com/api/duba/v1/messages\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#filter-by-single-job-id","title":"Filter by single job ID","text":"<pre><code>curl -u \"user:pass\" \\\n  \"https://elim.example.com/api/duba/v1/messages?jobId=job-2024-001\"\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#filter-by-multiple-job-ids","title":"Filter by multiple job IDs","text":"<pre><code>curl -u \"user:pass\" \\\n  \"https://elim.example.com/api/duba/v1/messages?jobId=job-123&amp;jobId=job-456\"\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#get-recent-messages-since-timestamp","title":"Get recent messages (since timestamp)","text":"<pre><code>curl -u \"user:pass\" \\\n  \"https://elim.example.com/api/duba/v1/messages?since=2025-11-25T10:00:00Z\"\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#combine-multiple-filters","title":"Combine multiple filters","text":"<pre><code>curl -u \"user:pass\" \\\n  \"https://elim.example.com/api/duba/v1/messages?jobId=job-123&amp;safeId=safe-abc&amp;since=2025-11-25T10:00:00Z\"\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#filtering-behavior","title":"Filtering Behavior","text":"<p>Important semantic note:</p> <ul> <li>Without <code>jobId</code> filter: Returns ALL messages (hydrated + non-hydrated)</li> <li>With <code>jobId</code> filter: Returns only messages for those jobs</li> <li>Naturally returns only hydrated messages (because jobId mapping requires aktenzeichen)</li> <li>Non-hydrated messages cannot be matched to jobs yet (no aktenzeichen extracted)</li> </ul> <p>This is intentional and correct behavior, not a bug.</p>"},{"location":"Products/DUBA/api-tutorial/#understanding-messageinfo","title":"Understanding MessageInfo","text":"<p>The API returns <code>MessageInfo</code> objects with complete message metadata.</p>"},{"location":"Products/DUBA/api-tutorial/#field-reference","title":"Field Reference","text":"Field Type Nullable Description <code>id</code> integer No Message index ID - use this for download <code>messageId</code> string No EGVP/Vibilia transport message ID <code>jobId</code> string Yes Your job ID (null for external messages) <code>aktenzeichen</code> string Yes Legal case number (null if not hydrated) <code>direction</code> enum No <code>INCOMING</code> or <code>OUTGOING</code> <code>createdAt</code> datetime No When message arrived at EGVP server <code>receivedAt</code> datetime Yes When first retrieved (null if not yet retrieved) <code>hydratedAt</code> datetime Yes When processed by system (null if not hydrated) <code>url</code> string (uri) No Relative URL for download endpoint"},{"location":"Products/DUBA/api-tutorial/#example-response","title":"Example Response","text":"<pre><code>[\n  {\n    \"id\": 214,\n    \"messageId\": \"gov2test_17623381049230a53d2f5-5015-4d9b-9afb-e86b1d0b6872\",\n    \"jobId\": \"job-2024-001\",\n    \"aktenzeichen\": \"AZ-12345-2024\",\n    \"direction\": \"INCOMING\",\n    \"createdAt\": \"2025-11-26T14:30:00Z\",\n    \"receivedAt\": \"2025-11-26T15:00:00Z\",\n    \"hydratedAt\": \"2025-11-26T15:01:00Z\",\n    \"url\": \"/api/duba/v1/download/214\"\n  },\n  {\n    \"id\": 215,\n    \"messageId\": \"msg-def-456\",\n    \"jobId\": null,\n    \"aktenzeichen\": \"AZ-67890-2024\",\n    \"direction\": \"INCOMING\",\n    \"createdAt\": \"2025-11-26T14:35:00Z\",\n    \"receivedAt\": \"2025-11-26T14:40:00Z\",\n    \"hydratedAt\": \"2025-11-26T14:41:00Z\",\n    \"url\": \"/api/duba/v1/download/215\"\n  }\n]\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#understanding-nullable-fields","title":"Understanding Nullable Fields","text":""},{"location":"Products/DUBA/api-tutorial/#jobid-null","title":"<code>jobId == null</code>","text":"<p>The message was not sent via your DUBA API integration. Possible reasons: - External court sent you an unsolicited message - Another system sharing your EGVP account sent the message - Message predates your API integration</p>"},{"location":"Products/DUBA/api-tutorial/#aktenzeichen-null","title":"<code>aktenzeichen == null</code>","text":"<p>The message is not yet hydrated (still processing). This means: - Metadata is available (indexed) - Full content not yet downloaded/parsed - Cannot be matched to jobs yet - Wait for <code>hydratedAt != null</code> before relying on aktenzeichen</p>"},{"location":"Products/DUBA/api-tutorial/#receivedat-null","title":"<code>receivedAt == null</code>","text":"<p>The message has not been retrieved yet: - For INCOMING messages: Neither you nor any other system has downloaded it yet - For OUTGOING messages: The recipient hasn't downloaded it yet</p>"},{"location":"Products/DUBA/api-tutorial/#download-message-endpoint","title":"Download Message Endpoint","text":"<p>Endpoint: <code>GET /api/duba/v1/download/{id}</code></p> <p>Purpose: Download a specific message as a ZIP file.</p>"},{"location":"Products/DUBA/api-tutorial/#path-parameters","title":"Path Parameters","text":"Parameter Type Required Description <code>id</code> integer Yes Message index ID from <code>MessageInfo.id</code>"},{"location":"Products/DUBA/api-tutorial/#response_1","title":"Response","text":"<p>Returns a ZIP file containing: - XJustiz XML message file - Any attachments included with the message - Metadata files</p> <p>Content-Type: <code>application/zip</code></p>"},{"location":"Products/DUBA/api-tutorial/#examples_1","title":"Examples","text":""},{"location":"Products/DUBA/api-tutorial/#download-single-message","title":"Download single message","text":"<pre><code>curl -u \"user:pass\" \\\n  https://elim.example.com/api/duba/v1/download/214 \\\n  -o message-214.zip\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#download-with-verbose-output","title":"Download with verbose output","text":"<pre><code>curl -v -u \"user:pass\" \\\n  https://elim.example.com/api/duba/v1/download/214 \\\n  -o message-214.zip\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#check-download-headers-without-downloading","title":"Check download headers without downloading","text":"<pre><code>curl -I -u \"user:pass\" \\\n  https://elim.example.com/api/duba/v1/download/214\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#acknowledge-messages-endpoint","title":"Acknowledge Messages Endpoint","text":"<p>Endpoint: <code>POST /api/duba/v1/messages/ack</code></p> <p>Purpose: Acknowledge receipt of one or more messages and trigger cleanup.</p>"},{"location":"Products/DUBA/api-tutorial/#what-this-does","title":"What This Does","text":"<p>When you acknowledge a message: 1. Deletes on-disk files - Sensitive message content is removed (data protection) 2. Soft-deletes index entry - Metadata is preserved for audit trail 3. Returns detailed status - Know exactly what happened to each message</p> <p>Use case: After successfully downloading and processing messages, acknowledge them to trigger cleanup and comply with data protection requirements.</p>"},{"location":"Products/DUBA/api-tutorial/#request-body","title":"Request Body","text":"<pre><code>{\n  \"messageIds\": [42, 43, 44]\n}\n</code></pre> Field Type Required Description <code>messageIds</code> integer[] Yes Array of message index IDs to acknowledge (1-100 items)"},{"location":"Products/DUBA/api-tutorial/#response_2","title":"Response","text":"<p>Returns status for each message ID:</p> <pre><code>{\n  \"results\": [\n    {\n      \"id\": 42,\n      \"status\": \"DELETED\",\n      \"message\": \"Message acknowledged and deleted\"\n    },\n    {\n      \"id\": 43,\n      \"status\": \"ALREADY_DELETED\",\n      \"message\": \"Message was already deleted\"\n    },\n    {\n      \"id\": 44,\n      \"status\": \"FORBIDDEN\",\n      \"message\": \"User does not have access to this message\"\n    }\n  ]\n}\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#status-values","title":"Status Values","text":"Status Meaning Is Error? <code>DELETED</code> Successfully acknowledged and cleaned up No <code>ALREADY_DELETED</code> Message was already deleted (idempotent) No <code>NOT_FOUND</code> Message index entry does not exist Yes <code>FORBIDDEN</code> User does not have access to this message Yes <code>ERROR</code> An error occurred during processing Yes <p>Important: Partial success is allowed. Some messages may succeed while others fail. Always check the status for each ID.</p>"},{"location":"Products/DUBA/api-tutorial/#examples_2","title":"Examples","text":""},{"location":"Products/DUBA/api-tutorial/#acknowledge-single-message","title":"Acknowledge single message","text":"<pre><code>curl -X POST \\\n  -u \"user:pass\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"messageIds\": [214]}' \\\n  https://elim.example.com/api/duba/v1/messages/ack\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#acknowledge-multiple-messages","title":"Acknowledge multiple messages","text":"<pre><code>curl -X POST \\\n  -u \"user:pass\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"messageIds\": [214, 215, 216]}' \\\n  https://elim.example.com/api/duba/v1/messages/ack\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#parse-response-with-jq","title":"Parse response with jq","text":"<pre><code>curl -X POST \\\n  -u \"user:pass\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"messageIds\": [214, 215, 216]}' \\\n  https://elim.example.com/api/duba/v1/messages/ack | jq .\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#count-successful-deletions","title":"Count successful deletions","text":"<pre><code>curl -X POST \\\n  -u \"user:pass\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"messageIds\": [214, 215, 216]}' \\\n  https://elim.example.com/api/duba/v1/messages/ack | \\\n  jq '[.results[] | select(.status == \"DELETED\")] | length'\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#download-and-acknowledge-workflow","title":"Download and acknowledge workflow","text":"<pre><code>#!/bin/bash\n# List messages, download each, then acknowledge all at once\nMESSAGE_IDS=$(curl -u \"user:pass\" \\\n  \"https://elim.example.com/api/duba/v1/messages?jobId=job-123\" | \\\n  jq -r '.[].id')\n\n# Download each message\nfor id in $MESSAGE_IDS; do\n  echo \"Downloading message $id...\"\n  curl -u \"user:pass\" \\\n    \"https://elim.example.com/api/duba/v1/download/$id\" \\\n    -o \"message-$id.zip\"\ndone\n\n# Acknowledge all messages at once (bulk operation)\ncurl -X POST \\\n  -u \"user:pass\" \\\n  -H \"Content-Type: application/json\" \\\n  -d \"{\\\"messageIds\\\": [$(echo $MESSAGE_IDS | tr '\\n' ',' | sed 's/,$//' )]}\" \\\n  https://elim.example.com/api/duba/v1/messages/ack\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#data-protection-notes","title":"Data Protection Notes","text":"<p>Acknowledging messages is one of three cleanup triggers in the system:</p> <ol> <li>ACK endpoint (this) - Client-driven, explicit confirmation</li> <li>Sync-based cleanup - Automatic when message confirmed gone from server</li> <li>Retention policy - Time-based backstop (e.g., 30 days)</li> </ol> <p>Best practice: Acknowledge messages as soon as you've successfully downloaded and processed them. This ensures: - Sensitive data is deleted promptly (GDPR compliance) - Your message list stays clean - Audit trail is preserved for compliance</p> <p>Idempotent operation: Safe to acknowledge the same message multiple times. Already-deleted messages return <code>ALREADY_DELETED</code> status (not an error).</p>"},{"location":"Products/DUBA/api-tutorial/#form-pre-fill-with-memento-endpoint","title":"Form Pre-fill with Memento Endpoint","text":"<p>Endpoint: <code>POST /api/duba/v1/memento</code></p> <p>Purpose: Create encrypted memento strings to pre-fill DUBA web forms with data from your system.</p>"},{"location":"Products/DUBA/api-tutorial/#what-this-does_1","title":"What This Does","text":"<p>The memento endpoint solves a common integration pattern:</p> <ol> <li>Your system (e.g., KIS) has complete case data but wants users to review/approve before submission</li> <li>You call this endpoint with the form data as JSON</li> <li>You receive back an encrypted memento string and a ready-to-use <code>magicLink</code> URL</li> <li>You send the <code>magicLink</code> to the end user (email, portal link, etc.)</li> <li>Users click the link \u2192 authenticate automatically \u2192 see the pre-filled form</li> </ol> <p>Benefits: - No direct submission required \u2014 users maintain control - Form validation happens in the browser (immediate feedback) - Users can correct or supplement data before sending - Encrypted mementos are tamper-proof - <code>magicLink</code> handles authentication automatically \u2014 no credentials in the URL</p>"},{"location":"Products/DUBA/api-tutorial/#use-case-example","title":"Use Case Example","text":"<pre><code>Hospital KIS \u2192 Knows patient details for court guardianship request\n           \u2192 Calls /memento with patient/case data as JSON\n           \u2192 Receives { \"memento\": \"...\", \"magicLink\": \"/mtl/.../duba/form?m=...\" }\n           \u2192 Prepends host: https://elim.example.com + magicLink\n           \u2192 Emails absolute URL to authorized user\nUser       \u2192 Clicks link (no login required)\n           \u2192 Automatically authenticated\n           \u2192 Sees pre-filled form with all case details\n           \u2192 Reviews, corrects if needed, submits to court\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#request-body_1","title":"Request Body","text":"<p>The endpoint accepts DUBA form data as JSON. All fields except <code>jobId</code> are optional.</p> <p>Required Fields: - <code>jobId</code> - Your internal tracking ID (string) - <code>absender.egvp_account_id</code> - EGVP/beBPo account ID for submission (integer)</p> <p>Common Structure:</p> <pre><code>{\n  \"jobId\": \"job-2024-12345\",\n  \"meldeZeitpunkt\": \"2025-12-10T14:30:00+01:00\",\n  \"absender\": {\n    \"name\": \"Klinikum Musterstadt\",\n    \"aktenzeichen\": \"KH-2024-001\",\n    \"egvp_account_id\": 42\n  },\n  \"empfaenger\": {\n    \"name\": \"Amtsgericht Musterstadt\",\n    \"type\": \"Gericht\",\n    \"safeId\": \"gov2test\",\n    \"aktenzeichen\": \"AZ-2024-67890\",\n    \"adresse\": {\n      \"strasse\": \"Gerichtsplatz 1\",\n      \"plz\": \"12345\",\n      \"stadt\": \"Musterstadt\"\n    }\n  },\n  \"betroffener\": {\n    \"name\": {\n      \"vorname\": \"Max\",\n      \"nachname\": \"Mustermann\"\n    },\n    \"geburtsdatum\": \"1950-01-15\",\n    \"familienstand\": \"Verheiratet\",\n    \"anschrift\": {\n      \"strasse\": \"Musterstra\u00dfe 42\",\n      \"plz\": \"12345\",\n      \"stadt\": \"Musterstadt\"\n    },\n    \"anschriftTelefon\": \"+49 123 456789\",\n    \"gegenwaertigerAufenthalt\": \"Klinik XY, Station 3, Zimmer 12\"\n  }\n}\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#field-reference_1","title":"Field Reference","text":"Field Type Required Description <code>jobId</code> string Yes Your internal job/case tracking ID <code>meldeZeitpunkt</code> datetime (ISO 8601) No Timestamp of report/registration <code>absender.name</code> string No Sender organization name <code>absender.aktenzeichen</code> string No Your internal case reference <code>absender.egvp_account_id</code> integer Yes* EGVP beBPo account ID for submission <code>empfaenger.name</code> string No Recipient organization name <code>empfaenger.type</code> enum No <code>Gericht</code> or <code>Sonstige</code> <code>empfaenger.safeId</code> string No EGVP Safe-ID for recipient <code>empfaenger.aktenzeichen</code> string No Court case reference number <code>empfaenger.adresse.*</code> object No Recipient address (strasse, plz, stadt) <code>betroffener.name.*</code> object No Affected person's name (vorname, nachname) <code>betroffener.geburtsdatum</code> date (YYYY-MM-DD) No Date of birth <code>betroffener.familienstand</code> enum No <code>Ledig</code>, <code>Verheiratet</code>, <code>Geschieden</code>, <code>Verwitwet</code> <code>betroffener.anschrift.*</code> object No Home address <code>betroffener.anschriftTelefon</code> string No Home phone number <code>betroffener.gegenwaertigerAufenthalt</code> string No Current location (e.g., hospital, ward, room) <p>* Required for actual form submission, but optional for memento creation</p>"},{"location":"Products/DUBA/api-tutorial/#response_3","title":"Response","text":"<p>Returns a JSON object containing the encrypted memento string and a ready-to-use magic link:</p> <pre><code>{\n  \"memento\": \"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..DGG5lQvJC8OpYrCt.Xm8YR...\",\n  \"magicLink\": \"/mtl/eyJ...token.../duba/?m=eyJ...memento...\"\n}\n</code></pre> Field Type Nullable Description <code>memento</code> string No Encrypted, URL-safe string containing your form data <code>magicLink</code> string Yes Relative URL that authenticates and opens the pre-filled form in one click. Prepend your host: <code>https://your-instance + magicLink</code> <p>Note: Memento strings are typically 500-2000 characters depending on data size. They are encrypted with AES-256-GCM and safe to pass via URL parameters. The <code>magicLink</code> token expires after 1 hour by default.</p>"},{"location":"Products/DUBA/api-tutorial/#examples_3","title":"Examples","text":""},{"location":"Products/DUBA/api-tutorial/#minimal-example-jobid-only","title":"Minimal example (jobId only)","text":"<pre><code>curl -X POST \\\n  -u \"user:pass\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"jobId\":\"job-2024-001\",\"absender\":{\"egvp_account_id\":42}}' \\\n  https://elim.example.com/api/duba/v1/memento\n</code></pre> <p>Response:</p> <pre><code>{\n  \"memento\": \"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..abc123...\",\n  \"magicLink\": \"/mtl/eyJ...token.../duba/?m=eyJ...memento...\"\n}\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#complete-guardianship-request-example","title":"Complete guardianship request example","text":"<pre><code>curl -X POST \\\n  -u \"user:pass\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"jobId\": \"job-2024-12345\",\n    \"meldeZeitpunkt\": \"2025-12-10T14:30:00+01:00\",\n    \"absender\": {\n      \"name\": \"Klinikum Musterstadt\",\n      \"aktenzeichen\": \"KH-2024-001\",\n      \"egvp_account_id\": 42\n    },\n    \"empfaenger\": {\n      \"name\": \"Amtsgericht Musterstadt\",\n      \"type\": \"Gericht\",\n      \"safeId\": \"gov2test\",\n      \"aktenzeichen\": \"AZ-2024-67890\"\n    },\n    \"betroffener\": {\n      \"name\": {\n        \"vorname\": \"Max\",\n        \"nachname\": \"Mustermann\"\n      },\n      \"geburtsdatum\": \"1950-01-15\",\n      \"familienstand\": \"Verheiratet\",\n      \"anschrift\": {\n        \"strasse\": \"Musterstra\u00dfe 42\",\n        \"plz\": \"12345\",\n        \"stadt\": \"Musterstadt\"\n      },\n      \"anschriftTelefon\": \"+49 123 456789\",\n      \"gegenwaertigerAufenthalt\": \"Klinik XY, Station 3, Zimmer 12\"\n    }\n  }' \\\n  https://elim.example.com/api/duba/v1/memento\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#extract-memento-and-magic-link-with-jq","title":"Extract memento and magic link with jq","text":"<pre><code>RESPONSE=$(curl -s -X POST \\\n  -u \"user:pass\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"jobId\":\"job-123\",\"absender\":{\"egvp_account_id\":42}}' \\\n  https://elim.example.com/api/duba/v1/memento)\n\nMEMENTO=$(echo \"$RESPONSE\" | jq -r '.memento')\nMAGIC_LINK=$(echo \"$RESPONSE\" | jq -r '.magicLink')\n\necho \"Memento: $MEMENTO\"\necho \"Magic link (relative): $MAGIC_LINK\"\necho \"Full URL: https://elim.example.com$MAGIC_LINK\"\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#using-the-magic-link-recommended","title":"Using the Magic Link (Recommended)","text":"<p>The API response includes a <code>magicLink</code> field \u2014 a relative URL that handles both authentication and form pre-fill in a single click. This is the recommended approach for giving end users access to pre-filled forms.</p> <p>The <code>magicLink</code> is a relative path. Prepend your instance host to make it absolute:</p> <pre><code>RESPONSE=$(curl -s -X POST -u \"user:pass\" \\\n  -H \"Content-Type: application/json\" \\\n  -d \"$FORM_DATA\" \\\n  \"https://elim.example.com/api/duba/v1/memento\")\n\nMAGIC_LINK=$(echo \"$RESPONSE\" | jq -r '.magicLink')\nFULL_URL=\"https://elim.example.com$MAGIC_LINK\"\n\n# Send FULL_URL to the end user\necho \"$FULL_URL\"\n</code></pre> <p>When the end user opens this URL: 1. The server decrypts the embedded token 2. The user is authenticated automatically (no login page) 3. They land directly on the pre-filled form</p> <p>Token expiry: Magic links expire after 1 hour by default. Generate a fresh link close to the time you send it to the user.</p>"},{"location":"Products/DUBA/api-tutorial/#alternative-manual-form-url","title":"Alternative: Manual Form URL","text":"<p>If the end user already has an active ELIM session (e.g., they are already logged in), you can construct a bare form URL using the <code>memento</code> field:</p> <p>URL Pattern:</p> <pre><code>https://your-instance/duba/{FormName}?m={memento}\n</code></pre> <p>Available Form Types:</p> Form Name Purpose <code>BetreuungAnregung</code> Guardianship suggestion/request <code>UnterbringungAntrag</code> Involuntary commitment application <code>FreiheitsentzugAntrag</code> Deprivation of liberty application <p>Example:</p> <pre><code>MEMENTO=$(echo \"$RESPONSE\" | jq -r '.memento')\nFORM_URL=\"https://elim.example.com/duba/BetreuungAnregung?m=$MEMENTO\"\n# Use this only if the user already has an active session\n</code></pre> <p>Note: Bare form URLs require the user to be logged in. If the user is not authenticated, the server will redirect to <code>/login</code>. Use the <code>magicLink</code> approach if you cannot guarantee the user has an active session.</p>"},{"location":"Products/DUBA/api-tutorial/#complete-end-to-end-example","title":"Complete End-to-End Example","text":"<pre><code>#!/bin/bash\n# Complete workflow: Create memento and send magic link to end user\n\nBASE_URL=\"https://elim.example.com\"\nUSER=\"your-username\"\nPASS=\"your-password\"\n\n# Step 1: Prepare form data\nFORM_DATA='{\n  \"jobId\": \"job-2026-12345\",\n  \"meldeZeitpunkt\": \"2026-02-19T14:30:00+01:00\",\n  \"absender\": {\n    \"aktenzeichen\": \"KH-2024-001\",\n    \"egvp_account_id\": 42\n  },\n  \"empfaenger\": {\n    \"name\": \"Amtsgericht Musterstadt\",\n    \"type\": \"Gericht\",\n    \"safeId\": \"de.justiz.bund.egvp.bea.12345\"\n  },\n  \"betroffener\": {\n    \"name\": {\"vorname\": \"Max\", \"nachname\": \"Mustermann\"},\n    \"geburtsdatum\": \"1950-01-15\",\n    \"anschrift\": {\n      \"strasse\": \"Musterstra\u00dfe 42\",\n      \"plz\": \"12345\",\n      \"stadt\": \"Musterstadt\"\n    }\n  }\n}'\n\n# Step 2: Call memento API\necho \"Creating memento...\"\nRESPONSE=$(curl -s -X POST \\\n  -u \"$USER:$PASS\" \\\n  -H \"Content-Type: application/json\" \\\n  -d \"$FORM_DATA\" \\\n  \"$BASE_URL/api/duba/v1/memento\")\n\n# Step 3: Extract magic link from response\nMAGIC_LINK=$(echo \"$RESPONSE\" | jq -r '.magicLink')\n\nif [ -z \"$MAGIC_LINK\" ] || [ \"$MAGIC_LINK\" = \"null\" ]; then\n  echo \"Error: Failed to create memento\"\n  echo \"$RESPONSE\" | jq .\n  exit 1\nfi\n\n# Step 4: Construct absolute URL (magicLink is relative)\nFULL_URL=\"$BASE_URL$MAGIC_LINK\"\n\necho \"Success! Send this URL to the authorized user:\"\necho \"$FULL_URL\"\necho \"\"\necho \"The link authenticates automatically and opens the pre-filled form.\"\necho \"Note: This link expires in 1 hour.\"\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#integration-patterns","title":"Integration Patterns","text":""},{"location":"Products/DUBA/api-tutorial/#pattern-1-email-with-magic-link-recommended","title":"Pattern 1: Email with magic link (Recommended)","text":"<pre><code># Create memento and email the magic link to user\nRESPONSE=$(curl -s -X POST -u \"$USER:$PASS\" \\\n  -H \"Content-Type: application/json\" \\\n  -d \"$FORM_DATA\" \\\n  \"$BASE_URL/api/duba/v1/memento\")\n\nMAGIC_LINK=$(echo \"$RESPONSE\" | jq -r '.magicLink')\nFULL_URL=\"$BASE_URL$MAGIC_LINK\"\n\n# Email the magic link (example using mail command)\nmail -s \"Court Form Ready for Review\" user@hospital.example.com &lt;&lt;EOF\nPlease review and submit the guardianship form:\n$FULL_URL\n\nClick the link to open the pre-filled form directly. No login required.\nNote: This link expires in 1 hour.\nEOF\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#pattern-2-generate-qr-code-for-mobile-access","title":"Pattern 2: Generate QR code for mobile access","text":"<pre><code># Create memento and generate QR code from magic link\nMAGIC_LINK=$(curl -s -X POST -u \"$USER:$PASS\" \\\n  -H \"Content-Type: application/json\" \\\n  -d \"$FORM_DATA\" \\\n  \"$BASE_URL/api/duba/v1/memento\" | jq -r '.magicLink')\n\nFULL_URL=\"$BASE_URL$MAGIC_LINK\"\n\n# Generate QR code (requires qrencode tool)\necho \"$FULL_URL\" | qrencode -o form-qr.png\necho \"QR code saved to form-qr.png\"\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#pattern-3-batch-form-generation","title":"Pattern 3: Batch form generation","text":"<pre><code># Generate magic links for multiple cases from CSV\nwhile IFS=, read -r case_id patient_name dob; do\n  FORM_DATA=$(jq -n \\\n    --arg jobId \"$case_id\" \\\n    --arg vorname \"$(echo $patient_name | cut -d' ' -f1)\" \\\n    --arg nachname \"$(echo $patient_name | cut -d' ' -f2)\" \\\n    --arg dob \"$dob\" \\\n    '{\n      jobId: $jobId,\n      absender: {egvp_account_id: 42},\n      betroffener: {\n        name: {vorname: $vorname, nachname: $nachname},\n        geburtsdatum: $dob\n      }\n    }')\n\n  MAGIC_LINK=$(curl -s -X POST -u \"$USER:$PASS\" \\\n    -H \"Content-Type: application/json\" \\\n    -d \"$FORM_DATA\" \\\n    \"$BASE_URL/api/duba/v1/memento\" | jq -r '.magicLink')\n\n  echo \"$case_id,$BASE_URL$MAGIC_LINK\"\ndone &lt; cases.csv &gt; form_links.csv\n\necho \"Generated form links saved to form_links.csv\"\n# Note: links expire after 1 hour \u2014 generate close to the time of sending\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#error-handling","title":"Error Handling","text":""},{"location":"Products/DUBA/api-tutorial/#validation-errors","title":"Validation Errors","text":"<p>If the request data is invalid, you'll receive a 400 Bad Request with details:</p> <pre><code>curl -X POST -u \"user:pass\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"invalid\":\"data\"}' \\\n  https://elim.example.com/api/duba/v1/memento\n</code></pre> <p>Response:</p> <pre><code>{\n  \"error\": \"Validation failed\",\n  \"errors\": [\n    \"Field 'jobId' is required\"\n  ]\n}\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#handle-errors-in-scripts","title":"Handle Errors in Scripts","text":"<pre><code>RESPONSE=$(curl -s -X POST -u \"$USER:$PASS\" \\\n  -H \"Content-Type: application/json\" \\\n  -d \"$FORM_DATA\" \\\n  \"$BASE_URL/api/duba/v1/memento\")\n\n# Check for error field\nif echo \"$RESPONSE\" | jq -e '.error' &gt; /dev/null; then\n  echo \"Error creating memento:\"\n  echo \"$RESPONSE\" | jq -r '.error'\n  if echo \"$RESPONSE\" | jq -e '.errors' &gt; /dev/null; then\n    echo \"Details:\"\n    echo \"$RESPONSE\" | jq -r '.errors[]'\n  fi\n  exit 1\nfi\n\n# Extract memento\nMEMENTO=$(echo \"$RESPONSE\" | jq -r '.memento')\necho \"Success: $MEMENTO\"\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#security-notes","title":"Security Notes","text":"<p>Memento Encryption: - Mementos are encrypted with AES-256-GCM using your API user's KEK (Key Encryption Key) - Each memento is unique even for identical data (includes random IV) - Mementos cannot be decrypted without the correct API user credentials - Tampering is detected and rejected</p> <p>Best Practices: - \u2713 Mementos are safe to pass via URL parameters - \u2713 Mementos can be safely logged or stored - \u2713 Mementos expire after a reasonable time (check instance configuration) - \u2717 Don't expose mementos to unauthorized users (they contain sensitive patient data) - \u2717 Don't reuse mementos across different forms or cases</p> <p>Data Minimization: - Only include data that's actually needed for the form - Empty/null fields don't bloat the memento (they're omitted) - Minimal mementos result in shorter, more manageable URLs</p>"},{"location":"Products/DUBA/api-tutorial/#complete-workflow-examples","title":"Complete Workflow Examples","text":""},{"location":"Products/DUBA/api-tutorial/#workflow-1-poll-for-new-messages-and-download-them","title":"Workflow 1: Poll for new messages and download them","text":"<pre><code>#!/bin/bash\n# Configuration\nBASE_URL=\"https://elim.example.com\"\nUSER=\"your-username\"\nPASS=\"your-password\"\nSINCE=\"2025-11-25T10:00:00Z\"\n\n# Fetch messages since last check\necho \"Fetching messages since $SINCE...\"\nMESSAGES=$(curl -s -u \"$USER:$PASS\" \\\n  \"$BASE_URL/api/duba/v1/messages?since=$SINCE\")\n\n# Check if we got any messages\nCOUNT=$(echo \"$MESSAGES\" | jq '. | length')\necho \"Found $COUNT messages\"\n\n# Download each message\necho \"$MESSAGES\" | jq -r '.[].id' | while read ID; do\n  echo \"Downloading message $ID...\"\n  curl -s -u \"$USER:$PASS\" \\\n    \"$BASE_URL/api/duba/v1/download/$ID\" \\\n    -o \"message-$ID.zip\"\n\n  if [ $? -eq 0 ]; then\n    echo \"  \u2713 Downloaded message-$ID.zip\"\n  else\n    echo \"  \u2717 Failed to download message $ID\"\n  fi\ndone\n\necho \"Done!\"\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#workflow-2-download-all-messages-for-a-specific-job","title":"Workflow 2: Download all messages for a specific job","text":"<pre><code>#!/bin/bash\n# Configuration\nBASE_URL=\"https://elim.example.com\"\nUSER=\"your-username\"\nPASS=\"your-password\"\nJOB_ID=\"job-2024-001\"\n\n# Create output directory\nmkdir -p \"downloads/$JOB_ID\"\n\n# List messages for job\necho \"Fetching messages for job $JOB_ID...\"\nMESSAGES=$(curl -s -u \"$USER:$PASS\" \\\n  \"$BASE_URL/api/duba/v1/messages?jobId=$JOB_ID\")\n\n# Download each\necho \"$MESSAGES\" | jq -r '.[].id' | while read ID; do\n  echo \"Downloading message $ID...\"\n  curl -s -u \"$USER:$PASS\" \\\n    \"$BASE_URL/api/duba/v1/download/$ID\" \\\n    -o \"downloads/$JOB_ID/message-$ID.zip\"\ndone\n\necho \"All messages for $JOB_ID downloaded to downloads/$JOB_ID/\"\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#workflow-3-check-for-incoming-court-responses","title":"Workflow 3: Check for INCOMING court responses","text":"<pre><code>#!/bin/bash\n# Configuration\nBASE_URL=\"https://elim.example.com\"\nUSER=\"your-username\"\nPASS=\"your-password\"\n\n# Fetch all messages\necho \"Checking for incoming court responses...\"\nMESSAGES=$(curl -s -u \"$USER:$PASS\" \\\n  \"$BASE_URL/api/duba/v1/messages\")\n\n# Filter INCOMING messages and download\necho \"$MESSAGES\" | jq -r '.[] | select(.direction == \"INCOMING\") | .id' | while read ID; do\n  # Get message details\n  MSG=$(echo \"$MESSAGES\" | jq -r \".[] | select(.id == $ID)\")\n  AKTENZEICHEN=$(echo \"$MSG\" | jq -r '.aktenzeichen // \"unknown\"')\n\n  echo \"Downloading incoming message $ID (AZ: $AKTENZEICHEN)...\"\n  curl -s -u \"$USER:$PASS\" \\\n    \"$BASE_URL/api/duba/v1/download/$ID\" \\\n    -o \"incoming-$AKTENZEICHEN-$ID.zip\"\ndone\n\necho \"Done!\"\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#workflow-4-incremental-polling-with-state-tracking","title":"Workflow 4: Incremental polling with state tracking","text":"<pre><code>#!/bin/bash\n# Configuration\nBASE_URL=\"https://elim.example.com\"\nUSER=\"your-username\"\nPASS=\"your-password\"\nSTATE_FILE=\".last_poll_timestamp\"\n\n# Read last poll timestamp (or use default)\nif [ -f \"$STATE_FILE\" ]; then\n  SINCE=$(cat \"$STATE_FILE\")\n  echo \"Polling since last check: $SINCE\"\nelse\n  SINCE=\"2025-11-01T00:00:00Z\"\n  echo \"First poll, using: $SINCE\"\nfi\n\n# Fetch new messages\nMESSAGES=$(curl -s -u \"$USER:$PASS\" \\\n  \"$BASE_URL/api/duba/v1/messages?since=$SINCE\")\n\n# Process messages\necho \"$MESSAGES\" | jq -r '.[].id' | while read ID; do\n  echo \"Processing message $ID...\"\n  curl -s -u \"$USER:$PASS\" \\\n    \"$BASE_URL/api/duba/v1/download/$ID\" \\\n    -o \"message-$ID.zip\"\ndone\n\n# Update timestamp for next poll\ndate -u +\"%Y-%m-%dT%H:%M:%SZ\" &gt; \"$STATE_FILE\"\necho \"Updated last poll timestamp\"\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#filtering-best-practices","title":"Filtering Best Practices","text":""},{"location":"Products/DUBA/api-tutorial/#use-jobid-filtering-for-targeted-queries","title":"Use jobId filtering for targeted queries","text":"<p>When you know which cases you're interested in, filter by jobId to reduce response size and processing:</p> <pre><code>curl -u \"$USER:$PASS\" \\\n  \"$BASE_URL/api/duba/v1/messages?jobId=job-123&amp;jobId=job-456\"\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#use-since-parameter-for-incremental-polling","title":"Use since parameter for incremental polling","text":"<p>Avoid re-fetching all messages by using the <code>since</code> parameter:</p> <pre><code># First poll: get everything\ncurl -u \"$USER:$PASS\" \"$BASE_URL/api/duba/v1/messages\"\n\n# Subsequent polls: only new messages\nLAST_POLL=\"2025-11-26T10:00:00Z\"\ncurl -u \"$USER:$PASS\" \"$BASE_URL/api/duba/v1/messages?since=$LAST_POLL\"\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#combine-filters-for-precise-queries","title":"Combine filters for precise queries","text":"<p>Combine multiple filters to narrow results:</p> <pre><code># Only messages for specific jobs in a specific Safe-ID since yesterday\ncurl -u \"$USER:$PASS\" \\\n  \"$BASE_URL/api/duba/v1/messages?jobId=job-123&amp;safeId=safe-abc&amp;since=2025-11-26T00:00:00Z\"\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#handle-nullable-fields-gracefully","title":"Handle nullable fields gracefully","text":"<p>Always check for <code>null</code> values before using fields:</p> <pre><code># Using jq to safely handle nulls\ncurl -s -u \"$USER:$PASS\" \"$BASE_URL/api/duba/v1/messages\" | \\\n  jq -r '.[] | \"\\(.id): jobId=\\(.jobId // \"none\"), aktenzeichen=\\(.aktenzeichen // \"not-hydrated\")\"'\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#filter-by-direction-in-client-code","title":"Filter by direction in client code","text":"<p>Since the API doesn't have a <code>direction</code> parameter, filter client-side:</p> <pre><code># Get only INCOMING messages\ncurl -s -u \"$USER:$PASS\" \"$BASE_URL/api/duba/v1/messages\" | \\\n  jq '.[] | select(.direction == \"INCOMING\")'\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#error-codes","title":"Error Codes","text":"<p>The API uses standard HTTP status codes:</p> Code Status Meaning 200 OK Request successful 400 Bad Request Invalid parameters (e.g., malformed timestamp) 401 Unauthorized Missing or invalid credentials 403 Forbidden No access to this message or account 404 Not Found Message does not exist 500 Internal Server Error Server error (contact support)"},{"location":"Products/DUBA/api-tutorial/#example-error-response","title":"Example Error Response","text":"<pre><code># Invalid timestamp format\ncurl -u \"$USER:$PASS\" \\\n  \"$BASE_URL/api/duba/v1/messages?since=invalid-date\"\n\n# Response: 400 Bad Request\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#handling-errors-in-scripts","title":"Handling Errors in Scripts","text":"<pre><code># Check HTTP status code\nHTTP_CODE=$(curl -s -o response.json -w \"%{http_code}\" -u \"$USER:$PASS\" \\\n  \"$BASE_URL/api/duba/v1/messages\")\n\nif [ \"$HTTP_CODE\" -eq 200 ]; then\n  echo \"Success!\"\n  cat response.json | jq .\nelif [ \"$HTTP_CODE\" -eq 401 ]; then\n  echo \"Authentication failed - check credentials\"\nelif [ \"$HTTP_CODE\" -eq 403 ]; then\n  echo \"Access denied - check permissions\"\nelse\n  echo \"Error: HTTP $HTTP_CODE\"\nfi\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#reference","title":"Reference","text":""},{"location":"Products/DUBA/api-tutorial/#api-endpoints-summary","title":"API Endpoints Summary","text":"Method Endpoint Description GET <code>/api/duba/v1/messages</code> List available messages GET <code>/api/duba/v1/download/{id}</code> Download message as ZIP POST <code>/api/duba/v1/messages/ack</code> Acknowledge messages (trigger cleanup) POST <code>/api/duba/v1/memento</code> Create encrypted memento for form pre-fill"},{"location":"Products/DUBA/api-tutorial/#openapi-specification_1","title":"OpenAPI Specification","text":"<p>Interactive API documentation (Swagger UI):</p> <pre><code>https://your-instance/api/docs/swagger-ui/index.html?urls.primaryName=DUBA\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#timestamp-format","title":"Timestamp Format","text":"<p>All timestamps use ISO 8601 format with UTC timezone:</p> <pre><code>YYYY-MM-DDTHH:MM:SSZ\nExample: 2025-11-26T15:34:10Z\n</code></pre>"},{"location":"Products/DUBA/api-tutorial/#related-documentation","title":"Related Documentation","text":"<ul> <li>Magic Token Link (MTL) \u2014 How <code>/mtl/</code> authentication tokens work</li> <li>Basic Auth Login (BAL) \u2014 Deprecated since v0.2.1. Replaced by Magic Token Link.</li> </ul>"},{"location":"Products/DUBA/api-tutorial/#support","title":"Support","text":"<p>For technical support or questions about the DUBA API: - Contact your system administrator - Refer to the OpenAPI specification for detailed schema documentation</p> <p>Document Version: 0.2.1 Last Updated: 2026-02-19 API Version: v1</p>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/","title":"Produkt\u00fcbersicht","text":""},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#elim-elektronische-infektionsmeldung","title":"ELIM - Elektronische Infektionsmeldung","text":"<p>Automatisiert. Sicher. Gesetzeskonform.</p> <p>Powered by VERTAMA</p>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#produktubersicht","title":"Produkt\u00fcbersicht","text":"<p>ELIM digitalisiert den Meldeprozess f\u00fcr meldepflichtige Infektionskrankheiten \u2013 direkt aus dem KIS, in Echtzeit und vollst\u00e4ndig gesetzeskonform. Die cloudbasierte L\u00f6sung ist auf die Umsetzung der gesetzlichen Anforderungen gem\u00e4\u00df \u00a7 6, 8, 9 IfSG ausgerichtet.</p>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#warum-elim","title":"Warum ELIM?","text":""},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#automatisiert-integriert","title":"Automatisiert &amp; integriert","text":"<p>ELIM \u00fcbernimmt den gesamten Meldeprozess \u2013 inklusive Formular, Versand, Empfangsquittung und Archivierung.</p>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#rechtssicher","title":"Rechtssicher","text":"<p>Unterst\u00fctzt s\u00e4mtliche gesetzlichen Anforderungen \u2013 inkl. Sonderregelungen</p>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#alle-meldewege","title":"Alle Meldewege","text":"<p>DEMIS (FHIR) f\u00fcr digitale Arztmeldungen, Fax f\u00fcr gesetzlich vorgeschriebene Ausnahmef\u00e4lle.</p>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#datenschutz-garantiert","title":"Datenschutz garantiert","text":"<p>Keine Speicherung sensibler Daten, Memento-Verschl\u00fcsselung, zertifiziert durch SAP BTP.</p>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#flexibel-konfigurierbar","title":"Flexibel konfigurierbar","text":"<p>Feste Faxziele oder individuelle Gesundheitsamt-regeln sind problemlos abbildbar.</p>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#schnell-einsatzbereit","title":"Schnell einsatzbereit","text":"<p>1\u20132 Tage Implementierung \u2013 kein notwendiger Schulungsaufwand, intuitiv f\u00fcr Nutzer.</p>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#so-funktioniert-elim-im-klinikalltag","title":"So funktioniert ELIM im Klinikalltag","text":""},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#1-meldung-starten","title":"1. Meldung starten","text":"<p>\u00dcber einen Button direkt aus der Patientenakte im KIS</p>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#2-datenubernahme","title":"2. Daten\u00fcbernahme","text":"<p>Formular ist automatisch mit vorhandenen Patientendaten vorausgef\u00fcllt</p>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#3-erganzen-absenden","title":"3. Erg\u00e4nzen &amp; Absenden","text":"<p>Ein Klick gen\u00fcgt \u2013 ELIM erkennt den korrekten Meldeweg</p>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#4-empfang-archivierung","title":"4. Empfang &amp; Archivierung","text":"<p>Quittung wird automatisch revisionssicher in der Patientenakte abgelegt</p>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#datenschutz-kein-thema-elim-speichert-nichts","title":"Datenschutz? Kein Thema \u2013 ELIM speichert nichts.","text":"<ul> <li>Keine zentrale Datenspeicherung: Alle Daten werden nach erfolgreicher \u00dcbermittlung automatisch gel\u00f6scht</li> <li>Ende-zu-Ende verschl\u00fcsselt: Sicherer Transport und Zugriffskontrolle</li> <li>Revisionssicher &amp; DSGVO-konform: Vollst\u00e4ndige Protokollierung aller Vorg\u00e4nge</li> </ul>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#ihre-vorteile-auf-einen-blick","title":"Ihre Vorteile auf einen Blick","text":"<p>\u2713 44 vordefinierte Meldeformulare - direkt im KIS w\u00e4hlbar</p> <p>\u2713 DEMIS-Anbindung per FHIR - direkter, gesetzeskonformer Versand</p> <p>\u2713 Fax-Funktion integriert - f\u00fcr Arztmeldungen au\u00dferhalb DEMIS Kompatibilit\u00e4t</p> <p>\u2713 Revisionssichere Ablage - in Patientenakte &amp; Archivsystem</p> <p>\u2713 Kein zus\u00e4tzlicher Personalaufwand - wartungsarm, updatesicher, intuitiv</p>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#elim-automatisch-melden-sicher-dokumentieren","title":"ELIM \u2013 Automatisch melden. Sicher dokumentieren.","text":"<p>F\u00fcr ein Gesundheitssystem, das Infektionsschutz einfacher macht.</p>"},{"location":"Products/ELIM/onepager/ELIM%20%E2%80%93%20Marketing%20Produktbeschreibung/#kontakt","title":"Kontakt","text":"<p>Jetzt mehr erfahren: - Website: www.vertama.com - E-Mail: andre.sturm@vertama.com</p> <p>\u00a9 VERTAMA - ELIM Elektronische Infektionsmeldung</p>"},{"location":"Products/ELIM/onepager/OnePager%20%28HTML%29/","title":"One Pager / Flyer (HTML)","text":"ELIM VERTAMA Elektronische Infektionsmeldung Automatisiert. Sicher. Gesetzeskonform. ELIM digitalisiert den Meldeprozess f\u00fcr meldepflichtige Infektionskrankheiten \u2013 direkt aus dem KIS, in Echtzeit und vollst\u00e4ndig gesetzeskonform. Die cloudbasierte L\u00f6sung ist auf die Umsetzung der gesetzlichen Anforderungen gem\u00e4\u00df \u00a7 6, 8, 9 IfSG ausgerichtet.          Warum ELIM? <ul> <li>Automatisiert &amp; integriert: ELIM \u00fcbernimmt den gesamten Meldeprozess \u2013 inklusive Formular, Versand, Empfangsquittung und Archivierung.</li> <li>Rechtssicher: Unterst\u00fctzt s\u00e4mtliche gesetzlichen Anforderungen \u2013 inkl. Sonderregelungen</li> <li>Alle Meldewege: DEMIS (FHIR) f\u00fcr digitale Arztmeldungen, Fax f\u00fcr gesetzlich vorgeschriebene Ausnahmef\u00e4lle.</li> <li>Datenschutz garantiert: Keine Speicherung sensibler Daten, Memento-Verschl\u00fcsselung, zertifiziert durch SAP BTP.</li> <li>Flexibel konfigurierbar: Feste Faxziele oder individuelle Gesundheitsamt-regeln sind problemlos abbildbar.</li> <li>Schnell einsatzbereit: 1\u20132 Tage Implementierung \u2013 kein notwendiger Schulungsaufwand, intuitiv f\u00fcr Nutzer.</li> </ul> So funktioniert ELIM im Klinikalltag 1 Meldung starten <p>\u00dcber einen Button direkt aus der Patientenakte im KIS</p> 2 Daten\u00fcbernahme <p>Formular ist automatisch mit vorhandenen Patientendaten vorausgef\u00fcllt</p> 3 Erg\u00e4nzen &amp; Absenden <p>Ein Klick gen\u00fcgt \u2013 ELIM erkennt den korrekten Meldeweg</p> 4 Empfang &amp; Archivierung <p>Quittung wird automatisch revisionssicher in der Patientenakte abgelegt</p> Datenschutz? Kein Thema \u2013 ELIM speichert nichts. <ul> <li>Keine zentrale Datenspeicherung: Alle Daten werden nach erfolgreicher \u00dcbermittlung automatisch gel\u00f6scht</li> <li>Ende-zu-Ende verschl\u00fcsselt: Sicherer Transport und Zugriffskontrolle</li> <li>Revisionssicher &amp; DSGVO-konform: Vollst\u00e4ndige Protokollierung aller Vorg\u00e4nge</li> </ul> Ihre Vorteile auf einen Blick 44 vordefinierte Meldeformulare - direkt im KIS w\u00e4hlbar DEMIS-Anbindung per FHIR - direkter, gesetzeskonformer Versand Fax-Funktion integriert - f\u00fcr Arztmeldungen au\u00dferhalb DEMIS Kompatibilit\u00e4t Revisionssichere Ablage - in Patientenakte &amp; Archivsystem Kein zus\u00e4tzlicher Personalaufwand - wartungsarm, updatesicher, intuitiv ELIM \u2013 Automatisch melden. Sicher dokumentieren. <p>F\u00fcr ein Gesundheitssystem, das Infektionsschutz einfacher macht.</p> <p>Jetzt mehr erfahren: www.vertama.com |              andre.sturm@vertama.com</p>"},{"location":"Products/ELIM/onepager/OnePager%20%28PNG%29/","title":"One Pager / Flyer (PNG)","text":""},{"location":"Products/ELIM/onepager/OnePager/","title":"One Pager / Flyer (TEXT/Markdown)","text":""},{"location":"Products/ELIM/onepager/OnePager/#elim-elektronische-infektionsmeldung","title":"ELIM - Elektronische Infektionsmeldung","text":"<p>Automatisiert. Sicher. Gesetzeskonform.</p> <p>Powered by VERTAMA</p>"},{"location":"Products/ELIM/onepager/OnePager/#produktubersicht","title":"Produkt\u00fcbersicht","text":"<p>ELIM digitalisiert den Meldeprozess f\u00fcr meldepflichtige Infektionskrankheiten \u2013 direkt aus dem KIS, in Echtzeit und vollst\u00e4ndig gesetzeskonform. Die cloudbasierte L\u00f6sung ist auf die Umsetzung der gesetzlichen Anforderungen gem\u00e4\u00df \u00a7 6, 8, 9 IfSG ausgerichtet.</p>"},{"location":"Products/ELIM/onepager/OnePager/#warum-elim","title":"Warum ELIM?","text":""},{"location":"Products/ELIM/onepager/OnePager/#automatisiert-integriert","title":"Automatisiert &amp; integriert","text":"<p>ELIM \u00fcbernimmt den gesamten Meldeprozess \u2013 inklusive Formular, Versand, Empfangsquittung und Archivierung.</p>"},{"location":"Products/ELIM/onepager/OnePager/#rechtssicher","title":"Rechtssicher","text":"<p>Unterst\u00fctzt s\u00e4mtliche gesetzlichen Anforderungen \u2013 inkl. Sonderregelungen</p>"},{"location":"Products/ELIM/onepager/OnePager/#alle-meldewege","title":"Alle Meldewege","text":"<p>DEMIS (FHIR) f\u00fcr digitale Arztmeldungen, Fax f\u00fcr gesetzlich vorgeschriebene Ausnahmef\u00e4lle.</p>"},{"location":"Products/ELIM/onepager/OnePager/#datenschutz-garantiert","title":"Datenschutz garantiert","text":"<p>Keine Speicherung sensibler Daten, Memento-Verschl\u00fcsselung, zertifiziert durch SAP BTP.</p>"},{"location":"Products/ELIM/onepager/OnePager/#flexibel-konfigurierbar","title":"Flexibel konfigurierbar","text":"<p>Feste Faxziele oder individuelle Gesundheitsamt-regeln sind problemlos abbildbar.</p>"},{"location":"Products/ELIM/onepager/OnePager/#schnell-einsatzbereit","title":"Schnell einsatzbereit","text":"<p>1\u20132 Tage Implementierung \u2013 kein notwendiger Schulungsaufwand, intuitiv f\u00fcr Nutzer.</p>"},{"location":"Products/ELIM/onepager/OnePager/#so-funktioniert-elim-im-klinikalltag","title":"So funktioniert ELIM im Klinikalltag","text":""},{"location":"Products/ELIM/onepager/OnePager/#1-meldung-starten","title":"1. Meldung starten","text":"<p>\u00dcber einen Button direkt aus der Patientenakte im KIS</p>"},{"location":"Products/ELIM/onepager/OnePager/#2-datenubernahme","title":"2. Daten\u00fcbernahme","text":"<p>Formular ist automatisch mit vorhandenen Patientendaten vorausgef\u00fcllt</p>"},{"location":"Products/ELIM/onepager/OnePager/#3-erganzen-absenden","title":"3. Erg\u00e4nzen &amp; Absenden","text":"<p>Ein Klick gen\u00fcgt \u2013 ELIM erkennt den korrekten Meldeweg</p>"},{"location":"Products/ELIM/onepager/OnePager/#4-empfang-archivierung","title":"4. Empfang &amp; Archivierung","text":"<p>Quittung wird automatisch revisionssicher in der Patientenakte abgelegt</p>"},{"location":"Products/ELIM/onepager/OnePager/#datenschutz-kein-thema-elim-speichert-nichts","title":"Datenschutz? Kein Thema \u2013 ELIM speichert nichts.","text":"<ul> <li>Keine zentrale Datenspeicherung: Alle Daten werden nach erfolgreicher \u00dcbermittlung automatisch gel\u00f6scht</li> <li>Ende-zu-Ende verschl\u00fcsselt: Sicherer Transport und Zugriffskontrolle</li> <li>Revisionssicher &amp; DSGVO-konform: Vollst\u00e4ndige Protokollierung aller Vorg\u00e4nge</li> </ul>"},{"location":"Products/ELIM/onepager/OnePager/#ihre-vorteile-auf-einen-blick","title":"Ihre Vorteile auf einen Blick","text":"<p>\u2713 44 vordefinierte Meldeformulare - direkt im KIS w\u00e4hlbar</p> <p>\u2713 DEMIS-Anbindung per FHIR - direkter, gesetzeskonformer Versand</p> <p>\u2713 Fax-Funktion integriert - f\u00fcr Arztmeldungen au\u00dferhalb DEMIS Kompatibilit\u00e4t</p> <p>\u2713 Revisionssichere Ablage - in Patientenakte &amp; Archivsystem</p> <p>\u2713 Kein zus\u00e4tzlicher Personalaufwand - wartungsarm, updatesicher, intuitiv</p>"},{"location":"Products/ELIM/onepager/OnePager/#elim-automatisch-melden-sicher-dokumentieren","title":"ELIM \u2013 Automatisch melden. Sicher dokumentieren.","text":"<p>F\u00fcr ein Gesundheitssystem, das Infektionsschutz einfacher macht.</p>"},{"location":"Products/ELIM/onepager/OnePager/#kontakt","title":"Kontakt","text":"<p>Jetzt mehr erfahren: - Website: www.vertama.com - E-Mail: andre.sturm@vertama.com</p> <p>\u00a9 VERTAMA - ELIM Elektronische Infektionsmeldung</p>"},{"location":"Products/ELIMPLUS/api-tutorial/","title":"ELIM+ API Integration Guide","text":"<p>A practical guide for integration partners using the ELIM+ (Laboratory Reporting) API.</p> <p>Version: 0.1.2 Last Updated: 2026-02-20</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Introduction</li> <li>Authentication</li> <li>Core Concepts</li> <li>Memento Endpoint</li> <li>Report Retrieval Endpoints</li> <li>Complete Workflow Examples</li> <li>Error Handling</li> <li>Reference</li> </ol>"},{"location":"Products/ELIMPLUS/api-tutorial/#introduction","title":"Introduction","text":"<p>The ELIM+ API enables laboratory information systems (KIS) to pre-fill laboratory reporting forms for notifiable diseases in Germany (DEMIS integration). This API allows integration partners to:</p> <ul> <li>Create form mementos to generate pre-filled form URLs from laboratory data</li> <li>Retrieve report results after end users submit forms to DEMIS</li> <li>Support 4 disease types: Influenza, RSV, Norovirus, SARS-CoV-2</li> <li>Enable user review before submission to public health authorities</li> </ul>"},{"location":"Products/ELIMPLUS/api-tutorial/#use-case","title":"Use Case","text":"<p>ELIM+ solves a common integration pattern:</p> <ol> <li>Laboratory system (KIS) has complete test results but wants users to review before DEMIS submission</li> <li>System calls API with laboratory report data as JSON</li> <li>API returns an encrypted memento string and a ready-to-use <code>magicLink</code> URL</li> <li>System sends the <code>magicLink</code> to the end user (email, portal, etc.)</li> <li>User clicks the link \u2014 authenticated, lands on ELIM+ index with pre-filled data</li> <li>User selects disease form, reviews, and submits to DEMIS</li> </ol> <pre><code>KIS / Laboratory System\n    \u2193\n[1] POST /api/elimplus/v1/memento  (API user credentials)\n    \u2193\n[2] Receives { \"memento\": \"...\", \"magicLink\": \"/mtl/.../?m=...\" }\n    \u2193\n[3] Constructs absolute URL: https://your-instance + magicLink\n    \u2193\n[4] Delivers URL to end user (email, portal link, SMS, etc.)\n    \u2193\nEnd User\n    \u2193\n[5] Clicks link \u2192 authenticated via MTL token\n    \u2192 lands on /elimplus/?m={memento}\n    \u2193\n[6] Selects disease form \u2192 reviews pre-filled data \u2192 submits to DEMIS\n    \u2193\nKIS / Laboratory System (asynchronous)\n    \u2193\n[7] GET /api/elimplus/v1/reports  \u2192 list of pending reportIds\n[8] GET /api/elimplus/v1/reports/{reportId}  \u2192 full result + receipt PDF\n</code></pre> <p>Benefits: - No direct submission required \u2014 users maintain control - No separate end-user login credentials needed \u2014 <code>magicLink</code> handles authentication - Form validation happens in browser (immediate feedback) - Users can correct or supplement data before sending - Encrypted mementos are tamper-proof</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#prerequisites","title":"Prerequisites","text":"<p>Before using the API, you need: - API User Credentials: Username and password provided by your administrator - Base URL: Your ELIM instance URL (e.g., <code>https://elim.example.com</code>)</p> <p>That's it. End users do not need separate credentials \u2014 the <code>magicLink</code> in the API response handles their authentication automatically.</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#api-versioning","title":"API Versioning","text":"<p>All endpoints are versioned under <code>/api/elimplus/v1/</code>.</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#openapi-specification","title":"OpenAPI Specification","text":"<p>The complete OpenAPI specification is available at:</p> <pre><code>https://your-instance/api/docs/swagger-ui/index.html?urls.primaryName=ELIM+\n</code></pre>"},{"location":"Products/ELIMPLUS/api-tutorial/#authentication","title":"Authentication","text":"<p>The API uses HTTP Basic Authentication with your API user credentials (the service account provided by your administrator). End users do not need separate credentials.</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#how-it-works","title":"How It Works","text":"<ol> <li>Your administrator creates an API user account with username and password</li> <li>For each API request, provide credentials in the <code>Authorization</code> header</li> <li>The API returns a <code>magicLink</code> in the response \u2014 a server-issued token that grants end users one-time authenticated access to the pre-filled form</li> </ol>"},{"location":"Products/ELIMPLUS/api-tutorial/#example","title":"Example","text":"<pre><code>curl -u \"api-username:api-password\" \\\n  -X POST \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"reportId\":\"LAB-2026-001\"}' \\\n  https://elim.example.com/api/elimplus/v1/memento\n</code></pre> <p>The response contains both the encrypted memento and a ready-to-use <code>magicLink</code> \u2014 no further credentials are needed for the end user.</p> <p>See Magic Token Link (MTL) for details on how the server-issued token works.</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#core-concepts","title":"Core Concepts","text":""},{"location":"Products/ELIMPLUS/api-tutorial/#laboratory-report-labormeldung","title":"Laboratory Report (Labormeldung)","text":"<p>The main data structure for notifiable disease reporting. Contains: - reportId (required): Unique laboratory report identifier - Patient: Patient information (standard with full identification, or anonymous with limited data for privacy) - MeldendeEinrichtung: Reporting facility (laboratory) - MeldendePerson: Reporting person - EinsendendeEinrichtung: Sending facility (e.g., hospital that ordered the test) - Krankheit: Disease-specific data (Influenza, RSV, Norovirus, or SARS-CoV-2) - MeldungsDatum: Report date - MeldungsVerweisId: Reference ID for linking corrections or follow-up reports</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#memento-pattern","title":"Memento Pattern","text":"<p>A memento is an encrypted, URL-safe string that contains form pre-fill data: - Generated from JSON laboratory report data - Encrypted with AES-256-GCM using your API user's KEK - Tamper-proof and URL-safe - Typical size: 500\u20132000 characters - Used as query parameter: <code>?m={memento}</code></p> <p>Important: The memento contains generic pre-fill data (patient info, dates, report IDs) \u2014 not disease-specific data. The user selects the disease on the ELIM+ index page. The same memento applies to all disease forms.</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#magic-token-link-mtl","title":"Magic Token Link (MTL)","text":"<p>The <code>magicLink</code> field in the API response is a server-issued, time-limited URL that: - Authenticates the end user automatically (no login page) - Redirects to <code>/elimplus/?m={memento}</code> on success - Is a relative path \u2014 prepend your instance host to make it absolute</p> <pre><code>magicLink: \"/mtl/eyJ...token.../elimplus/?m=eyJ...memento...\"\n\nFull URL: https://elim.example.com/mtl/eyJ...token.../elimplus/?m=eyJ...memento...\"\n</code></pre> <p>See Magic Token Link (MTL) for security details and token lifetime.</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#patient-types","title":"Patient Types","text":"<p>ELIM+ supports two patient types for privacy protection:</p> <p>Standard Patient (<code>IsAnonym: false</code>): - Full identification with name, complete birthdate, full address, and contact information - Used for typical laboratory reporting where patient identity is available - Structure: <code>Patient.Standard</code> contains Name, Geschlecht, Geburtsdatum (YYYY-MM-DD), Adresse, Kontakt</p> <p>Anonymous Patient (<code>IsAnonym: true</code>): - Limited data to protect patient privacy - No name or contact information - Birth month/year only (not full date): <code>GeburtsmonatJahr</code> in YYYY-MM format - Limited address with only postal code and country (no street, city, or identifying details) - Structure: <code>Patient.Anonym</code> contains Geschlecht, GeburtsmonatJahr, Adresse (PLZ and Land only)</p> <p>When to use: - Use Standard for normal reporting when patient identity is available - Use Anonymous when patient wishes to remain anonymous or local regulations require privacy protection</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#disease-types","title":"Disease Types","text":"<p>ELIM+ supports 4 notifiable diseases:</p> Disease Code Description Influenza <code>Influenza</code> Influenza virus detection (PCR) RSV <code>Rsv</code> Respiratory Syncytial Virus Norovirus <code>Norovirus</code> Norovirus RNA detection SARS-CoV-2 <code>Sarscov2</code> COVID-19 laboratory detection"},{"location":"Products/ELIMPLUS/api-tutorial/#report-id","title":"Report ID","text":"<p>The <code>reportId</code> field in the Labormeldung serves a dual purpose:</p> <ol> <li>Form pre-fill: It's embedded in the memento and displayed in the pre-filled form for the end user to review</li> <li>Report retrieval key: After the end user submits to DEMIS, the same <code>reportId</code> is used to retrieve the submission result via <code>GET /reports/{reportId}</code></li> </ol> <p>Important: Use a stable, unique ID per laboratory report. The <code>reportId</code> must be unique per API user \u2014 submitting a second report with the same <code>reportId</code> will be rejected.</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#form-workflow","title":"Form Workflow","text":"<ol> <li>User opens the magic link \u2192 lands on ELIM+ index: <code>/elimplus/</code></li> <li>User selects a disease form (Influenza, RSV, Norovirus, SARS-CoV-2)</li> <li>System routes to disease-specific form: <code>/elimplus/{Disease}/</code></li> <li>Form is pre-filled via memento parameter: <code>/elimplus/{Disease}/?m={memento}</code></li> <li>User reviews, corrects if needed, submits to DEMIS</li> <li>After successful submission, the result is available via <code>GET /reports/{reportId}</code></li> </ol>"},{"location":"Products/ELIMPLUS/api-tutorial/#memento-endpoint","title":"Memento Endpoint","text":"<p>Endpoint: <code>POST /api/elimplus/v1/memento</code></p> <p>Purpose: Create encrypted memento string and magic link to pre-fill laboratory reporting forms.</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#request-body","title":"Request Body","text":"<p>The endpoint accepts laboratory report data as JSON. Only <code>reportId</code> is required; all other fields are optional.</p> <p>Minimal Example:</p> <pre><code>{\n  \"reportId\": \"LAB-2026-00001\"\n}\n</code></pre> <p>Complete Example:</p> <pre><code>{\n  \"reportId\": \"LAB-2026-00123\",\n  \"KrankheitsCode\": \"J09\",\n  \"MeldungsDatum\": \"2026-02-20\",\n  \"MeldungsVerweisId\": \"MELD-REF-2026-00001\",\n  \"Krankheit\": {\n    \"Influenza\": {},\n    \"Rsv\": null,\n    \"Norovirus\": null,\n    \"Sarscov2\": null\n  },\n  \"Patient\": {\n    \"IsAnonym\": false,\n    \"Standard\": {\n      \"Name\": {\n        \"Vorname\": \"Max\",\n        \"Nachname\": \"Mustermann\"\n      },\n      \"Geschlecht\": \"MAENNLICH\",\n      \"Geburtsdatum\": \"1980-05-15\",\n      \"Adresse\": {\n        \"Strasse\": \"Musterstra\u00dfe 123\",\n        \"PLZ\": \"12345\",\n        \"Stadt\": \"Musterstadt\"\n      },\n      \"Kontakt\": {\n        \"Telefon\": \"+49 123 456789\",\n        \"Email\": \"max.mustermann@example.com\"\n      }\n    }\n  },\n  \"MeldendeEinrichtung\": {\n    \"EinrichtungsName\": \"Universit\u00e4tsklinikum Musterstadt\",\n    \"BSNR\": \"123456789\",\n    \"Adresse\": {\n      \"Strasse\": \"Klinikstra\u00dfe 1\",\n      \"PLZ\": \"12345\",\n      \"Stadt\": \"Musterstadt\"\n    },\n    \"Kontakt\": {\n      \"Telefon\": \"+49 123 456700\",\n      \"Email\": \"labor@klinikum-musterstadt.de\"\n    }\n  },\n  \"MeldendePerson\": {\n    \"Name\": {\n      \"Vorname\": \"Dr. Anna\",\n      \"Nachname\": \"Schmidt\"\n    },\n    \"Kontakt\": {\n      \"Telefon\": \"+49 123 456750\",\n      \"Email\": \"anna.schmidt@klinikum-musterstadt.de\"\n    }\n  },\n  \"EinsendendeEinrichtung\": {\n    \"EinrichtungsName\": \"Labor f\u00fcr Medizinische Mikrobiologie\",\n    \"Adresse\": {\n      \"Strasse\": \"Laborweg 5\",\n      \"PLZ\": \"12345\",\n      \"Stadt\": \"Musterstadt\"\n    },\n    \"Kontakt\": {\n      \"Telefon\": \"+49 123 456800\",\n      \"Email\": \"kontakt@labor-mikrobiologie.de\"\n    }\n  }\n}\n</code></pre>"},{"location":"Products/ELIMPLUS/api-tutorial/#field-reference","title":"Field Reference","text":"Field Type Required Description <code>reportId</code> string Yes Unique laboratory report identifier <code>KrankheitsCode</code> string No Disease code (e.g., ICD-10) <code>MeldungsDatum</code> date (YYYY-MM-DD) No Report date <code>MeldungsVerweisId</code> string No Reference ID for linking corrections or follow-up reports <code>Krankheit.*</code> object No Disease-specific data (only one should be populated) <code>Patient.IsAnonym</code> boolean No Patient type: false = standard (default), true = anonymous <code>Patient.Standard.*</code> object No Standard patient with full identification (use when IsAnonym=false) <code>Patient.Standard.Name.*</code> object No Patient name (Vorname, Nachname) <code>Patient.Standard.Geschlecht</code> enum No Gender (see enum values below) <code>Patient.Standard.Geburtsdatum</code> date (YYYY-MM-DD) No Full date of birth <code>Patient.Standard.Adresse.*</code> object No Full address (Strasse, PLZ, Stadt, Land) <code>Patient.Standard.Kontakt.*</code> object No Contact information (Telefon, Email, Fax) <code>Patient.Anonym.*</code> object No Anonymous patient with limited data (use when IsAnonym=true) <code>Patient.Anonym.Geschlecht</code> enum No Gender (see enum values below) <code>Patient.Anonym.GeburtsmonatJahr</code> string (YYYY-MM) No Birth month/year only (not full date for privacy) <code>Patient.Anonym.Adresse.PLZ</code> string No Postal code only <code>Patient.Anonym.Adresse.Land</code> string No Country only <code>MeldendeEinrichtung.*</code> object No Reporting facility (laboratory) <code>MeldendePerson.*</code> object No Reporting person <code>EinsendendeEinrichtung.*</code> object No Sending facility <p>Note: <code>Geschlecht</code> enum values: - <code>NASK</code> \u2014 Not asked (nicht gefragt) - <code>ASKU</code> \u2014 Asked but unknown (gefragt, aber unbekannt) - <code>MAENNLICH</code> \u2014 Male - <code>WEIBLICH</code> \u2014 Female - <code>DIVERS</code> \u2014 Diverse - <code>UNBESTIMMT</code> \u2014 Unspecified</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#response","title":"Response","text":"<p>Returns a JSON object containing the encrypted memento and a ready-to-use magic link:</p> <pre><code>{\n  \"memento\": \"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..DGG5lQvJC8OpYrCt.Xm8YR...\",\n  \"magicLink\": \"/mtl/eyJ...token.../elimplus/?m=eyJ...memento...\"\n}\n</code></pre> Field Type Nullable Description <code>memento</code> string No Encrypted, URL-safe string containing laboratory report data. Use as <code>?m={memento}</code> query parameter. <code>magicLink</code> string Yes Relative URL for authenticated single-click access. Prepend your instance host: <code>https://your-instance + magicLink</code> <p>Note: <code>magicLink</code> is <code>null</code> if the API user has no authentication configuration that supports token generation. In practice this should not occur for properly configured API users.</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#quick-reference","title":"Quick Reference","text":"<p>Get the magic link and construct the full URL:</p> <pre><code>RESPONSE=$(curl -s -X POST \\\n  -u \"api-user:api-pass\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"reportId\":\"LAB-2026-001\"}' \\\n  https://elim.example.com/api/elimplus/v1/memento)\n\nMAGIC_LINK=$(echo \"$RESPONSE\" | jq -r '.magicLink')\n\n# Construct absolute URL\nFORM_URL=\"https://elim.example.com$MAGIC_LINK\"\necho \"Send to user: $FORM_URL\"\n</code></pre>"},{"location":"Products/ELIMPLUS/api-tutorial/#report-retrieval-endpoints","title":"Report Retrieval Endpoints","text":"<p>After an end user submits a laboratory report via the ELIM+ form, the submission result is stored and made available for retrieval by the API user that created the original memento.</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#get-reports-list-pending-report-ids","title":"GET /reports \u2014 List pending report IDs","text":"<p>Endpoint: <code>GET /api/elimplus/v1/reports</code></p> <p>Returns an array of <code>reportId</code> strings for reports that have been submitted to DEMIS but not yet retrieved (unpolled). Reports disappear from this list once retrieved without <code>?peek=true</code>.</p> <p>Request:</p> <pre><code>curl -u \"api-user:api-pass\" \\\n  https://elim.example.com/api/elimplus/v1/reports\n</code></pre> <p>Response (200):</p> <pre><code>[\"LAB-2026-00123\", \"LAB-2026-00124\"]\n</code></pre> <p>An empty array <code>[]</code> means no submissions are pending retrieval.</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#get-reportsreportid-retrieve-report-result","title":"GET /reports/{reportId} \u2014 Retrieve report result","text":"<p>Endpoint: <code>GET /api/elimplus/v1/reports/{reportId}</code></p> <p>Returns the full result for a submitted report, including the RKI receipt PDF for successful submissions.</p> <p>Parameters:</p> Parameter In Required Description <code>reportId</code> path Yes The report ID from the original Labormeldung <code>peek</code> query No <code>true</code> = non-destructive read (report remains pending). Default: <code>false</code> <p>Default (destructive) read:</p> <pre><code>curl -u \"api-user:api-pass\" \\\n  https://elim.example.com/api/elimplus/v1/reports/LAB-2026-00123\n</code></pre> <p>Non-destructive peek:</p> <pre><code>curl -u \"api-user:api-pass\" \\\n  \"https://elim.example.com/api/elimplus/v1/reports/LAB-2026-00123?peek=true\"\n</code></pre> <p>Response (200 \u2014 SUCCESS):</p> <pre><code>{\n  \"reportId\": \"LAB-2026-00123\",\n  \"status\": \"SUCCESS\",\n  \"module\": \"ELIMPLUS\",\n  \"diseaseCode\": \"Influenza\",\n  \"description\": \"Labormeldung Influenza\",\n  \"submittedAt\": \"2026-02-20T14:32:00Z\",\n  \"receiptPdf\": \"JVBERi0xLjQK...\",\n  \"failureReason\": null\n}\n</code></pre> <p>Response (200 \u2014 FAILURE):</p> <pre><code>{\n  \"reportId\": \"LAB-2026-00456\",\n  \"status\": \"FAILURE\",\n  \"module\": \"ELIMPLUS\",\n  \"diseaseCode\": \"Rsv\",\n  \"description\": \"Labormeldung Rsv\",\n  \"submittedAt\": \"2026-02-20T15:10:00Z\",\n  \"receiptPdf\": null,\n  \"failureReason\": \"RKI Response Code: 422\"\n}\n</code></pre> <p>ReportResult fields:</p> Field Type Nullable Description <code>reportId</code> string No The original report ID <code>status</code> enum No <code>SUCCESS</code> or <code>FAILURE</code> <code>module</code> string No Always <code>\"ELIMPLUS\"</code> <code>diseaseCode</code> string Yes Disease identifier (e.g., <code>\"Influenza\"</code>, <code>\"Rsv\"</code>) <code>description</code> string Yes Human-readable description (e.g., <code>\"Labormeldung Influenza\"</code>) <code>submittedAt</code> date-time No ISO 8601 timestamp of DEMIS submission <code>receiptPdf</code> string Yes Base64-encoded RKI receipt PDF (SUCCESS only) <code>failureReason</code> string Yes Error message (FAILURE only) <p>Status codes:</p> Code Meaning 200 Report found and returned 401 Unauthorized \u2014 check credentials 404 Report not found or belongs to a different user 410 Gone \u2014 report was already retrieved (use <code>?peek=true</code> to avoid)"},{"location":"Products/ELIMPLUS/api-tutorial/#extracting-the-receipt-pdf","title":"Extracting the receipt PDF","text":"<p>The <code>receiptPdf</code> field is a base64-encoded PDF. To save it:</p> <pre><code>RESPONSE=$(curl -s -u \"api-user:api-pass\" \\\n  \"https://elim.example.com/api/elimplus/v1/reports/LAB-2026-00123?peek=true\")\n\n# Check status first\nSTATUS=$(echo \"$RESPONSE\" | jq -r '.status')\n\nif [ \"$STATUS\" = \"SUCCESS\" ]; then\n  echo \"$RESPONSE\" | jq -r '.receiptPdf' | base64 --decode &gt; receipt-LAB-2026-00123.pdf\n  echo \"Receipt saved\"\nelse\n  echo \"Submission failed: $(echo \"$RESPONSE\" | jq -r '.failureReason')\"\nfi\n</code></pre> <p>Or use the provided script:</p> <pre><code>./scripts/elimplus-get-report.sh LAB-2026-00123 --save-pdf receipt.pdf\n</code></pre>"},{"location":"Products/ELIMPLUS/api-tutorial/#polling-pattern","title":"Polling pattern","text":"<p>Reports become available asynchronously \u2014 the end user must complete and submit the form first. Poll periodically:</p> <pre><code># Poll for new reports every 60 seconds\nwhile true; do\n  IDS=$(curl -s -u \"api-user:api-pass\" \\\n    \"https://elim.example.com/api/elimplus/v1/reports\" | jq -r '.[]')\n\n  for ID in $IDS; do\n    RESULT=$(curl -s -u \"api-user:api-pass\" \\\n      \"https://elim.example.com/api/elimplus/v1/reports/$ID\")\n    STATUS=$(echo \"$RESULT\" | jq -r '.status')\n    echo \"$ID: $STATUS\"\n\n    if [ \"$STATUS\" = \"SUCCESS\" ]; then\n      echo \"$RESULT\" | jq -r '.receiptPdf' | base64 --decode &gt; \"${ID}.pdf\"\n    fi\n  done\n\n  sleep 60\ndone\n</code></pre>"},{"location":"Products/ELIMPLUS/api-tutorial/#complete-workflow-examples","title":"Complete Workflow Examples","text":""},{"location":"Products/ELIMPLUS/api-tutorial/#workflow-1-complete-external-integration","title":"Workflow 1: Complete external integration","text":"<pre><code>#!/bin/bash\n# Complete workflow for KIS/laboratory system integration with ELIM+\n\nBASE_URL=\"https://elim.example.com\"\nAPI_USER=\"lab-api\"\nAPI_PASS=\"api-secret\"\n\n# Step 1: Create memento and get magic link\necho \"Creating memento via API...\"\nRESPONSE=$(curl -s -X POST \\\n  -u \"$API_USER:$API_PASS\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"reportId\": \"LAB-2026-00123\",\n    \"KrankheitsCode\": \"J09\",\n    \"MeldungsDatum\": \"2026-02-20\",\n    \"Patient\": {\n      \"IsAnonym\": false,\n      \"Standard\": {\n        \"Name\": {\"Vorname\": \"Max\", \"Nachname\": \"Mustermann\"},\n        \"Geschlecht\": \"MAENNLICH\",\n        \"Geburtsdatum\": \"1980-05-15\"\n      }\n    },\n    \"MeldendeEinrichtung\": {\n      \"EinrichtungsName\": \"Universit\u00e4tsklinikum Musterstadt\",\n      \"BSNR\": \"123456789\"\n    }\n  }' \\\n  \"$BASE_URL/api/elimplus/v1/memento\")\n\nMAGIC_LINK=$(echo \"$RESPONSE\" | jq -r '.magicLink')\n\nif [ -z \"$MAGIC_LINK\" ] || [ \"$MAGIC_LINK\" = \"null\" ]; then\n  echo \"Error: No magic link in response\"\n  echo \"$RESPONSE\" | jq .\n  exit 1\nfi\n\n# Step 2: Construct absolute URL\nFORM_URL=\"$BASE_URL$MAGIC_LINK\"\n\n# Step 3: Deliver to end user\necho \"\"\necho \"Form URL for end user (single-click, no login required):\"\necho \"$FORM_URL\"\necho \"\"\necho \"What happens when user clicks:\"\necho \"1. MTL token authenticates the user automatically\"\necho \"2. Redirects to /elimplus/?m={memento}\"\necho \"3. User selects disease form (e.g., Influenza)\"\necho \"4. Form is pre-filled, user reviews and submits to DEMIS\"\n</code></pre>"},{"location":"Products/ELIMPLUS/api-tutorial/#workflow-2-email-with-pre-filled-form-link","title":"Workflow 2: Email with pre-filled form link","text":"<pre><code>#!/bin/bash\n# Create memento and email magic link to laboratory technician\n\nBASE_URL=\"https://elim.example.com\"\nAPI_USER=\"kis-api-user\"\nAPI_PASS=\"api-password\"\n\n# Create memento for RSV report\nMAGIC_LINK=$(curl -s -X POST -u \"$API_USER:$API_PASS\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"reportId\": \"LAB-2026-00456\",\n    \"Krankheit\": {\"Rsv\": {}},\n    \"Patient\": {\n      \"IsAnonym\": false,\n      \"Standard\": {\n        \"Name\": {\"Vorname\": \"Anna\", \"Nachname\": \"Schmidt\"},\n        \"Geburtsdatum\": \"1990-03-20\"\n      }\n    }\n  }' \\\n  \"$BASE_URL/api/elimplus/v1/memento\" | jq -r '.magicLink')\n\n# Construct absolute URL\nFORM_URL=\"$BASE_URL$MAGIC_LINK\"\n\n# Email the link (example using mail command)\necho \"Please review and submit the laboratory report: $FORM_URL\" | \\\n  mail -s \"Laboratory Report Ready for Review (LAB-2026-00456)\" \\\n    technician@hospital.example.com\n\necho \"Email sent with single-click authenticated link\"\necho \"Note: The link expires \u2014 generate close to the time of sending\"\n</code></pre>"},{"location":"Products/ELIMPLUS/api-tutorial/#workflow-3-batch-form-generation-from-csv","title":"Workflow 3: Batch form generation from CSV","text":"<pre><code>#!/bin/bash\n# Generate multiple pre-filled form links from laboratory results CSV\n\nBASE_URL=\"https://elim.example.com\"\nAPI_USER=\"kis-batch-user\"\nAPI_PASS=\"api-password\"\n\n# CSV format: reportId,disease,patientFirstName,patientLastName,dob\n# Example: LAB-2026-001,Influenza,Max,Mustermann,1980-05-15\n\nwhile IFS=, read -r report_id disease first_name last_name dob; do\n  # Skip header line\n  if [ \"$report_id\" = \"reportId\" ]; then\n    continue\n  fi\n\n  # Prepare JSON\n  LAB_DATA=$(jq -n \\\n    --arg reportId \"$report_id\" \\\n    --arg disease \"$disease\" \\\n    --arg vorname \"$first_name\" \\\n    --arg nachname \"$last_name\" \\\n    --arg dob \"$dob\" \\\n    '{\n      reportId: $reportId,\n      Krankheit: {($disease): {}},\n      Patient: {\n        IsAnonym: false,\n        Standard: {\n          Name: {Vorname: $vorname, Nachname: $nachname},\n          Geburtsdatum: $dob\n        }\n      }\n    }')\n\n  # Create memento and get magic link\n  MAGIC_LINK=$(curl -s -X POST -u \"$API_USER:$API_PASS\" \\\n    -H \"Content-Type: application/json\" \\\n    -d \"$LAB_DATA\" \\\n    \"$BASE_URL/api/elimplus/v1/memento\" | jq -r '.magicLink')\n\n  # Output report ID and absolute URL\n  echo \"$report_id,$BASE_URL$MAGIC_LINK\"\ndone &lt; lab_results.csv &gt; form_urls.csv\n\necho \"Generated form URLs saved to form_urls.csv\"\necho \"Each URL provides single-click authenticated access to ELIM+ index\"\n</code></pre>"},{"location":"Products/ELIMPLUS/api-tutorial/#workflow-4-qr-code-for-mobile-access","title":"Workflow 4: QR code for mobile access","text":"<pre><code>#!/bin/bash\n# Create memento and generate QR code for mobile scanning\n\nBASE_URL=\"https://elim.example.com\"\nAPI_USER=\"kis-api\"\nAPI_PASS=\"api-password\"\n\n# Create memento and get magic link\nMAGIC_LINK=$(curl -s -X POST -u \"$API_USER:$API_PASS\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"reportId\": \"LAB-2026-00789\",\n    \"Krankheit\": {\"Sarscov2\": {}},\n    \"Patient\": {\n      \"IsAnonym\": false,\n      \"Standard\": {\n        \"Name\": {\"Vorname\": \"Thomas\", \"Nachname\": \"M\u00fcller\"},\n        \"Geburtsdatum\": \"1975-08-12\"\n      }\n    }\n  }' \\\n  \"$BASE_URL/api/elimplus/v1/memento\" | jq -r '.magicLink')\n\n# Construct absolute URL\nFORM_URL=\"$BASE_URL$MAGIC_LINK\"\n\n# Generate QR code (requires qrencode tool)\necho \"$FORM_URL\" | qrencode -o lab-report-qr.png\n\necho \"QR code saved to lab-report-qr.png\"\necho \"Scan with mobile device for single-click authenticated access\"\n</code></pre>"},{"location":"Products/ELIMPLUS/api-tutorial/#workflow-5-anonymous-patient-reporting","title":"Workflow 5: Anonymous patient reporting","text":"<pre><code>#!/bin/bash\n# Create memento for anonymous patient (privacy protection)\n\nBASE_URL=\"https://elim.example.com\"\nAPI_USER=\"kis-api\"\nAPI_PASS=\"api-password\"\n\n# Create memento with anonymous patient data\nMAGIC_LINK=$(curl -s -X POST -u \"$API_USER:$API_PASS\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"reportId\": \"LAB-2026-00999\",\n    \"KrankheitsCode\": \"J09\",\n    \"MeldungsDatum\": \"2026-02-20\",\n    \"Krankheit\": {\"Influenza\": {}},\n    \"Patient\": {\n      \"IsAnonym\": true,\n      \"Anonym\": {\n        \"Geschlecht\": \"MAENNLICH\",\n        \"GeburtsmonatJahr\": \"1985-06\",\n        \"Adresse\": {\n          \"PLZ\": \"12345\",\n          \"Land\": \"Deutschland\"\n        }\n      }\n    },\n    \"MeldendeEinrichtung\": {\n      \"EinrichtungsName\": \"Universit\u00e4tsklinikum Musterstadt\",\n      \"BSNR\": \"123456789\"\n    }\n  }' \\\n  \"$BASE_URL/api/elimplus/v1/memento\" | jq -r '.magicLink')\n\nFORM_URL=\"$BASE_URL$MAGIC_LINK\"\n\necho \"Anonymous patient URL (single-click authenticated access):\"\necho \"$FORM_URL\"\necho \"\"\necho \"Note: Form contains no name, contact info, or full address\"\necho \"Only birth month/year, postal code, and country are included\"\n</code></pre>"},{"location":"Products/ELIMPLUS/api-tutorial/#error-handling","title":"Error Handling","text":""},{"location":"Products/ELIMPLUS/api-tutorial/#http-status-codes","title":"HTTP Status Codes","text":"Code Status Meaning 200 OK Request successful 400 Bad Request Invalid JSON or validation error (memento endpoint) 401 Unauthorized Missing or invalid API credentials 404 Not Found Report ID does not exist or belongs to a different user 410 Gone Report was already retrieved (use <code>?peek=true</code> to avoid) 500 Internal Server Error Server error (contact support)"},{"location":"Products/ELIMPLUS/api-tutorial/#validation-errors","title":"Validation Errors","text":"<p>If the request data is invalid, you'll receive a 400 Bad Request with details:</p> <pre><code>curl -X POST -u \"api-user:api-pass\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"invalid\":\"data\"}' \\\n  https://elim.example.com/api/elimplus/v1/memento\n</code></pre> <p>Response (400):</p> <pre><code>{\n  \"errors\": [\"reportId must not be null\"]\n}\n</code></pre>"},{"location":"Products/ELIMPLUS/api-tutorial/#date-format-validation","title":"Date Format Validation","text":"<p>Dates must be in ISO 8601 format (YYYY-MM-DD):</p> <pre><code># Invalid date format\ncurl -X POST -u \"api-user:api-pass\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"reportId\":\"LAB-001\",\"MeldungsDatum\":\"08.12.2026\"}' \\\n  https://elim.example.com/api/elimplus/v1/memento\n</code></pre> <p>Response (400):</p> <pre><code>{\n  \"errors\": [\"MeldungsDatum must be a valid date in format YYYY-MM-DD\"]\n}\n</code></pre>"},{"location":"Products/ELIMPLUS/api-tutorial/#handle-errors-in-scripts","title":"Handle Errors in Scripts","text":"<pre><code>#!/bin/bash\nRESPONSE=$(curl -s -w \"\\n%{http_code}\" -X POST \\\n  -u \"$API_USER:$API_PASS\" \\\n  -H \"Content-Type: application/json\" \\\n  -d \"$LAB_DATA\" \\\n  \"$BASE_URL/api/elimplus/v1/memento\")\n\nHTTP_CODE=$(echo \"$RESPONSE\" | tail -1)\nBODY=$(echo \"$RESPONSE\" | head -1)\n\nif [ \"$HTTP_CODE\" -eq 200 ]; then\n  MAGIC_LINK=$(echo \"$BODY\" | jq -r '.magicLink')\n  FORM_URL=\"$BASE_URL$MAGIC_LINK\"\n  echo \"Success: $FORM_URL\"\nelif [ \"$HTTP_CODE\" -eq 400 ]; then\n  echo \"Validation error:\"\n  echo \"$BODY\" | jq -r '.errors[]'\n  exit 1\nelif [ \"$HTTP_CODE\" -eq 401 ]; then\n  echo \"Authentication failed \u2014 check API credentials\"\n  exit 1\nelse\n  echo \"Error: HTTP $HTTP_CODE\"\n  echo \"$BODY\"\n  exit 1\nfi\n</code></pre>"},{"location":"Products/ELIMPLUS/api-tutorial/#reference","title":"Reference","text":""},{"location":"Products/ELIMPLUS/api-tutorial/#api-endpoints-summary","title":"API Endpoints Summary","text":"Method Endpoint Description POST <code>/api/elimplus/v1/memento</code> Create encrypted memento and magic link for form pre-fill GET <code>/api/elimplus/v1/reports</code> List pending (unpolled) report IDs GET <code>/api/elimplus/v1/reports/{reportId}</code> Retrieve full report result (status, receipt PDF)"},{"location":"Products/ELIMPLUS/api-tutorial/#openapi-specification_1","title":"OpenAPI Specification","text":"<p>Interactive API documentation (Swagger UI):</p> <pre><code>https://your-instance/api/docs/swagger-ui/index.html?urls.primaryName=ELIM+\n</code></pre>"},{"location":"Products/ELIMPLUS/api-tutorial/#disease-routes","title":"Disease Routes","text":"Disease API Code Form Route Influenza <code>Influenza</code> <code>/elimplus/Influenza/</code> RSV <code>Rsv</code> <code>/elimplus/Rsv/</code> Norovirus <code>Norovirus</code> <code>/elimplus/Norovirus/</code> SARS-CoV-2 <code>Sarscov2</code> <code>/elimplus/Sarscov2/</code> <p>Entry point: Always use <code>/elimplus/</code> \u2014 the index page where users select their disease form.</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#date-format","title":"Date Format","text":"<p>All dates use ISO 8601 format:</p> <pre><code>YYYY-MM-DD\nExample: 2026-02-20\n</code></pre>"},{"location":"Products/ELIMPLUS/api-tutorial/#gender-enum-values","title":"Gender Enum Values","text":"Value Description <code>NASK</code> Not asked (nicht gefragt) <code>ASKU</code> Asked but unknown (gefragt, aber unbekannt) <code>MAENNLICH</code> Male (m\u00e4nnlich) <code>WEIBLICH</code> Female (weiblich) <code>DIVERS</code> Diverse <code>UNBESTIMMT</code> Unspecified (unbestimmt)"},{"location":"Products/ELIMPLUS/api-tutorial/#security-notes","title":"Security Notes","text":"<p>Memento Encryption: - Mementos are encrypted with AES-256-GCM using your API user's KEK (Key Encryption Key) - Each memento is unique even for identical data (includes random IV) - Mementos cannot be decrypted without the correct API user credentials - Tampering is detected and rejected</p> <p>Magic Link Security: - Tokens are server-issued and signed \u2014 they cannot be forged - Each token is single-use and time-limited - The target URL (<code>/elimplus/</code>) is encoded inside the encrypted token</p> <p>Best Practices: - \u2713 Generate the magic link close to the time of sending (token is time-limited) - \u2713 Mementos are safe to pass via URL parameters and can be logged or stored - \u2717 Do not expose mementos or magic links to unauthorized users (they contain sensitive patient data) - \u2717 Do not reuse magic links; generate a fresh one for each workflow run</p> <p>Data Minimization: - Only include data that's actually needed for the form - Empty/null fields don't bloat the memento (they're omitted) - Minimal mementos result in shorter, more manageable URLs</p>"},{"location":"Products/ELIMPLUS/api-tutorial/#support","title":"Support","text":"<p>For technical support or questions about the ELIM+ API: - Contact your system administrator - Refer to the OpenAPI specification for detailed schema documentation - Check integration test examples in <code>src/integration-test/kotlin/de/vertama/elimplus/</code></p>"},{"location":"Products/ELIMPLUS/api-tutorial/#related-documentation","title":"Related Documentation","text":"<ul> <li>Magic Token Link (MTL) \u2014 How server-issued authentication tokens work</li> </ul> <p>Document Version: 0.1.2 Last Updated: 2026-02-20 API Version: v1</p>"},{"location":"Reference/endpoints-and-infrastructure/","title":"Endpunkte &amp; Infrastruktur","text":"<p>Diese Seite enth\u00e4lt alle notwendigen technischen Informationen, um eine reibungslose und sichere Verbindung zu unseren Systemen zu gew\u00e4hrleisten.</p>"},{"location":"Reference/endpoints-and-infrastructure/#elimvertamobde","title":"elim.vertamob.de","text":""},{"location":"Reference/endpoints-and-infrastructure/#ssl-zertifikat","title":"\ud83d\udee1\ufe0f SSL-Zertifikat","text":"<p>Um eine verschl\u00fcsselte Kommunikation zu garantieren, nutzen wir aktuelle SSL/TLS-Standards.</p>"},{"location":"Reference/endpoints-and-infrastructure/#aktuelles-zertifikat","title":"Aktuelles Zertifikat","text":"<ul> <li>G\u00fcltig bis: 17.02.2026</li> </ul> <p>Downloads der aktuellen Zertifikate:</p> <p>elim.vertamob.de.ca-bundle</p> <p>elim.vertamob.de.crt</p> <p>elim.vertamob.de.p7b</p>"},{"location":"Reference/endpoints-and-infrastructure/#zukunftiges-zertifikat","title":"Zuk\u00fcnftiges Zertifikat","text":"<ul> <li>G\u00fcltig bis: 25.02.2027</li> </ul> <p>Downloads der zuk\u00fcnftigen Zertifikate:</p> <p>elim.vertamob.de.ca-bundle</p> <p>elim.vertamob.de.crt</p> <p>elim.vertamob.de.p7b</p>"},{"location":"Reference/endpoints-and-infrastructure/#ip-adressen","title":"\ud83c\udf10 IP-Adressen","text":"<p>Falls Ihr Unternehmensnetzwerk durch eine Firewall gesch\u00fctzt ist, m\u00fcssen die folgenden IP-Adressen und Ports f\u00fcr den ausgehenden Datenverkehr freigeschaltet werden:</p> <ul> <li>18.197.24.114</li> <li>63.178.126.231</li> <li>63.178.152.244</li> </ul> <p>Stand: Januar 2026 N\u00e4chste \u00dcberpr\u00fcfung: Februar 2026</p>"},{"location":"Reference/system-requirements/","title":"Systemanforderungen","text":""},{"location":"Reference/system-requirements/#unterstutzte-browser","title":"Unterst\u00fctzte Browser","text":"<p>Die Vertama-Anwendungen ELIM, BELIM, DUBA, DIVI und DIGG sind webbasiert und erfordern einen aktuellen Browser, der die geltenden Web-Standards unterst\u00fctzt.</p>"},{"location":"Reference/system-requirements/#mindestanforderungen","title":"Mindestanforderungen","text":"Browser Minimale Version Empfohlene Version Chrome / Chromium 105+ (Aug 2022) Neueste stabile Version Microsoft Edge 105+ (Aug 2022) Neueste stabile Version Firefox 121+ (Dez 2023) Neueste stabile Version Safari 15.4+ (M\u00e4rz 2022) Neueste stabile Version"},{"location":"Reference/system-requirements/#nicht-unterstutzt","title":"Nicht unterst\u00fctzt","text":"<ul> <li>Internet Explorer (alle Versionen) - wird seit Juni 2022 nicht mehr von Microsoft unterst\u00fctzt</li> <li>\u00c4ltere Browser-Versionen ohne Unterst\u00fctzung f\u00fcr moderne CSS-Features</li> </ul>"},{"location":"Reference/system-requirements/#technische-hintergrund","title":"Technische Hintergrund","text":"<p>Die Anwendungen nutzen moderne CSS-Features wie die <code>:has()</code> Pseudo-Klasse f\u00fcr eine verbesserte Benutzeroberfl\u00e4che. Diese Features sind in \u00e4lteren Browsern nicht verf\u00fcgbar.</p>"},{"location":"Reference/system-requirements/#verhalten-in-alteren-browsern","title":"Verhalten in \u00e4lteren Browsern","text":"<p>Die Anwendungen funktionieren grunds\u00e4tzlich auch in \u00e4lteren Browsern, jedoch mit Einschr\u00e4nkungen:</p> <ul> <li>Pflichtfeld-Kennzeichnung: Der rote Stern (*) bei Pflichtfeldern wird m\u00f6glicherweise nicht angezeigt</li> <li>Formulare: Bleiben funktional - Browser-eigene Validierung zeigt Pflichtfelder beim Absenden an</li> <li>Visuelle Darstellung: Kann in Details abweichen</li> </ul>"},{"location":"Reference/system-requirements/#empfehlung","title":"Empfehlung","text":"<p>F\u00fcr die beste Benutzererfahrung empfehlen wir:</p> <ol> <li>Verwendung der neuesten stabilen Version Ihres Browsers</li> <li>Aktivierung automatischer Browser-Updates</li> <li>In Unternehmensumgebungen: Chrome oder Edge (Chromium-basiert)</li> </ol>"},{"location":"Reference/system-requirements/#weitere-anforderungen","title":"Weitere Anforderungen","text":""},{"location":"Reference/system-requirements/#javascript","title":"JavaScript","text":"<ul> <li>Erforderlich: JavaScript muss im Browser aktiviert sein</li> <li>Die Anwendungen verwenden JavaScript f\u00fcr interaktive Formulare und dynamische Inhalte</li> </ul>"},{"location":"Reference/system-requirements/#bildschirmauflosung","title":"Bildschirmaufl\u00f6sung","text":"<ul> <li>Minimum: 1024 \u00d7 768 Pixel</li> <li>Empfohlen: 1920 \u00d7 1080 Pixel oder h\u00f6her</li> <li>Responsive Design: Die Anwendungen passen sich automatisch an verschiedene Bildschirmgr\u00f6\u00dfen an</li> </ul>"},{"location":"Reference/system-requirements/#internetverbindung","title":"Internetverbindung","text":"<ul> <li>Stabile Internetverbindung erforderlich</li> <li>Empfohlene Bandbreite: mindestens 1 Mbit/s</li> </ul>"},{"location":"Reference/system-requirements/#barrierefreiheit","title":"Barrierefreiheit","text":"<p>Die Vertama-Anwendungen werden kontinuierlich hinsichtlich Barrierefreiheit verbessert. Bei Fragen zur Zug\u00e4nglichkeit wenden Sie sich bitte an den Support.</p> <p>Stand: Januar 2026 N\u00e4chste \u00dcberpr\u00fcfung: Juli 2026</p>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/","title":"Multi-User Secret Sharing - API Usage Guide","text":"<p>Audience: Developers integrating with or consuming this API Companion to: Multi-User Secret Sharing with Zero-Knowledge Architecture.md</p> <p>This guide shows how to use the secret sharing service with practical code examples.</p>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Quick Start</li> <li>Core Operations</li> <li>Advanced Usage</li> <li>Error Handling</li> <li>Security Best Practices</li> </ol>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#quick-start","title":"Quick Start","text":""},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#prerequisites","title":"Prerequisites","text":"<ul> <li>User must have an <code>ApiUser</code> account with a valid <code>userId</code></li> <li>User must have a password (never stored, only used for key derivation)</li> </ul>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#basic-flow","title":"Basic Flow","text":"<pre><code>// 1. Setup (once per user)\nservice.setupUserKeys(userId = 1L, password = \"user-password\")\n\n// 2. Create secret (by owner)\nval secretId = service.createSecret(\n    userId = 1L,\n    password = \"user-password\",\n    name = \"Database Credentials\",\n    value = \"postgresql://user:pass@host:5432/db\"\n)\n\n// 3. Access secret (by owner or granted user)\nval decrypted = service.accessSecret(\n    userId = 1L,\n    password = \"user-password\",\n    secretId = secretId\n)\n\nprintln(decrypted) // \"postgresql://user:pass@host:5432/db\"\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#core-operations","title":"Core Operations","text":""},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#1-setup-user-keys","title":"1. Setup User Keys","text":"<p>When: Once per user, before they can create or access secrets</p> <p>What it does: Generates X25519 key pair, encrypts private key with password-derived key</p> <pre><code>service.setupUserKeys(\n    userId = 123L,\n    password = \"user-chosen-password\"\n)\n</code></pre> <p>Returns: Nothing (throws exception on error)</p> <p>Errors: - <code>IllegalStateException</code>: User already has keys (call once only)</p> <p>Notes: - Password is never stored - Server derives encryption key from password using Argon2id - Private key is encrypted and stored; public key stored in plaintext - If user forgets password, all their secrets are permanently lost</p>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#2-create-secret","title":"2. Create Secret","text":"<p>When: User wants to store encrypted data</p> <p>What it does: Encrypts secret with random DEK, encrypts DEK with user's public key</p> <pre><code>// Option A: With password (derives KEK, ~200ms)\nval secretId: UUID = service.createSecret(\n    userId = 123L,\n    password = \"user-password\",\n    name = \"API Key\",\n    value = \"sk_live_abc123xyz789\"\n)\n\n// Option B: With pre-derived KEK from session (~1ms)\nval kek = session.getUserKek()\nval secretId: UUID = service.createSecret(\n    userId = 123L,\n    kek = kek,\n    name = \"API Key\",\n    value = \"sk_live_abc123xyz789\"\n)\n</code></pre> <p>Parameters: - <code>userId</code>: User creating the secret - <code>password</code> OR <code>kek</code>: Authentication credential - <code>name</code>: Human-readable label (stored in plaintext) - <code>value</code>: Secret data to encrypt (any string)</p> <p>Returns: <code>UUID</code> - unique identifier for the secret</p> <p>Errors: - <code>SecurityException</code>: Wrong password or user has no keys</p> <p>Notes: - Only the creator has access initially - Creator must use <code>grantAccess()</code> to share with others</p>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#3-access-secret","title":"3. Access Secret","text":"<p>When: User wants to decrypt and read a secret</p> <p>What it does: Decrypts user's private key, decrypts DEK, decrypts secret</p> <pre><code>// With password\nval decrypted: String = service.accessSecret(\n    userId = 123L,\n    password = \"user-password\",\n    secretId = UUID.fromString(\"...\")\n)\n\n// With KEK from session (faster)\nval kek = session.getUserKek()\nval decrypted: String = service.accessSecret(\n    userId = 123L,\n    kek = kek,\n    secretId = UUID.fromString(\"...\")\n)\n</code></pre> <p>Parameters: - <code>userId</code>: User accessing the secret - <code>password</code> OR <code>kek</code>: Authentication credential - <code>secretId</code>: UUID of the secret</p> <p>Returns: Decrypted secret value (plaintext string)</p> <p>Errors: - <code>SecurityException</code>: Wrong password, no access, or secret not found</p> <p>Notes: - User must have been granted access (creator has implicit access) - Password must be correct (no retry logic built-in)</p>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#4-grant-access","title":"4. Grant Access","text":"<p>When: User wants to share a secret with another user</p> <p>What it does: Re-encrypts DEK with grantee's public key</p> <pre><code>service.grantAccess(\n    secretId = UUID.fromString(\"...\"),\n    granterUserId = 123L,\n    granterPassword = \"granter-password\",\n    granteeUserId = 456L\n)\n</code></pre> <p>Parameters: - <code>secretId</code>: Secret to share - <code>granterUserId</code>: User granting access (must already have access) - <code>granterPassword</code>: Granter's password (to decrypt DEK) - <code>granteeUserId</code>: User receiving access</p> <p>Returns: Nothing (throws exception on error)</p> <p>Errors: - <code>SecurityException</code>: Granter doesn't have access, wrong password, or grantee has no keys</p> <p>Key insights: - Grantee doesn't need to be online - only their public key is used - Grantee's password is never shared - each user decrypts with their own password - Granter needs their password to decrypt the DEK, then re-encrypts it for grantee</p>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#5-revoke-access","title":"5. Revoke Access","text":"<p>When: User wants to remove another user's access</p> <p>What it does: Deletes user's encrypted DEK entry</p> <pre><code>service.revokeAccess(\n    secretId = UUID.fromString(\"...\"),\n    userId = 456L\n)\n</code></pre> <p>Parameters: - <code>secretId</code>: Secret to revoke access to - <code>userId</code>: User to revoke access from</p> <p>Returns: Nothing</p> <p>Limitations: - If user already decrypted and saved the secret, revocation doesn't affect saved copies - No password required (administrative action) - Cannot revoke creator's access (database constraint prevents it)</p>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#6-rotate-password","title":"6. Rotate Password","text":"<p>When: User wants to change their password</p> <p>What it does: Re-encrypts private key with new password-derived key</p> <pre><code>service.rotateUserPassword(\n    userId = 123L,\n    oldPassword = \"current-password\",\n    newPassword = \"new-secure-password\"\n)\n</code></pre> <p>Parameters: - <code>userId</code>: User changing password - <code>oldPassword</code>: Current password (must be correct) - <code>newPassword</code>: New password to set</p> <p>Returns: Nothing (throws exception on error)</p> <p>Errors: - <code>SecurityException</code>: Wrong old password</p> <p>Notes: - All secrets remain accessible with new password - Private key (and thus DEKs) stay the same, just re-encrypted - Old password is immediately invalidated</p>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#advanced-usage","title":"Advanced Usage","text":""},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#multi-user-workflow","title":"Multi-User Workflow","text":"<pre><code>// Alice creates secret\nservice.setupUserKeys(userId = alice.id, password = \"alice-pass\")\nval secretId = service.createSecret(\n    userId = alice.id,\n    password = \"alice-pass\",\n    name = \"Shared Database\",\n    value = \"prod-db-credentials\"\n)\n\n// Bob sets up keys\nservice.setupUserKeys(userId = bob.id, password = \"bob-pass\")\n\n// Alice grants Bob access (Bob doesn't need to be online!)\nservice.grantAccess(\n    secretId = secretId,\n    granterUserId = alice.id,\n    granterPassword = \"alice-pass\",\n    granteeUserId = bob.id\n)\n\n// Bob accesses with his own password\nval decrypted = service.accessSecret(\n    userId = bob.id,\n    password = \"bob-pass\",  // Not Alice's password!\n    secretId = secretId\n)\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#checking-access-before-granting","title":"Checking Access Before Granting","text":"<pre><code>// Repository method available\nval hasAccess = accessRepo.existsBySecretIdAndUserId(secretId, userId)\nif (!hasAccess) {\n    service.grantAccess(...)\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#listing-users-secrets","title":"Listing User's Secrets","text":"<pre><code>val userAccess: List&lt;UserSecretAccess&gt; = accessRepo.findByUserId(userId)\nuserAccess.forEach { access -&gt;\n    println(\"Secret: ${access.secret.name}\")\n    println(\"Granted by: ${access.grantedBy.name}\")\n    println(\"Granted at: ${access.grantedAt}\")\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#listing-users-with-access-to-secret","title":"Listing Users With Access to Secret","text":"<pre><code>val accessList: List&lt;UserSecretAccess&gt; = accessRepo.findBySecretId(secretId)\naccessList.forEach { access -&gt;\n    println(\"User: ${access.user.name}\")\n    println(\"Granted by: ${access.grantedBy.name}\")\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#error-handling","title":"Error Handling","text":""},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#securityexception","title":"SecurityException","text":"<p>Most operations throw <code>SecurityException</code> on auth failures:</p> <pre><code>try {\n    val secret = service.accessSecret(userId, password, secretId)\n} catch (e: SecurityException) {\n    when {\n        e.message?.contains(\"Wrong password\") == true -&gt;\n            // Password incorrect\n        e.message?.contains(\"has no access\") == true -&gt;\n            // User not granted access\n        e.message?.contains(\"has no crypto keys\") == true -&gt;\n            // User hasn't called setupUserKeys()\n        else -&gt;\n            // Other security error\n    }\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#illegalstateexception","title":"IllegalStateException","text":"<pre><code>try {\n    service.setupUserKeys(userId, password)\n} catch (e: IllegalStateException) {\n    // User already has keys - cannot call twice\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#recommended-error-handling-pattern","title":"Recommended Error Handling Pattern","text":"<pre><code>fun accessSecretSafely(userId: Long, password: String, secretId: UUID): Result&lt;String&gt; {\n    return try {\n        Result.success(service.accessSecret(userId, password, secretId))\n    } catch (e: SecurityException) {\n        Result.failure(e)\n    }\n}\n\n// Usage\naccessSecretSafely(userId, password, secretId)\n    .onSuccess { secret -&gt; println(\"Decrypted: $secret\") }\n    .onFailure { error -&gt; logger.error(\"Access failed: ${error.message}\") }\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#security-best-practices","title":"Security Best Practices","text":""},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#1-password-handling","title":"1. Password Handling","text":"<p>\u274c Don't:</p> <pre><code>// Never store passwords\ndata class User(val password: String)  // BAD!\n\n// Never log passwords\nlogger.info(\"User password: $password\")  // BAD!\n</code></pre> <p>\u2705 Do:</p> <pre><code>// Accept password as parameter, use immediately, discard\nfun login(username: String, password: String) {\n    service.accessSecret(userId, password, secretId)\n    // password garbage-collected after function returns\n}\n\n// Use char arrays for passwords (can be cleared)\nfun login(username: String, password: CharArray) {\n    try {\n        val passwordStr = String(password)\n        service.accessSecret(userId, passwordStr, secretId)\n    } finally {\n        password.fill('0')  // Clear password from memory\n    }\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#2-access-control","title":"2. Access Control","text":"<pre><code>// Check user owns or has access before operations\nfun userCanAccess(userId: Long, secretId: UUID): Boolean {\n    return accessRepo.existsBySecretIdAndUserId(secretId, userId)\n}\n\n// Verify before granting (prevent over-sharing)\nfun grantIfNotAlready(secretId: UUID, granterUserId: Long, ...) {\n    if (!userCanAccess(granteeUserId, secretId)) {\n        service.grantAccess(...)\n    }\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#3-error-messages","title":"3. Error Messages","text":"<p>\u274c Don't leak information:</p> <pre><code>catch (e: SecurityException) {\n    // Reveals whether user exists\n    return \"User $userId doesn't have crypto keys\"\n}\n</code></pre> <p>\u2705 Use generic messages:</p> <pre><code>catch (e: SecurityException) {\n    logger.warn(\"Access denied for user $userId\", e)\n    return \"Access denied\"  // Generic message to client\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#4-rate-limiting","title":"4. Rate Limiting","text":"<p>Implement rate limiting to prevent brute-force attacks:</p> <pre><code>@RateLimited(maxAttempts = 5, windowSeconds = 60)\nfun accessSecret(userId: Long, password: String, secretId: UUID): String {\n    return service.accessSecret(userId, password, secretId)\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#5-audit-logging","title":"5. Audit Logging","text":"<p>Log all access operations (but not passwords or secrets):</p> <pre><code>fun accessSecret(userId: Long, password: String, secretId: UUID): String {\n    val result = try {\n        service.accessSecret(userId, password, secretId)\n    } catch (e: SecurityException) {\n        auditLog.warn(\"Failed secret access\", mapOf(\n            \"userId\" to userId,\n            \"secretId\" to secretId,\n            \"reason\" to e.message\n        ))\n        throw e\n    }\n\n    auditLog.info(\"Secret accessed\", mapOf(\n        \"userId\" to userId,\n        \"secretId\" to secretId\n    ))\n\n    return result\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#6-password-rotation-reminders","title":"6. Password Rotation Reminders","text":"<pre><code>fun checkPasswordAge(userId: Long) {\n    val keys = userKeysRepo.findById(userId).orElseThrow()\n    val daysSinceCreation = ChronoUnit.DAYS.between(keys.createdAt, Instant.now())\n\n    if (daysSinceCreation &gt; 90) {\n        notifyUser(userId, \"Consider rotating your password\")\n    }\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#performance-considerations","title":"Performance Considerations","text":""},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#kdf-latency","title":"KDF Latency","text":"<p>Each password-based operation triggers Argon2id key derivation (~100-500ms). For better performance, use KEK-based method overloads with session-stored KEK:</p> <pre><code>// Slow: Derives KEK on every call\nrepeat(10) {\n    service.accessSecret(userId, password, secretId)  // 10 \u00d7 200ms = 2000ms\n}\n\n// Fast: Derive KEK once, reuse from session\nval kek = session.getUserKek()  // Already derived at login\nrepeat(10) {\n    service.accessSecret(userId, kek, secretId)  // 10 \u00d7 &lt;1ms = ~10ms\n}\n</code></pre> <p>Recommendation: Use session-based KEK for normal operations. Reserve password-based methods for high-security actions requiring explicit confirmation.</p>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#database-queries","title":"Database Queries","text":"<p>Operations by query count:</p> <ul> <li><code>setupUserKeys()</code>: 1 write</li> <li><code>createSecret()</code>: 3 reads, 2 writes</li> <li><code>accessSecret()</code>: 3 reads</li> <li><code>grantAccess()</code>: 4 reads, 1 write</li> <li><code>revokeAccess()</code>: 1 delete</li> </ul> <p>Recommendation: Add indexes on <code>user_secret_access(secret_id, user_id)</code> for optimal performance.</p>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#integration-examples","title":"Integration Examples","text":""},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#spring-mvc-controller","title":"Spring MVC Controller","text":"<pre><code>@RestController\n@RequestMapping(\"/api/secrets\")\nclass SecretController(\n    private val service: Service,\n    private val accessRepo: UserSecretAccessRepository\n) {\n\n    @PostMapping\n    fun createSecret(\n        @AuthenticationPrincipal user: ApiUser,\n        @RequestParam password: String,\n        @RequestBody request: CreateSecretRequest\n    ): ResponseEntity&lt;SecretResponse&gt; {\n        val secretId = service.createSecret(\n            userId = user.id!!,\n            password = password,\n            name = request.name,\n            value = request.value\n        )\n\n        return ResponseEntity.ok(SecretResponse(secretId))\n    }\n\n    @GetMapping(\"/{secretId}\")\n    fun getSecret(\n        @AuthenticationPrincipal user: ApiUser,\n        @PathVariable secretId: UUID,\n        @RequestParam password: String\n    ): ResponseEntity&lt;String&gt; {\n        return try {\n            val decrypted = service.accessSecret(user.id!!, password, secretId)\n            ResponseEntity.ok(decrypted)\n        } catch (e: SecurityException) {\n            ResponseEntity.status(HttpStatus.FORBIDDEN).build()\n        }\n    }\n\n    @PostMapping(\"/{secretId}/grant\")\n    fun grantAccess(\n        @AuthenticationPrincipal user: ApiUser,\n        @PathVariable secretId: UUID,\n        @RequestParam password: String,\n        @RequestParam granteeUserId: Long\n    ): ResponseEntity&lt;Void&gt; {\n        service.grantAccess(secretId, user.id!!, password, granteeUserId)\n        return ResponseEntity.ok().build()\n    }\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#thymeleaf-template","title":"Thymeleaf Template","text":"<pre><code>&lt;!-- Create secret form --&gt;\n&lt;form th:action=\"@{/secrets}\" method=\"post\"&gt;\n    &lt;input type=\"text\" name=\"name\" placeholder=\"Secret name\" required /&gt;\n    &lt;textarea name=\"value\" placeholder=\"Secret value\" required&gt;&lt;/textarea&gt;\n    &lt;input type=\"password\" name=\"password\" placeholder=\"Your password\" required /&gt;\n    &lt;button type=\"submit\"&gt;Create Secret&lt;/button&gt;\n&lt;/form&gt;\n\n&lt;!-- Access secret --&gt;\n&lt;form th:action=\"@{/secrets/{id}/view(id=${secretId})}\" method=\"post\"&gt;\n    &lt;input type=\"password\" name=\"password\" placeholder=\"Your password\" required /&gt;\n    &lt;button type=\"submit\"&gt;Decrypt&lt;/button&gt;\n&lt;/form&gt;\n\n&lt;!-- Display decrypted (be careful with XSS!) --&gt;\n&lt;div th:if=\"${decrypted}\"&gt;\n    &lt;pre th:text=\"${decrypted}\"&gt;&lt;/pre&gt;\n&lt;/div&gt;\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#troubleshooting","title":"Troubleshooting","text":""},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#user-has-no-crypto-keys","title":"\"User has no crypto keys\"","text":"<p>Cause: User hasn't called <code>setupUserKeys()</code> yet</p> <p>Fix: Call <code>setupUserKeys()</code> once per user before other operations</p>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#wrong-password-or-corrupted-private-key","title":"\"Wrong password or corrupted private key\"","text":"<p>Cause: Password is incorrect</p> <p>Fix: Verify user entered correct password</p> <p>Note: No password recovery possible - forgotten password = lost secrets</p>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#user-has-no-access-to-secret","title":"\"User has no access to secret\"","text":"<p>Cause: User wasn't granted access</p> <p>Fix: Secret creator must call <code>grantAccess()</code> first</p>"},{"location":"background-and-explanations/security-and-encryption/API-Usage-Guide/#user-already-has-keys","title":"\"User already has keys\"","text":"<p>Cause: Called <code>setupUserKeys()</code> twice for same user</p> <p>Fix: Only call once; use <code>rotateUserPassword()</code> to change password</p> <p>Document Version: 1.0 Last Updated: 2025-10-14 Related: - Multi-User Secret Sharing with Zero-Knowledge Architecture.md - Implementation-Notes.md</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/","title":"Multi-User Secret Sharing - Implementation Notes","text":"<p>Audience: Developers working on or extending this implementation Companion to: Multi-User Secret Sharing with Zero-Knowledge Architecture.md</p> <p>This document captures practical implementation details, gotchas, and lessons learned that aren't covered in the architectural design document.</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#table-of-contents","title":"Table of Contents","text":"<ol> <li>JPA/Hibernate Considerations</li> <li>Testing Strategy</li> <li>Common Pitfalls</li> <li>Performance Tips</li> <li>Memory Management</li> </ol>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#entity-classes-diagram","title":"Entity Classes Diagram","text":"<pre><code>classDiagram\n    class ApiUser {\n        +Long id\n        +String userName\n        +String password\n        +List~String~ roles\n    }\n\n    class UserCryptoKeys {\n        +Long userId\n        +ByteArray publicKey\n        +ByteArray encryptedPrivateKey\n        +ByteArray privateKeyKDFSalt\n        +ByteArray privateKeyIV\n        +Int kdfIterations\n        +Int kdfMemoryKb\n        +Instant createdAt\n    }\n\n    class SharedSecret {\n        +UUID id\n        +String name\n        +ByteArray encryptedSecret\n        +ByteArray secretIV\n        +Instant createdAt\n    }\n\n    class UserSecretAccess {\n        +ByteArray encryptedDEK\n        +ByteArray dekIV\n        +Instant grantedAt\n    }\n\n    ApiUser \"1\" --&gt; \"1\" UserCryptoKeys : CASCADE DELETE\n    ApiUser \"1\" --&gt; \"0..*\" SharedSecret : createdBy (SET NULL)\n    ApiUser \"1\" --&gt; \"0..*\" UserSecretAccess : user (CASCADE)\n    SharedSecret \"1\" --&gt; \"0..*\" UserSecretAccess : secret (CASCADE)\n    ApiUser \"1\" --&gt; \"0..*\" UserSecretAccess : grantedBy\n\n    note for UserCryptoKeys \"Stores user's X25519 key pair\\n- Public key: plaintext\\n- Private key: encrypted with KEK\\n- KEK derived from password via Argon2id\"\n    note for SharedSecret \"Encrypted with random DEK\\n- DEK NOT stored here\\n- Each user has own encrypted DEK copy\\n- Multiple users can access same secret\"\n    note for UserSecretAccess \"Composite PK: (secret_id, user_id)\\nStores DEK encrypted via X25519 key agreement:\\n1. Derive shared secret (user's private + granter's - public)\\n2. Encrypt DEK with shared secret (AES-GCM)\\n3. User decrypts DEK with their private key\"\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#cascade-delete-behavior","title":"Cascade Delete Behavior","text":"<p>When an ApiUser is deleted: 1. UserCryptoKeys: Deleted via JPA <code>@OneToOne(cascade = CascadeType.REMOVE)</code> (application-level) 2. UserSecretAccess (where user had access): Deleted via database FK <code>ON DELETE CASCADE</code> (<code>@OnDelete(CASCADE)</code>) 3. SharedSecret (created by user): <code>createdBy</code> set to NULL via database FK <code>ON DELETE SET NULL</code> (<code>@OnDelete(SET_NULL)</code>)    - Secret remains in database    - Becomes orphaned but still accessible to other users who have access</p> <p>When a SharedSecret is deleted: - UserSecretAccess records: Deleted via database FK <code>ON DELETE CASCADE</code></p> <p>Why mixed cascade strategy? - JPA cascade for <code>UserCryptoKeys</code>: Simple 1:1 relationship, no circular references - Database cascade for <code>UserSecretAccess</code>: Avoids Hibernate circular reference issues when deleting through complex relationship graph - Database SET NULL for <code>SharedSecret.createdBy</code>: Allows secrets to outlive their creator</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#jpahibernate-considerations","title":"JPA/Hibernate Considerations","text":""},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#entity-design-immutable-data-classes","title":"Entity Design: Immutable Data Classes","text":"<p>All entities use Kotlin <code>data class</code> with <code>val</code> (immutable) fields for thread safety and functional programming benefits.</p> <pre><code>@Entity\ndata class UserCryptoKeys(\n    @Id val userId: Long,\n    val publicKey: ByteArray,\n    val encryptedPrivateKey: ByteArray,\n    // ... immutable fields\n    @Version var version: Long? = null  // MUST be var!\n)\n</code></pre> <p>Why immutable? - Crypto keys shouldn't be accidentally modified - Thread-safe - Better functional programming semantics</p> <p>The <code>@Version</code> requirement:</p> <p>When using immutable fields with <code>.copy()</code>, you MUST add a <code>@Version</code> field:</p> <pre><code>// Without @Version: FAILS\nval keys = repo.findById(userId).orElseThrow()\nval updated = keys.copy(encryptedPrivateKey = newKey)\nrepo.save(updated)  // \ud83d\udca5 StaleObjectStateException\n\n// With @Version: WORKS\n@Version var version: Long? = null  // In entity\n</code></pre> <p>Why? - <code>.copy()</code> creates a detached entity (new object instance) - Hibernate can't tell if it's safe to merge without version tracking - <code>@Version</code> enables optimistic locking and safe merging - Bonus: Prevents lost updates during concurrent modifications</p> <p>See: Hibernate Optimistic Locking</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#onetoone-relationships-without-mapsid","title":"OneToOne Relationships Without <code>@MapsId</code>","text":"<p>Initial attempt used <code>@MapsId</code> but it requires the relationship to be non-null during persist:</p> <pre><code>// \u274c FAILS - @MapsId requires user to be non-null\n@OneToOne\n@MapsId\n@JoinColumn(name = \"user_id\")\nval user: ApiUser? = null\n</code></pre> <p>Solution: Use manual ID + read-only relationship:</p> <pre><code>// \u2705 WORKS\n@Id\nval userId: Long,  // Manual ID\n\n@OneToOne\n@JoinColumn(name = \"user_id\", insertable = false, updatable = false)\nval user: ApiUser? = null  // Read-only navigation property\n</code></pre> <p>How it works: - <code>userId</code> is the PK and FK (same value) - <code>user</code> is just for navigation (lazy-loaded when accessed) - <code>insertable/updatable = false</code> prevents cascade issues - No detached entity problems!</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#delete-methods-need-annotations","title":"Delete Methods Need Annotations","text":"<p>Spring Data JPA delete methods require both <code>@Modifying</code> and <code>@Transactional</code>:</p> <pre><code>interface UserSecretAccessRepository : JpaRepository&lt;...&gt; {\n\n    @Modifying\n    @Transactional\n    fun deleteBySecretIdAndUserId(secretId: UUID, userId: Long)\n}\n</code></pre> <p>Why? - <code>@Modifying</code>: Marks method as data-modifying operation - <code>@Transactional</code>: Ensures EntityManager has active transaction - Without them: <code>TransactionRequiredException</code></p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#bytearray-equality","title":"ByteArray Equality","text":"<p>JPA entities with <code>ByteArray</code> fields need custom <code>equals()</code>/<code>hashCode()</code>:</p> <pre><code>@Entity\ndata class UserCryptoKeys(...) {\n    override fun equals(other: Any?): Boolean {\n        if (this === other) return true\n        if (javaClass != other?.javaClass) return false\n        other as UserCryptoKeys\n        return userId == other.userId  // ID-based equality\n    }\n\n    override fun hashCode(): Int = userId.hashCode()\n}\n</code></pre> <p>Why? - <code>ByteArray.equals()</code> checks reference equality, not content - Data class default <code>equals()</code> breaks for byte arrays - Solution: ID-based equality for entities</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#testing-strategy","title":"Testing Strategy","text":""},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#two-tier-approach-unit-integration","title":"Two-Tier Approach: Unit + Integration","text":"<p>We maintain both test types for different purposes:</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#unit-tests-servicetestkt","title":"Unit Tests (<code>ServiceTest.kt</code>)","text":"<ul> <li>Purpose: Fast, isolated, test logic only</li> <li>Uses: Mockito mocks for all repositories</li> <li>Speed: ~2-3 seconds for full suite</li> <li>KDF params: <code>iterations=1, memory=1MB</code> (100x faster)</li> <li>Best for: Regression testing, CI/CD</li> </ul> <p>Key pattern: Real crypto operations, mocked persistence:</p> <pre><code>@BeforeAll\nfun setup() {\n    userKeysRepo = Mockito.mock(UserCryptoKeysRepository::class.java)\n    service = Service(\n        userKeysRepo = userKeysRepo,\n        // ... other mocks\n        kdfIterations = 1,      // Fast KDF\n        kdfMemoryKb = 1024\n    )\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#integration-tests-serviceintegrationtestkt","title":"Integration Tests (<code>ServiceIntegrationTest.kt</code>)","text":"<ul> <li>Purpose: Test real database interactions</li> <li>Uses: Real PostgreSQL via Testcontainers</li> <li>Speed: ~10-15 seconds (includes DB startup)</li> <li>KDF params: Uses service defaults</li> <li>Best for: Catching JPA/Hibernate issues, manual verification</li> </ul> <p>Key pattern: No mocks, real Spring context:</p> <pre><code>@SpringBootTest\nclass ServiceIntegrationTest : IntegrationTest() {\n    @Autowired private lateinit var service: Service\n    @Autowired private lateinit var userKeysRepo: UserCryptoKeysRepository\n    // Real dependencies injected by Spring\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#test-helpers-cache-vs-capture","title":"Test Helpers: Cache vs Capture","text":"<p>Unit tests: Use <code>thenAnswer {}</code> to track saves in maps:</p> <pre><code>private val userKeysCache = mutableMapOf&lt;Long, UserCryptoKeys&gt;()\n\nMockito.`when`(userKeysRepo.save(any())).thenAnswer { invocation -&gt;\n    val keys = invocation.arguments[0] as UserCryptoKeys\n    userKeysCache[keys.userId] = keys  // Track in map\n    keys\n}\n\n// Dynamic lookup (survives password rotation)\nMockito.`when`(userKeysRepo.findById(userId)).thenAnswer {\n    Optional.ofNullable(userKeysCache[userId])  // Always current\n}\n</code></pre> <p>Why <code>thenAnswer {}</code> instead of <code>thenReturn()</code>? - <code>thenReturn()</code> captures value at stub-creation time - <code>thenAnswer {}</code> evaluates dynamically on each call - Needed for password rotation where keys change</p> <p>Integration tests: Just use real repositories, no helpers needed!</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#debugging-transaction-issues","title":"Debugging Transaction Issues","text":"<p>Common error: <code>No EntityManager with actual transaction available</code></p> <p>Cause: Delete/modify operations without <code>@Transactional</code> Solution: Add <code>@Transactional</code> to repository method or service method</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#common-pitfalls","title":"Common Pitfalls","text":""},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#1-mixing-test-kdf-parameters","title":"1. Mixing Test KDF Parameters","text":"<p>\u274c Wrong:</p> <pre><code>setupMockUserKeys(user, password = \"pass1\")  // Uses KDF defaults\nservice.createSecret(userId, password = \"pass1\")  // Uses test KDF\n// Result: Wrong password error!\n</code></pre> <p>\u2705 Right: Ensure consistent KDF parameters throughout test lifecycle.</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#2-password-mismatches-in-test-helpers","title":"2. Password Mismatches in Test Helpers","text":"<pre><code>// Helper should accept password\nprivate fun createMockSecret(\n    user: ApiUser,\n    value: String,\n    password: String = \"password\"  // Default for convenience\n): UUID\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#3-forgetting-to-clear-sensitive-data","title":"3. Forgetting to Clear Sensitive Data","text":"<p>\u274c Wrong:</p> <pre><code>val kek = deriveKey(password, salt)\nval decrypted = decrypt(data, kek)\nreturn decrypted  // KEK still in memory!\n</code></pre> <p>\u2705 Right:</p> <pre><code>val kek = deriveKey(password, salt)\ntry {\n    return decrypt(data, kek)\n} finally {\n    kek.fill(0)  // Always clear\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#4-assuming-apiuser-is-available","title":"4. Assuming <code>ApiUser</code> is Available","text":"<p>The <code>UserCryptoKeys.user</code> field is often <code>null</code> after creation (lazy-loaded). Don't rely on it:</p> <pre><code>// \u274c May be null\nval user = userKeys.user!!  // NPE risk\n\n// \u2705 Use userId instead\nval userId = userKeys.userId\nval user = apiUserRepo.findById(userId).orElseThrow()\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#performance-tips","title":"Performance Tips","text":""},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#kdf-parameters-tuning","title":"KDF Parameters Tuning","text":"<p>Test on your target hardware:</p> <pre><code>fun measureKDF() {\n    val params = listOf(\n        Pair(1, 1024),      // ~10ms (testing only!)\n        Pair(2, 4096),      // ~50ms\n        Pair(3, 65536),     // ~200ms (default)\n        Pair(4, 65536)      // ~300ms\n    )\n\n    params.forEach { (iter, mem) -&gt;\n        val start = System.currentTimeMillis()\n        Argon2id.derive(password, salt, iter, mem)\n        println(\"Iterations=$iter, Memory=${mem}KB: ${System.currentTimeMillis() - start}ms\")\n    }\n}\n</code></pre> <p>Target: 100-500ms per KDF operation - Too fast: Weak against brute-force - Too slow: Poor UX</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#caching-strategies","title":"Caching Strategies","text":"<p>Cache: - \u2705 Public keys (rarely change) - \u2705 Encrypted data (safe to cache)</p> <p>Never cache: - \u274c Passwords - \u274c KEKs (derived keys) - \u274c Decrypted private keys - \u274c DEKs - \u274c Plaintext secrets</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#database-indexes","title":"Database Indexes","text":"<pre><code>-- Required indexes\nCREATE INDEX idx_user_secret_access_secret ON user_secret_access(secret_id);\nCREATE INDEX idx_user_secret_access_user ON user_secret_access(user_id);\nCREATE INDEX idx_shared_secret_created_by ON shared_secret(created_by);\n\n-- Composite for common query\nCREATE INDEX idx_user_secret_access_lookup\n  ON user_secret_access(secret_id, user_id);\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#memory-management","title":"Memory Management","text":""},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#sensitive-data-lifecycle","title":"Sensitive Data Lifecycle","text":"<pre><code>// 1. Create/derive\nval key = deriveKey(password, salt)\n\n// 2. Use\nval result = encrypt(data, key)\n\n// 3. ALWAYS clear\ntry {\n    // Use key\n} finally {\n    key.fill(0)           // ByteArray\n    privateKey.destroy()   // Key interface\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#verify-clearing-testing","title":"Verify Clearing (Testing)","text":"<pre><code>@Test\nfun `should clear sensitive data after use`() {\n    val password = \"test-password\"\n    val service = spy(Service(...))\n\n    service.accessSecret(userId, password, secretId)\n\n    // Verify no keys remain in heap dumps\n    // (Manual inspection or memory profiler)\n}\n</code></pre> <p>Note: Can't easily unit-test memory clearing, but code review + manual verification is important.</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#migration-path","title":"Migration Path","text":""},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#adding-to-existing-application","title":"Adding to Existing Application","text":"<ol> <li>Create tables (Hibernate auto-DDL or Flyway):</li> </ol> <pre><code>CREATE TABLE user_crypto_keys (...);\nCREATE TABLE shared_secret (...);\nCREATE TABLE user_secret_access (...);\n</code></pre> <ol> <li>Optional: Migrate existing secrets:</li> </ol> <pre><code>fun migrateExistingSecrets() {\n    existingSecrets.forEach { secret -&gt;\n        // Generate DEK, re-encrypt secret\n        // Encrypt DEK with each user's public key\n        // Store in new schema\n    }\n}\n</code></pre> <ol> <li>Gradual rollout:</li> <li>Phase 1: New users only</li> <li>Phase 2: Existing users opt-in</li> <li>Phase 3: Force migration</li> </ol>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#troubleshooting","title":"Troubleshooting","text":""},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#error-attempted-to-assign-id-from-null-one-to-one-property","title":"Error: \"attempted to assign id from null one-to-one property\"","text":"<p>Cause: Using <code>@MapsId</code> with null relationship Fix: Remove <code>@MapsId</code>, use manual ID management</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#error-detached-entity-passed-to-persist","title":"Error: \"detached entity passed to persist\"","text":"<p>Cause: Trying to save entity with detached relationship Fix: Add <code>insertable=false, updatable=false</code> to <code>@JoinColumn</code></p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#error-row-was-updated-or-deleted-by-another-transaction","title":"Error: \"Row was updated or deleted by another transaction\"","text":"<p>Cause: Missing <code>@Version</code> field for immutable entity updates Fix: Add <code>@Version var version: Long? = null</code></p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#error-tag-mismatch-during-decryption","title":"Error: \"Tag mismatch\" during decryption","text":"<p>Cause: Wrong password or corrupted data Solution: Check password, verify KDF parameters match</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#error-no-entitymanager-with-actual-transaction","title":"Error: \"No EntityManager with actual transaction\"","text":"<p>Cause: Delete method without <code>@Transactional</code> Fix: Add <code>@Modifying</code> + <code>@Transactional</code> to repository method</p>"},{"location":"background-and-explanations/security-and-encryption/Implementation-Notes/#code-review-checklist","title":"Code Review Checklist","text":"<p>When reviewing secret sharing code:</p> <ul> <li>[ ] All sensitive byte arrays cleared with <code>.fill(0)</code></li> <li>[ ] Keys destroyed with <code>.destroy()</code> after use</li> <li>[ ] Try-finally blocks protect key lifecycle</li> <li>[ ] No passwords logged or stored</li> <li>[ ] KDF parameters appropriate for environment</li> <li>[ ] Test KDF parameters only in test code</li> <li>[ ] Entity has <code>@Version</code> if using <code>.copy()</code></li> <li>[ ] Delete methods have <code>@Modifying</code> + <code>@Transactional</code></li> <li>[ ] ByteArray entities override <code>equals()</code>/<code>hashCode()</code></li> <li>[ ] Integration tests cover transaction boundaries</li> </ul> <p>Document Version: 1.0 Last Updated: 2025-10-14 Related: Multi-User Secret Sharing with Zero-Knowledge Architecture.md</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/","title":"Multi-User Secret Sharing with Zero-Knowledge Architecture","text":""},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#implementation-guide","title":"Implementation Guide","text":""},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#table-of-contents","title":"Table of Contents","text":"<ol> <li>Problem Statement</li> <li>Solution Architecture</li> <li>Cryptographic Components</li> <li>Data Model</li> <li>Core Operations</li> <li>Security Analysis</li> <li>Implementation Considerations</li> <li>References</li> </ol>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#problem-statement","title":"Problem Statement","text":""},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#requirements","title":"Requirements","text":"<ul> <li>Encrypt user secrets so the server cannot read them</li> <li>Allow multiple users to access the same secret</li> <li>Enable granting/revoking access without password sharing</li> <li>Maintain zero-knowledge architecture (server never sees plaintext secrets or passwords)</li> <li>Support asynchronous access grants (users don't need to be online simultaneously)</li> </ul>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#constraints","title":"Constraints","text":"<ul> <li>Cannot store encryption keys server-side</li> <li>Cannot share passwords between users</li> <li>Must be able to decrypt secrets deterministically</li> <li>Need to derive encryption keys from user passwords</li> </ul>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#solution-architecture","title":"Solution Architecture","text":""},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#two-layer-encryption-model","title":"Two-Layer Encryption Model","text":"<p>The solution uses a Data Encryption Key (DEK) + Key Encryption Key (KEK) pattern with elliptic curve cryptography:</p> <pre><code>Secret\n  \u2193 encrypted with\nData Encryption Key (DEK) - random, same for all users with access\n  \u2193 encrypted separately for each user with\nX25519 Key Agreement (user's private + granter's public)\n  \u2193 derives\nShared Secret \u2192 encrypts DEK with AES-GCM\n  \u2193 decrypted with\nUser's Private Key (X25519) - encrypted at rest\n  \u2193 encrypted with\nKey Encryption Key (KEK) - derived from password\n  \u2193 derived from\nUser's Password (Argon2id + salt)\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#key-insight","title":"Key Insight","text":"<p>The DEK is shared (conceptually), but each user has their own encrypted copy of it. Users never exchange passwords; instead, they use public-key cryptography to securely share the DEK.</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#cryptographic-components","title":"Cryptographic Components","text":""},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#1-password-based-key-derivation-argon2id","title":"1. Password-Based Key Derivation (Argon2id)","text":"<p>Purpose: Derive a symmetric Key Encryption Key (KEK) from user password</p> <p>Algorithm: Argon2id - Time cost: 3 iterations (tune to ~100-500ms) - Memory cost: 64 MB (65536 KB) - Salt: 16 bytes, random per user, stored in database - Output: 256-bit KEK</p> <p>Properties: - Deterministic: same password + salt \u2192 same KEK - Slow by design: makes brute-force expensive - Memory-hard: resistant to GPU/ASIC attacks</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#2-symmetric-encryption-aes-256-gcm","title":"2. Symmetric Encryption (AES-256-GCM)","text":"<p>Purpose: Encrypt private keys and secrets</p> <p>Algorithm: AES-256-GCM - Key size: 256 bits - IV size: 12 bytes (96 bits), random per encryption - Authentication tag: 128 bits (embedded in ciphertext)</p> <p>Used for: - Encrypting user's private X25519 key with KEK - Encrypting secrets with DEK - Encrypting DEK with shared secret from key agreement</p> <p>Properties: - Authenticated encryption (confidentiality + integrity) - Fast and well-supported - IV must be unique per encryption operation</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#3-elliptic-curve-key-agreement-x25519","title":"3. Elliptic Curve Key Agreement (X25519)","text":"<p>Purpose: Enable secure sharing of DEK between users via Diffie-Hellman key agreement</p> <p>Algorithm: X25519 (Curve25519) - Key size: 32 bytes (256 bits) - Each user has a key pair (public + private) - Key agreement produces a shared secret, used with AES-GCM to encrypt DEK</p> <p>Properties: - Public key: can be stored in plaintext, used for key agreement - Private key: encrypted with KEK, used for key agreement - Enables encryption without recipient's password - 10-20x faster than RSA-2048 - Smaller keys (32 bytes vs 256+ bytes for RSA)</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#data-model","title":"Data Model","text":""},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#user-crypto-keys","title":"User Crypto Keys","text":"<pre><code>data class UserCryptoKeys(\n    val userId: UUID,\n    val publicKey: ByteArray,           // X25519 public key (32 bytes, plaintext)\n    val encryptedPrivateKey: ByteArray, // X25519 private key (AES-encrypted with KEK)\n    val privateKeyKDFSalt: ByteArray,   // Salt for deriving KEK (16 bytes)\n    val privateKeyIV: ByteArray,        // IV for encrypting private key (12 bytes)\n    val kdfIterations: Int = 3,         // Argon2id parameters (for flexibility)\n    val kdfMemoryKb: Int = 65536\n)\n</code></pre> <p>Storage: One row per user</p> <p>Security notes: - Public key stored in plaintext (it's meant to be public) - Private key encrypted with user's KEK (derived from password) - Salt is not secret, just unique per user - If database is compromised, attacker needs user passwords to decrypt private keys</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#shared-secrets","title":"Shared Secrets","text":"<pre><code>data class SharedSecret(\n    val id: UUID,\n    val name: String,                   // e.g., \"Production API Key\"\n    val encryptedSecret: String,        // Secret encrypted with DEK (Base64)\n    val secretIV: String,               // IV for secret encryption (Base64)\n    val createdBy: UUID,                // User who created the secret\n    val createdAt: Timestamp\n)\n</code></pre> <p>Storage: One row per secret</p> <p>Security notes: - Secret encrypted with a random DEK - DEK is NOT stored here (stored separately per user) - IV is unique for this encryption</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#user-secret-access","title":"User Secret Access","text":"<pre><code>data class UserSecretAccess(\n    val secretId: UUID,                 // Reference to SharedSecret\n    val userId: UUID,                   // User who has access\n    val encryptedDEK: ByteArray,        // DEK encrypted via X25519 key agreement + AES-GCM\n    val dekIV: ByteArray,               // IV for DEK encryption (12 bytes)\n    val grantedBy: UUID,                // User who granted access (used for key agreement)\n    val grantedAt: Timestamp\n)\n</code></pre> <p>Storage: One row per (user, secret) pair</p> <p>Security notes: - Each user has their own encrypted copy of the DEK - DEK encrypted using X25519 key agreement (user's private + granter's public) + AES-GCM - User can decrypt DEK by deriving the same shared secret (requires their password to decrypt private key) - <code>grantedBy</code> indicates whose public key to use for key agreement</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#database-schema-example","title":"Database Schema Example","text":"<pre><code>CREATE TABLE user_crypto_keys (\n    user_id UUID PRIMARY KEY,\n    public_key TEXT NOT NULL,\n    encrypted_private_key TEXT NOT NULL,\n    private_key_kdf_salt VARCHAR(32) NOT NULL,\n    private_key_iv VARCHAR(32) NOT NULL,\n    kdf_iterations INT DEFAULT 3,\n    kdf_memory_kb INT DEFAULT 65536,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TABLE shared_secret (\n    id UUID PRIMARY KEY,\n    name VARCHAR(255) NOT NULL,\n    encrypted_secret TEXT NOT NULL,\n    secret_iv VARCHAR(32) NOT NULL,\n    created_by UUID REFERENCES user_crypto_keys(user_id),\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE TABLE user_secret_access (\n    secret_id UUID REFERENCES shared_secret(id),\n    user_id UUID REFERENCES user_crypto_keys(user_id),\n    encrypted_dek TEXT NOT NULL,\n    granted_by UUID REFERENCES user_crypto_keys(user_id),\n    granted_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    PRIMARY KEY (secret_id, user_id)\n);\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#core-operations","title":"Core Operations","text":""},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#1-user-registration-key-setup","title":"1. User Registration / Key Setup","text":"<p>Trigger: New user account creation</p> <p>Process: 1. Generate X25519 key pair (32-byte keys) 2. Generate random salt (16 bytes) 3. Derive KEK from password using Argon2id 4. Encrypt private key with KEK using AES-GCM 5. Store: public key (plaintext), encrypted private key, salt, IV</p> <p>Pseudocode:</p> <pre><code>fun setupUserKeys(userId: UUID, password: String) {\n    // Generate X25519 key pair\n    val keyPair = generateX25519KeyPair()\n\n    // Derive KEK from password\n    val salt = generateRandomBytes(16)\n    val kek = Argon2id.derive(password, salt, iterations=3, memory=65536)\n\n    // Encrypt private key with KEK\n    val iv = generateRandomBytes(12)\n    val encryptedPrivateKey = AES_GCM.encrypt(keyPair.private, kek, iv)\n\n    // Store in database\n    store(UserCryptoKeys(\n        userId = userId,\n        publicKey = keyPair.public.toBase64(),\n        encryptedPrivateKey = encryptedPrivateKey.toBase64(),\n        privateKeyKDFSalt = salt.toBase64(),\n        privateKeyIV = iv.toBase64()\n    ))\n\n    // Clear sensitive data\n    kek.clear()\n    keyPair.private.destroy()\n}\n</code></pre> <p>Security considerations: - Private key never stored in plaintext - KEK never stored, only derived on-demand - Password never stored</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#2-create-and-store-secret","title":"2. Create and Store Secret","text":"<p>Trigger: User creates a new secret to share</p> <p>Note: Also available as <code>createSecret(userId, kek, name, value)</code> using pre-derived KEK for better performance (see Session-Based KEK Storage).</p> <p>Process: 1. Generate random DEK (256-bit key) 2. Encrypt secret with DEK using AES-GCM 3. Get creator's public key 4. Encrypt DEK with creator's public key (so they can access it later) 5. Store: encrypted secret, encrypted DEK for creator</p> <p>Pseudocode:</p> <pre><code>fun createSecret(\n    userId: UUID, \n    secretName: String, \n    secretValue: String\n): UUID {\n    // Generate random DEK\n    val dek = generateRandomBytes(32)\n\n    // Encrypt secret with DEK\n    val secretIV = generateRandomBytes(12)\n    val encryptedSecret = AES_GCM.encrypt(secretValue, dek, secretIV)\n\n    // Store encrypted secret\n    val secretId = UUID.randomUUID()\n    store(SharedSecret(\n        id = secretId,\n        name = secretName,\n        encryptedSecret = encryptedSecret.toBase64(),\n        secretIV = secretIV.toBase64(),\n        createdBy = userId\n    ))\n\n    // Encrypt DEK using X25519 key agreement (creator's own keys)\n    val creatorKeys = getUserKeys(userId)\n    val privateKey = decryptPrivateKey(creatorKeys, password) // Already done above\n    val sharedSecret = X25519_KeyAgreement(privateKey, creatorKeys.publicKey)\n    val dekIV = generateRandomBytes(12)\n    val encryptedDEK = AES_GCM.encrypt(dek, sharedSecret, dekIV)\n\n    // Store access record for creator\n    store(UserSecretAccess(\n        secretId = secretId,\n        userId = userId,\n        encryptedDEK = encryptedDEK,\n        dekIV = dekIV,\n        grantedBy = userId\n    ))\n\n    // Clear sensitive data\n    dek.clear()\n\n    return secretId\n}\n</code></pre> <p>Security considerations: - DEK is random, never derived from password - Same DEK used for all users (but encrypted separately for each) - Secret never stored in plaintext</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#3-access-secret","title":"3. Access Secret","text":"<p>Trigger: User wants to read a secret they have access to</p> <p>Note: Also available as <code>accessSecret(userId, kek, secretId)</code> using pre-derived KEK (see Session-Based KEK Storage).</p> <p>Process: 1. User provides password 2. Derive KEK from password 3. Decrypt user's private key with KEK 4. Retrieve user's encrypted DEK for this secret 5. Decrypt DEK with private key 6. Decrypt secret with DEK 7. Return plaintext secret (clear all keys from memory)</p> <p>Pseudocode:</p> <pre><code>fun accessSecret(\n    secretId: UUID, \n    userId: UUID, \n    password: String\n): String {\n    // 1. Get user's encrypted private key\n    val userKeys = getUserKeys(userId)\n\n    // 2. Derive KEK from password\n    val kek = Argon2id.derive(\n        password, \n        userKeys.privateKeyKDFSalt.fromBase64(),\n        iterations = userKeys.kdfIterations,\n        memory = userKeys.kdfMemoryKb\n    )\n\n    // 3. Decrypt private key with KEK\n    val privateKey = AES_GCM.decrypt(\n        userKeys.encryptedPrivateKey.fromBase64(),\n        kek,\n        userKeys.privateKeyIV.fromBase64()\n    )\n\n    // 4. Get user's encrypted DEK for this secret\n    val access = getUserAccess(secretId, userId)\n\n    // 5. Derive shared secret via X25519 key agreement\n    // Use granter's public key (from grantedBy field)\n    val granterKeys = getUserKeys(access.grantedBy)\n    val sharedSecret = X25519_KeyAgreement(privateKey, granterKeys.publicKey)\n\n    // 6. Decrypt DEK with shared secret\n    val dek = AES_GCM.decrypt(access.encryptedDEK, sharedSecret, access.dekIV)\n\n    // 7. Get and decrypt the secret\n    val secret = getSecret(secretId)\n    val plaintext = AES_GCM.decrypt(\n        secret.encryptedSecret.fromBase64(),\n        dek,\n        secret.secretIV.fromBase64()\n    )\n\n    // 8. Clear all sensitive data from memory\n    kek.clear()\n    privateKey.destroy()\n    dek.clear()\n    sharedSecret.clear()\n\n    return plaintext.toString(Charsets.UTF_8)\n}\n</code></pre> <p>Security considerations: - Password never transmitted or stored - Private key and keys only exist in memory temporarily - Multiple layers of decryption: KEK \u2192 private key \u2192 DEK \u2192 secret - All intermediate keys cleared after use</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#4-grant-access-to-another-user","title":"4. Grant Access to Another User","text":"<p>Trigger: User A wants to share a secret with User B</p> <p>Note: Also available as <code>grantAccess(secretId, granterUserId, granterKEK, granteeUserId)</code> using pre-derived KEK (see Session-Based KEK Storage).</p> <p>Process: 1. User A provides password 2. User A decrypts their private key and retrieves DEK (same as \"Access Secret\") 3. Get User B's public key (no password needed!) 4. Encrypt DEK with User B's public key 5. Store new access record for User B</p> <p>Pseudocode:</p> <pre><code>fun grantAccess(\n    secretId: UUID,\n    granterUserId: UUID,      // User A\n    granterPassword: String,  // User A's password\n    granteeUserId: UUID       // User B\n) {\n    // 1-2. Granter decrypts their private key and gets DEK\n    val granterKeys = getUserKeys(granterUserId)\n    val granterKEK = Argon2id.derive(\n        granterPassword,\n        granterKeys.privateKeyKDFSalt.fromBase64(),\n        iterations = granterKeys.kdfIterations,\n        memory = granterKeys.kdfMemoryKb\n    )\n\n    val granterPrivateKey = AES_GCM.decrypt(\n        granterKeys.encryptedPrivateKey.fromBase64(),\n        granterKEK,\n        granterKeys.privateKeyIV.fromBase64()\n    )\n\n    val granterAccess = getUserAccess(secretId, granterUserId)\n\n    // Decrypt granter's DEK using key agreement with own keys\n    val granterSharedSecret = X25519_KeyAgreement(granterPrivateKey, granterKeys.publicKey)\n    val dek = AES_GCM.decrypt(\n        granterAccess.encryptedDEK,\n        granterSharedSecret,\n        granterAccess.dekIV\n    )\n\n    // 3. Get grantee's public key (no password needed!)\n    val granteeKeys = getUserKeys(granteeUserId)\n\n    // 4. Encrypt DEK for grantee using key agreement (granter's private + grantee's public)\n    val granteeSharedSecret = X25519_KeyAgreement(granterPrivateKey, granteeKeys.publicKey)\n    val dekIV = generateRandomBytes(12)\n    val encryptedDEKForGrantee = AES_GCM.encrypt(dek, granteeSharedSecret, dekIV)\n\n    // 5. Store access record for grantee\n    store(UserSecretAccess(\n        secretId = secretId,\n        userId = granteeUserId,\n        encryptedDEK = encryptedDEKForGrantee,\n        dekIV = dekIV,\n        grantedBy = granterUserId  // Grantee will use granter's public key\n    ))\n\n    // Clear sensitive data\n    granterKEK.clear()\n    granterPrivateKey.destroy()\n    dek.clear()\n    granterSharedSecret.clear()\n    granteeSharedSecret.clear()\n}\n</code></pre> <p>Security considerations: - User B does not need to be online or provide password - User B's password never shared with User A - Only User A's password is needed to perform the grant - Uses User B's public key (which is safe to use without permission)</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#5-revoke-access","title":"5. Revoke Access","text":"<p>Trigger: Remove a user's ability to access a secret</p> <p>Process: 1. Delete the user's access record (encrypted DEK entry) 2. User can no longer decrypt the secret</p> <p>Pseudocode:</p> <pre><code>fun revokeAccess(secretId: UUID, userId: UUID) {\n    deleteUserAccess(secretId, userId)\n}\n</code></pre> <p>Important limitation: - If user already decrypted and saved the secret, revocation doesn't affect saved copies - Consider re-encrypting the secret with a new DEK if you need to fully revoke access - Audit logs recommended to track who accessed what and when</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#security-analysis","title":"Security Analysis","text":""},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#what-the-server-can-see","title":"What the Server Can See","text":"<p>\u2705 Stored in database (not secret): - User public keys (meant to be public) - Encrypted private keys (useless without passwords) - KDF salts (not secret, just unique) - Encrypted DEKs (useless without private keys) - Encrypted secrets (useless without DEKs)</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#what-the-server-cannot-see","title":"What the Server Cannot See","text":"<p>\u274c Never stored or transmitted in plaintext: - User passwords - KEKs (Key Encryption Keys) - Private keys (plaintext) - DEKs (plaintext) - Secrets (plaintext)</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#threat-model","title":"Threat Model","text":"<p>If database is compromised: - Attacker gets: all encrypted data, public keys, salts - Attacker needs: user passwords to derive KEKs - Protection: Argon2id makes password brute-forcing expensive (~100-500ms per attempt) - Weak passwords remain vulnerable (use password policies)</p> <p>If single user account is compromised: - Attacker gets: access to secrets that user can access - Attacker cannot: grant themselves access to other secrets - Attacker cannot: decrypt other users' private keys</p> <p>If server is compromised (but not database): - Attacker could: intercept passwords during login - Mitigation: Use TLS, consider client-side key derivation - This is same risk as any password-based system</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#security-properties","title":"Security Properties","text":"<p>\u2705 Zero-knowledge: Server never sees plaintext secrets or passwords \u2705 Forward secrecy: Revoking access prevents future decryption (with limitations) \u2705 Access control: Users can only decrypt secrets they've been explicitly granted access to \u2705 Audit trail: Track who granted access and when \u2705 Brute-force resistance: Argon2id makes password attacks expensive  </p> <p>\u274c Not protected against: Weak user passwords, phishing, compromised endpoints \u274c No password recovery: If user forgets password, their secrets are lost  </p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#implementation-considerations","title":"Implementation Considerations","text":""},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#technology-stack-kotlinjvm","title":"Technology Stack (Kotlin/JVM)","text":"<p>Required libraries:</p> <pre><code>// Bouncy Castle for Argon2id and X25519\nimplementation(\"org.bouncycastle:bcprov-jdk18on:1.78.1\")\n\n// Standard Java crypto for AES-GCM\n// (included in JDK, no additional dependencies)\n</code></pre> <p>Key classes: - <code>Argon2BytesGenerator</code> - for key derivation - <code>Cipher</code> with \"AES/GCM/NoPadding\" - for symmetric encryption - <code>KeyPairGenerator</code> with \"X25519\" - for key generation (Bouncy Castle provider) - <code>KeyAgreement</code> with \"X25519\" - for Diffie-Hellman key agreement</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#performance-considerations","title":"Performance Considerations","text":"<p>Key derivation (Argon2id): - Expected time: 100-500ms per operation - Occurs on: login, accessing secrets, granting access - Tuning: Adjust iterations and memory to balance security vs UX - Testing: Use reduced parameters (iterations=1, memory=1024KB) for unit tests</p> <p>X25519 operations: - Key generation: ~5-10ms (done once per user, 10-20x faster than RSA) - Key agreement: &lt;1ms (much faster than RSA encryption/decryption) - Key size: 32 bytes (256 bits, much smaller than RSA)</p> <p>AES-GCM operations: - Very fast: &lt;1ms for typical secret sizes - Scales linearly with data size</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#memory-management","title":"Memory Management","text":"<p>Critical: Clear sensitive data after use</p> <pre><code>// Clear byte arrays\nbyteArray.fill(0)\n\n// Destroy keys\nsecretKey.destroy()\nprivateKey.destroy()\n\n// Use try-finally blocks\nval key = deriveKey(password, salt)\ntry {\n    // Use key\n} finally {\n    key.fill(0)\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#error-handling","title":"Error Handling","text":"<p>Authentication failures: - Wrong password \u2192 KEK derivation succeeds but decryption fails - Catch <code>AEADBadTagException</code> for AES-GCM failures - Return generic \"authentication failed\" (don't leak which step failed)</p> <p>Access control: - Check user has access record before attempting decryption - Return 403 Forbidden if no access record exists</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#testing-strategy","title":"Testing Strategy","text":"<p>Unit tests (fast parameters):</p> <pre><code>class SecretManager(\n    val kdfIterations: Int = 3,\n    val kdfMemoryKb: Int = 65536\n) {\n    companion object {\n        fun forTesting() = SecretManager(\n            kdfIterations = 1,\n            kdfMemoryKb = 1024\n        )\n    }\n}\n</code></pre> <p>Integration tests (real parameters): - Test full flows with production Argon2id settings - Mark as <code>@Tag(\"slow\")</code> or separate test suite - Run less frequently</p> <p>Security tests: - Verify keys are cleared from memory - Test wrong password scenarios - Test unauthorized access attempts - Verify encrypted data format</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#key-rotation","title":"Key Rotation","text":"<p>Rotating user passwords: 1. User provides old and new passwords 2. Derive old KEK, decrypt private key 3. Derive new KEK, re-encrypt private key with new IV 4. Update database with new encrypted private key, new salt, new IV</p> <p>Rotating secrets (for stronger security after revocation): 1. Generate new DEK 2. Re-encrypt secret with new DEK 3. Re-encrypt new DEK for all authorized users 4. Update all records atomically</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#scalability","title":"Scalability","text":"<p>Database: - Index on <code>(secret_id, user_id)</code> for user_secret_access - Consider partitioning by user_id or secret_id for large deployments</p> <p>Caching: - Can cache public keys (they don't change often) - Never cache passwords, KEKs, or decrypted keys - Can cache encrypted data (it's safe)</p> <p>Concurrent access: - Multiple users can access same secret simultaneously (read-only) - Granting access requires transaction isolation to prevent race conditions</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#session-based-kek-storage-pattern-ux-optimization","title":"Session-Based KEK Storage Pattern (UX Optimization)","text":""},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#the-performance-problem","title":"The Performance Problem","text":"<p>Argon2id key derivation takes 100-500ms per operation. Every password-based call (<code>createSecret</code>, <code>accessSecret</code>, <code>grantAccess</code>) triggers a full KDF cycle, creating noticeable latency when users perform multiple operations.</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#the-solution-derive-once-store-in-session","title":"The Solution: Derive Once, Store in Session","text":"<p>The implementation derives the KEK once at login and stores it in the HTTP session (server-side, encrypted via HTTPS):</p> <p>How it works: 1. <code>KekDerivationFilter</code> intercepts login POST, extracts password, stores in request attribute 2. <code>Active.handleAuthenticationSuccess()</code> listener fires after successful authentication 3. KEK is derived via <code>service.deriveKEK(userId, password)</code> and stored in session 4. Controllers retrieve KEK from session using <code>session.getUserKek()</code> 5. On logout, KEK is cleared from session</p> <p>Key classes: - <code>KekDerivationFilter</code> (Active.kt:12-38): Captures password from login POST - <code>Active.deriveAndStoreKek()</code> (Active.kt:85-103): Derives and stores KEK after authentication - <code>HttpSession.getUserKek()</code> (KekDerivationFilter.kt:40-41): Extension function to retrieve KEK</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#method-overloads","title":"Method Overloads","text":"<p>All operations have both password-based and KEK-based variants:</p> <pre><code>// Password-based: derives KEK internally (~200ms)\nfun createSecret(userId: Long, password: String, name: String, value: String): UUID\n\n// KEK-based: uses pre-derived KEK (~1ms)\nfun createSecret(userId: Long, kek: ByteArray, name: String, value: String): UUID\n</code></pre> <p>Available KEK overloads: - <code>createSecret(userId, kek, name, value)</code> \u2192 Returns UUID - <code>createSecretEntity(userId, kek, name, value)</code> \u2192 Returns SharedSecret entity - <code>accessSecret(userId, kek, secretId)</code> \u2192 Returns decrypted string - <code>grantAccess(secretId, granterUserId, granterKEK, granteeUserId)</code></p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#usage-in-controllers","title":"Usage in Controllers","text":"<pre><code>@PostMapping(\"/secrets\")\nfun createSecret(request: CreateSecretRequest, session: HttpSession): UUID {\n    val kek = session.getUserKek()  // Fast retrieval\n    return service.createSecret(userId, kek, request.name, request.value)\n}\n</code></pre>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#security-considerations","title":"Security Considerations","text":"<p>Threat: Session hijacking - Attacker with stolen session cookie has KEK access until timeout - Mitigations: HTTPS only, short session timeout (15-30 min), <code>HttpOnly</code> + <code>SameSite=Strict</code> cookies, Spring Session JDBC with encrypted storage</p> <p>Trade-off:</p> Aspect Password-per-Operation Session KEK UX 100-500ms per op &lt;1ms after login Security Password never stored KEK in session (encrypted) Hijacking risk Limited (need password) Full access until timeout <p>When to use each: - Password-per-operation: High-security admin operations, destructive actions requiring confirmation - Session KEK: Normal dashboard operations, frequent access patterns</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#performance-impact","title":"Performance Impact","text":"<p>Before: Login (200ms) + 5 secret accesses (5\u00d7200ms) = 1200ms After: Login (200ms) + 5 secret accesses (5\u00d7&lt;1ms) = ~205ms Improvement: ~6x faster</p>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#references","title":"References","text":""},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#cryptographic-standards","title":"Cryptographic Standards","text":"<ul> <li>Argon2: RFC 9106</li> <li>AES-GCM: NIST SP 800-38D</li> <li>X25519: RFC 7748</li> <li>Key Derivation: NIST SP 800-132</li> </ul>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#similar-implementations","title":"Similar Implementations","text":"<ul> <li>Signal: Uses X3DH key agreement protocol (X25519-based)</li> <li>WireGuard: Uses X25519 for key exchange</li> <li>1Password Teams: Uses SRP + RSA for vault sharing</li> <li>Bitwarden: Uses RSA-2048 for organization sharing</li> <li>ProtonMail: Uses PGP-based key exchange</li> </ul>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#best-practices","title":"Best Practices","text":"<ul> <li>OWASP Key Management Cheat Sheet: Link</li> <li>NIST Password Guidelines: SP 800-63B</li> <li>Latacora Cryptographic Right Answers: Blog post</li> </ul>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#appendix-algorithm-choices","title":"Appendix: Algorithm Choices","text":""},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#why-argon2id-over-pbkdf2-or-bcrypt","title":"Why Argon2id over PBKDF2 or bcrypt?","text":"<ul> <li>More resistant to GPU/ASIC attacks (memory-hard)</li> <li>Configurable time and memory costs</li> <li>Winner of Password Hashing Competition (2015)</li> <li>Recommended by OWASP and cryptography experts</li> </ul>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#why-aes-gcm-over-aes-cbc","title":"Why AES-GCM over AES-CBC?","text":"<ul> <li>Authenticated encryption (prevents tampering)</li> <li>No padding oracle attacks</li> <li>Faster than separate encryption + MAC</li> <li>Industry standard for modern applications</li> </ul>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#why-x25519-elliptic-curve-over-rsa","title":"Why X25519 (Elliptic Curve) over RSA?","text":"<ul> <li>Performance: 10-20x faster than RSA-2048 for key operations</li> <li>Key size: 32 bytes vs 256+ bytes for RSA (easier storage, faster transmission)</li> <li>Security: 128-bit equivalent security (same as RSA-2048)</li> <li>Modern standard: Used in Signal, WireGuard, TLS 1.3</li> <li>Constant-time operations: Resistant to timing attacks by design</li> <li>Mature: Well-vetted, standardized in RFC 7748</li> </ul>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#why-two-layer-encryption-dek-kek","title":"Why Two-Layer Encryption (DEK + KEK)?","text":"<ul> <li>Separates concerns: user authentication vs data encryption</li> <li>Enables efficient multi-user access (shared DEK, individual KEKs)</li> <li>Allows key rotation without re-encrypting all data</li> <li>Standard pattern in enterprise key management (AWS KMS, Google KMS, etc.)</li> </ul>"},{"location":"background-and-explanations/security-and-encryption/Multi-User%20Secret%20Sharing%20with%20Zero-Knowledge%20Architecture/#glossary","title":"Glossary","text":"<ul> <li>DEK (Data Encryption Key): Symmetric key used to encrypt the actual secret</li> <li>KEK (Key Encryption Key): Symmetric key derived from password, used to encrypt private key</li> <li>KDF (Key Derivation Function): Algorithm to derive cryptographic key from password</li> <li>Salt: Random value added to KDF to ensure unique outputs</li> <li>IV (Initialization Vector): Random value for each encryption to ensure unique ciphertexts</li> <li>Nonce: Same as IV in the context of AES-GCM</li> <li>X25519: Elliptic curve Diffie-Hellman key agreement protocol using Curve25519</li> <li>Key Agreement: Deriving a shared secret from two key pairs without directly transmitting keys</li> <li>GCM: Galois/Counter Mode, an authenticated encryption mode for AES</li> <li>Zero-knowledge: Server cannot access plaintext data even if it wanted to</li> </ul> <p>Document Version: 1.0 Last Updated: 2025-10-13 Author: Implementation Guide for Multi-User Secret Sharing System</p>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/","title":"Password-Based User Secrets Encryption","text":""},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#overview","title":"Overview","text":"<p>This implementation encrypts user secrets using a password-derived key, without storing any encryption secrets server-side. Users must provide their password to decrypt their secrets.</p>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#the-problem","title":"The Problem","text":"<p>We need to: - Encrypt user secrets (API keys, tokens, etc.) - NOT store any encryption keys server-side - Derive encryption keys from user passwords - Ensure the same password always produces the same key (for decryption)</p> <p>Challenge: Deterministic key derivation (same password \u2192 same key) is vulnerable to brute-force attacks if not properly protected.</p>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#the-solution-argon2id-aes-gcm","title":"The Solution: Argon2id + AES-GCM","text":""},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#key-derivation-argon2id","title":"Key Derivation: Argon2id","text":"<p>Why Argon2id? - Winner of the Password Hashing Competition - Makes brute-force attacks computationally expensive (~100-500ms per attempt) - Memory-hard: resistant to GPU/ASIC attacks - Deterministic with salt: same password + salt = same key</p> <p>How it works:</p> <pre><code>encryption_key = Argon2id(password, salt, iterations, memory)\n</code></pre> <p>Key parameters: - Salt: Random 16-byte value, unique per user, stored in database (not secret!) - Iterations: Time cost (typically 3), tune so derivation takes ~100-500ms - Memory: Memory cost (typically 64MB), makes parallel attacks expensive - Output: 256-bit encryption key</p>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#encryption-aes-256-gcm","title":"Encryption: AES-256-GCM","text":"<p>Why AES-GCM? - Industry standard for authenticated encryption - Provides confidentiality (encryption) AND authenticity (prevents tampering) - Fast and well-supported</p> <p>How it works:</p> <pre><code>ciphertext = AES-GCM-Encrypt(plaintext, key, iv)\n</code></pre> <p>Key parameters: - IV (Initialization Vector): Random 12-byte value, unique per encryption operation - Key: 256-bit key derived from password via Argon2id - Output: Ciphertext with embedded authentication tag</p>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#what-gets-stored","title":"What Gets Stored","text":""},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#per-user-once","title":"Per User (once):","text":"<ul> <li>KDF Salt (16 bytes, Base64 encoded): Used to derive encryption key</li> <li>Algorithm parameters (optional): iterations, memory cost for future flexibility</li> </ul>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#per-secret","title":"Per Secret:","text":"<ul> <li>Encrypted Data (variable length, Base64 encoded): IV (12 bytes) + ciphertext combined</li> </ul> <p>Storage format:</p> <pre><code>encrypted_value = Base64(IV || ciphertext)\n</code></pre> <p>The IV is prepended to the ciphertext for convenience - it's not secret, just needs to be unique.</p>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#security-properties","title":"Security Properties","text":""},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#what-this-protects-against","title":"What This Protects Against:","text":"<ul> <li>Database breach: Encrypted secrets are useless without user passwords</li> <li>Weak passwords: Argon2id makes brute-force attacks slow (~100-500ms per guess)</li> <li>Rainbow tables: Unique per-user salts prevent precomputed attacks</li> <li>Tampering: GCM authentication tag detects any modifications</li> </ul>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#what-this-does-not-protect-against","title":"What This Does NOT Protect Against:","text":"<ul> <li>Weak user passwords: Still vulnerable to dictionary attacks (just slower)</li> <li>Compromised passwords: If password is leaked, secrets can be decrypted</li> <li>Password reuse: Users reusing passwords across services</li> </ul>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#important-constraints","title":"Important Constraints:","text":"<ul> <li>No password recovery: If user forgets password, secrets are permanently lost</li> <li>Password required for access: User must provide password on every session</li> <li>Performance impact: ~100-500ms key derivation on login (by design)</li> </ul>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#key-decisions","title":"Key Decisions","text":""},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#why-not-just-hash-passwords","title":"Why Not Just Hash Passwords?","text":"<p>Hashing (like bcrypt) is for verifying passwords, not deriving keys. Each hash uses a random salt, so the same password produces different hashes - incompatible with encryption.</p>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#why-store-salt","title":"Why Store Salt?","text":"<p>The salt ensures different users with the same password get different keys. It's not secret, just unique. Without it stored, we couldn't reproduce the same key from the password.</p>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#why-store-iv-with-ciphertext","title":"Why Store IV with Ciphertext?","text":"<p>The IV must be unique for each encryption but doesn't need to be secret. Storing it with the ciphertext is standard practice and simplifies key management.</p>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#why-base64-encoding","title":"Why Base64 Encoding?","text":"<p>Makes binary data (salt, IV, ciphertext) easy to store in text database columns. Alternative is binary BLOB storage.</p>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#testing-considerations","title":"Testing Considerations","text":"<p>Argon2id is intentionally slow (~100-500ms). For unit tests: - Use reduced parameters: <code>iterations=1, memory=1024KB</code> (~5-10ms) - Reserve full parameters for integration tests - The slowness is a security feature, not a bug!</p>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#architecture-trade-offs","title":"Architecture Trade-offs","text":"<p>Pros: - Zero-knowledge architecture: server never sees encryption keys - Strong security with proper password - No server-side secret management complexity</p> <p>Cons: - No password recovery mechanism - User experience: must enter password to decrypt secrets - Performance: noticeable delay on login (by design) - Password strength critical: system security depends entirely on password quality</p>"},{"location":"background-and-explanations/security-and-encryption/Password-Based%20User%20Secrets%20Encryption%20with%20Derived%20Keys/#references","title":"References","text":"<ul> <li>Argon2 RFC 9106</li> <li>NIST Guidelines on Password-Based Key Derivation</li> <li>AES-GCM Specification</li> </ul>"},{"location":"how-to/folder-sync-handbuch/","title":"Benutzerhandbuch: Folder Sync mit S3 Browser","text":""},{"location":"how-to/folder-sync-handbuch/#inhaltsverzeichnis","title":"Inhaltsverzeichnis","text":"<ul> <li>1. Einleitung</li> <li>2. S3 Browser einrichten<ul> <li>2.1 S3 Browser herunterladen und installieren</li> <li>2.2 Account hinzuf\u00fcgen</li> <li>2.3 Externen Bucket hinzuf\u00fcgen</li> </ul> </li> <li>3. Automatischen Sync konfigurieren<ul> <li>3.1 Aufgabenplaner \u00f6ffnen</li> <li>3.2 Neue Aufgabe erstellen</li> <li>3.3 Allgemeine Einstellungen</li> <li>3.4 Trigger konfigurieren</li> <li>3.5 Aktion definieren</li> <li>3.6 Bedingungen festlegen</li> <li>3.7 Einstellungen anpassen</li> </ul> </li> <li>4. Glossar</li> </ul>"},{"location":"how-to/folder-sync-handbuch/#1-einleitung","title":"1. Einleitung","text":"<p>Dieses Handbuch f\u00fchrt Sie durch die Einrichtung eines automatischen Synchronisationsprozesses zwischen Ihrem lokalen Ordner und Amazon S3 Storage mithilfe des S3 Browsers. Der S3 Browser ist ein leistungsf\u00e4higes Tool, das die Verwaltung von Amazon S3-Ressourcen vereinfacht.</p> <p>In den folgenden Abschnitten erfahren Sie Schritt f\u00fcr Schritt, wie Sie:</p> <ul> <li>Den S3 Browser installieren und konfigurieren</li> <li>Einen externen Bucket hinzuf\u00fcgen</li> <li>Einen automatischen Sync-Vorgang im Windows-Aufgabenplaner einrichten</li> </ul> <p>Befolgen Sie die Anweisungen sorgf\u00e4ltig, um eine reibungslose und effiziente Datensynchronisation zu gew\u00e4hrleisten.</p>"},{"location":"how-to/folder-sync-handbuch/#2-s3-browser-einrichten","title":"2. S3 Browser einrichten","text":""},{"location":"how-to/folder-sync-handbuch/#21-s3-browser-herunterladen-und-installieren","title":"2.1 S3 Browser herunterladen und installieren","text":"<ol> <li>Navigieren Sie zur offiziellen Website: https://s3browser.com/download.aspx</li> <li>Laden Sie die neueste Version des S3 Browsers herunter.</li> <li>F\u00fchren Sie die Installation aus und notieren Sie sich den Installationspfad f\u00fcr sp\u00e4tere Schritte.</li> </ol>"},{"location":"how-to/folder-sync-handbuch/#22-account-hinzufugen","title":"2.2 Account hinzuf\u00fcgen","text":"<ol> <li>Starten Sie den S3 Browser nach der Installation.</li> <li>F\u00fcgen Sie den bereitgestellten Account hinzu:<ul> <li>Verwenden Sie den Access Key, der Ihnen zur Verf\u00fcgung gestellt wurde.</li> <li>Geben Sie den Secret Access Key ein, den Sie erhalten haben.</li> </ul> </li> </ol>"},{"location":"how-to/folder-sync-handbuch/#23-externen-bucket-hinzufugen","title":"2.3 Externen Bucket hinzuf\u00fcgen","text":"<ol> <li>F\u00fcgen Sie den externen Bucket hinzu.</li> <li>Verwenden Sie daf\u00fcr den Bucket-Namen.</li> </ol>"},{"location":"how-to/folder-sync-handbuch/#3-automatischen-sync-konfigurieren","title":"3. Automatischen Sync konfigurieren","text":""},{"location":"how-to/folder-sync-handbuch/#31-aufgabenplaner-offnen","title":"3.1 Aufgabenplaner \u00f6ffnen","text":"<p>\u00d6ffnen Sie den Windows-Aufgabenplaner durch Eingabe von \"taskschd.msc\" im Ausf\u00fchren-Dialog (Windows-Taste + R).</p>"},{"location":"how-to/folder-sync-handbuch/#32-neue-aufgabe-erstellen","title":"3.2 Neue Aufgabe erstellen","text":"<p>Im Aufgabenplaner, w\u00e4hlen Sie in der linken oberen Ecke unter \"Aktionen\" die Option \"Aufgabe erstellen...\" aus.</p> <p></p>"},{"location":"how-to/folder-sync-handbuch/#33-allgemeine-einstellungen","title":"3.3 Allgemeine Einstellungen","text":"<ol> <li>Geben Sie der Aufgabe einen aussagekr\u00e4ftigen Namen, z.B. \"S3 Folder Sync\".</li> <li>W\u00e4hlen Sie \"Unabh\u00e4ngig von der Benutzeranmeldung ausf\u00fchren\" aus.</li> <li>W\u00e4hlen Sie die h\u00f6chsten Berechtigungen aus (\"Mit h\u00f6chsten Privilegien ausf\u00fchren\").</li> <li>W\u00e4hlen Sie \"Windows 10\" als Konfiguration aus.</li> </ol>"},{"location":"how-to/folder-sync-handbuch/#34-trigger-konfigurieren","title":"3.4 Trigger konfigurieren","text":"<ol> <li> <p>Wechseln Sie zum Reiter \"Trigger\" und erstellen Sie zwei separate Trigger:</p> <p>a) Erster Trigger: \"Beim Start\"</p> <ul> <li>W\u00e4hlen Sie \"Beim Start\" aus dem Dropdown-Men\u00fc.</li> <li>Stellen Sie unter \"Erweiterte Einstellungen\" ein:<ul> <li>Aktivieren Sie \"Wiederholen jede:\" und w\u00e4hlen Sie \"5 Minuten\" aus.</li> <li>W\u00e4hlen Sie bei \"Dauer\" die Option \"Unbegrenzt\" aus.</li> </ul> </li> </ul> <p></p> <p>b) Zweiter Trigger: \"Nach einem Zeitplan\"</p> <ul> <li>W\u00e4hlen Sie unter \"Aufgabe starten:\" die Option \"Nach einem Zeitplan\" aus.</li> <li>W\u00e4hlen Sie bei \"Einstellungen\" die Option \"T\u00e4glich\".</li> <li>Stellen Sie das Startdatum auf das aktuelle Datum und die Startzeit auf einen Zeitpunkt ein, der wenige Minuten in der Zukunft liegt. Dies ist wichtig, damit der Trigger garantiert in der Zukunft liegt und sofort aktiv wird.   Beispiel: Wenn es jetzt 14:30 Uhr ist, stellen Sie die Startzeit auf 14:35 Uhr ein.</li> <li>W\u00e4hlen Sie bei \"Dauer\" die Option \"Unbegrenzt\" aus.</li> </ul> <p></p> </li> <li> <p>Best\u00e4tigen Sie jeden Trigger mit \"OK\".</p> </li> </ol>"},{"location":"how-to/folder-sync-handbuch/#35-aktion-definieren","title":"3.5 Aktion definieren","text":"<ol> <li>Wechseln Sie zum Reiter \"Aktionen\" und w\u00e4hlen Sie \"Neu...\" aus.</li> <li>W\u00e4hlen Sie \"Programm starten\" aus dem Dropdown-Men\u00fc aus.</li> <li> <p>Geben Sie im Feld \"Programm/Skript\" den vollst\u00e4ndigen Pfad zum S3 Browser CLI ein:</p> <pre><code>\"C:\\Program Files\\S3 Browser\\s3browser-cli.exe\"\n</code></pre> </li> <li> <p>F\u00fcgen Sie im Feld \"Argumente hinzuf\u00fcgen\" folgenden Befehl ein:</p> <pre><code>/file sync vertama-data-transfer-dev20240830135304492700000001 \\\n    \"C:\\Ihr\\Lokaler\\Ordner\" \\\n    \"s3:vertama-data-transfer-dev20240830135304492700000001/New Folder/\" \\\n    ncdhs\n</code></pre> <p>Ersetzen Sie \"C:\\Ihr\\Lokaler\\Ordner\" mit dem tats\u00e4chlichen Pfad des zu synchronisierenden Ordners.</p> <p></p> </li> </ol>"},{"location":"how-to/folder-sync-handbuch/#36-bedingungen-festlegen","title":"3.6 Bedingungen festlegen","text":"<p>Wechseln Sie zum Reiter \"Bedingungen\" und deaktivieren Sie alle Optionen unter \"Energie\", um den Sync auch im Batteriebetrieb zu erm\u00f6glichen.</p> <p></p>"},{"location":"how-to/folder-sync-handbuch/#37-einstellungen-anpassen","title":"3.7 Einstellungen anpassen","text":"<p>Wechseln Sie zum Reiter \"Einstellungen\" und nehmen Sie folgende Anpassungen vor:</p> <ol> <li>Aktivieren Sie nur diese Optionen:<ul> <li>\"Aufgabe so schnell wie m\u00f6glich nach einem verpassten Start ausf\u00fchren\"</li> <li>\"Falls Aufgabe scheitert, neu starten alle:\"</li> </ul> </li> <li>Deaktivieren Sie alle anderen Optionen. </li> </ol> <p>Klicken Sie abschlie\u00dfend auf \"OK\", um die Aufgabe zu speichern und zu aktivieren.</p>"},{"location":"how-to/folder-sync-handbuch/#4-glossar","title":"4. Glossar","text":"<ul> <li>S3 Browser: Verwaltungstool f\u00fcr Amazon S3 und kompatible Speicherdienste.</li> <li>Amazon S3: Skalierbarer Cloudspeicherdienst von AWS (Amazon Web Services)</li> <li>Bucket: Container f\u00fcr Dateien in Amazon S3.</li> <li>Access Key: Identifikationsschl\u00fcssel f\u00fcr AWS-Dienste.</li> <li>Secret Access Key: Geheimer Authentifizierungsschl\u00fcssel f\u00fcr AWS.</li> <li>Aufgabenplaner: Windows-Tool zur Aufgabenautomatisierung.</li> <li>Trigger: Definierter Ausl\u00f6ser f\u00fcr geplante Aufgaben.</li> <li>Sync: Datenabgleich zwischen zwei Speicherorten.</li> </ul>"}]}